<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3c.org/TR/1999/REC-html401-19991224/loose.dtd">
<html>
<head>
<title> GA: Trasferimento dati per Tentata Vendita/Prevendita</title>
<LINK rel=stylesheet type=text/css href="style_topic.css">
<SCRIPT LANGUAGE="JavaScript">
<!-- Begin
loadImage1 = new Image();
loadImage1.src = "../images/help_home_Button_01_Roll-over.gif";
staticImage1 = new Image();
staticImage1.src = "../images/help_home_Button_01_Roll-out.gif";

loadImage2 = new Image();
loadImage2.src = "../images/help_home_Button_02_Roll-over.gif";
staticImage2 = new Image();
staticImage2.src = "../images/help_home_Button_02_Roll-out.gif";

loadImage3 = new Image();
loadImage3.src = "../images/help_home_Button_03_Roll-over.gif";
staticImage3 = new Image();
staticImage3.src = "../images/help_home_Button_03_Roll-out.gif";

loadImage4 = new Image();
loadImage4.src = "../images/help_home_Button_04_Roll-over.gif";
staticImage4 = new Image();
staticImage4.src = "../images/help_home_Button_04_Roll-out.gif";

// End -->
</SCRIPT>

</head>
<body lang=it topMargin=3>
<TABLE width=987 border=0><TR><TD vAlign=top align=right><p><code>Data ultimo aggiornamento: <A name=hINIeDATlAGGp></A>06/06/2016</FONT><A name=hFINeDATlAGGp></A></code></p></TD></TR></TABLE><TABLE cellSpacing=0 border=0><TR><TD colSpan=4><A href="http://www.ntsinformatica.it"><IMG border=0 alt="Clicca per accedere al sito di NTS Informatica" src="../images/help_home_banner.gif"></A></TD></TR></TABLE><TABLE cellSpacing=0 cellPadding=0 border=0><TR><TD align=left><A onmouseover="image1.src=loadImage1.src;" onmouseout="image1.src=staticImage1.src;" href="cose.htm"><IMG border=0 name=image1 alt="Clicca per accedere all'argomento" src="../images/help_home_Button_01_Roll-out.gif"></A></TD><TD align=center><A onmouseover="image2.src=loadImage2.src;" onmouseout="image2.src=staticImage2.src;" href="pc.htm"><IMG border=0 name=image2 alt="Clicca per accedere all'argomento" src="../images/help_home_Button_02_Roll-out.gif"></A></TD><TD align=center><A onmouseover="image3.src=loadImage3.src;" onmouseout="image3.src=staticImage3.src;" href="ambsargmod.htm"><IMG border=0 name=image3 alt="Clicca per accedere all'argomento" src="../images/help_home_Button_03_Roll-out.gif"></A></TD><TD align=right><A href="gaguidaan.htm"><IMG border=0 name=image4 alt="Clicca per accedere all'argomento" src="../images/help_home_Button_04_Roll-over.gif"></A></TD></TR><TR><TD colSpan=4><A href="http://www.ntsinformatica.it"><IMG border=0 alt="Clicca per accedere al sito di NTS Informatica" src="../images/help_home_Button_04_Roll-over-row.gif"></A></TD></TR><TR><TD bgColor=#009ee2 height=53 vAlign=middle width=987 colSpan=4 align=left><p><FONT class=title color=white size=6><b>Trasferimento dati per Tentata Vendita/Prevendita</b></FONT></p></TD></TR><TR><TD vAlign=middle colSpan=4 align=left></TD></TR></TABLE><TABLE width=987 border=0>
<TR>
<TD>
<p>
<b>Nome programma: BSTVTRAS.DLL</b>
<br>
<b>Moduli richiesti: Tentata vendita</b>
<br>Opzioni programma: <A href="ampers07.htm#BSTVTRAS">vai alle opzioni</A>
</p>
<p>Il programma consente di trasferire dati da e verso i terminali di tentata vendita.</p>
<p>
<u>
<b>Terminale PocketPC, programmi MIT TvCe 5.0.32 - PvCe 5.0.2</b>
</u>
</p>
<p>I terminali PocketPC possono essere diversi (Compaq iPack, Intermec, ...) ma devono soddisfare i requisiti hardware e software rilevabili dalla documentazione dei programmi TvCe 5.0.32 - PvCe 5.0.2, che risiedono sul terminale.</p>
<p>Non è gestita la funzionalità relativa alla gestione dei mandatari e delle promozioni. Non è altresì gestito lo sconto pagamento indicabile sul programma di Tentata vendita.</p>
<p>A seconda delle caratteristiche dei vari modelli di terminali, il dialogo (ossia il trasferimento dei file) può avvenire attraverso Microsoft ActiveSync o attraverso rete LAN, col supporto FTP.</p>
<p>La tabella dei codici IVA va "sincronizzata" tra Business ed il software di Tentata Vendita/Prevendita sul terminale (tabella TABIVA), in modo tale che, ad esempio, il codice 10 (aliquota 10%) sia codificato come tale in Business e nel programma sul terminale, perchè la tabella dei codici Iva non è esportata da Business. Anche la tabella delle Causali di magazzino va sincronizzata con la tabella causali (tabella CERCAU) del software di Tentata Vendita, tenendo presente che in Business le causali sono numeriche (codice 1-999) e sul terminale sono alfanumeriche; quindi, ad esempio, la causale di Business 20 va codificata come 020 in CERCAU; occorre anche intervenire nel file di configurazione del terminale FLAGS.INI per associare i codici di causale operazione svolte dal programma.</p>
<p>Il programma gestisce anche il nuovo campo "Flag attrezzature" nella anagrafica articoli esportata da Business NET (tabella CERANA, campo Mag_att): sarà utilizzato il campo "Tipo articolo" che se valorizzato a "S" sarà considerato come attrezzatura (x il comodato) in tutti gli altri casi sarà considerato articolo normale. In scrittura del file CERANA, aggiunti campi Mag_vis (impostato fisso a 'S'), Mag_tridef (impostato fisso a blank), Mag_att (impostato a 'S', se ARTICO.ar_tipo = 'S, altrimenti blank).</p>
<p>
<IMG src="../images/help_bstvtr03.gif">
</p>
<p>
<A name=Caricaterminale>
<b>
<u>Carica terminale</u>
</b>
</A>
</p>
<p>Carica i dati sul terminale: il programma genera su apposito tracciato (TvCe 5.0.32 - PvCe 5.0.2) il file, che va trasferito secondo le modalità sopra riportate.</p>
<p>
<b>
<A name=Dataelaborazion>Data elaborazione</A>
</b>Rappresenta la data in cui avviene l'operazione di esportazione, di default è impostata con la data del sistema. Questa data costituisce anche filtro per la validità dei listini.</p>
<p>
<b>
<A name=EsportaTuttiClienti>Esporta tutti i clienti</A>
</b>Se flaggato in fase di esportazione dei clienti, e di tutti i dati collegati ai clienti quali destinazioni diverse, partite aperte, li estrae tutti, indipendentemente dall'agente/vettore associato nelle anagrafiche dei clienti. Se non flaggato, come di default, esporta i soli clienti nella cui anagrafica sono associati l'agente e il vettore indicati in maschera.</p>
<p>
<b>
<A name=ProgrammaTerminale>Programma terminale</A>
</b>Consente la preparazione del file di esportazione specifico per il programma di Tentata Vendita (TvCe) o Prevendita (PvCe). La differenza sta nel fatto che nelle esportazioni per il programma di Prevendita non è richiesta l'indicazione del cod. magazzino e non sono esportate le giacenze di magazzino.</p>
<p>
<b>
<A name=Codmagazzinoaut>Cod. magazzino (automezzo)</A>
</b>Il magazzino rappresenta l'automezzo con cui il vettore/venditore effettua la vendita; ad esempio, come descrizione può essere indicata la targa. Ciò comporta che vanno codificati tanti magazzini (merce propria) quanti sono gli automezzi di cui l'azienda dispone. Il campo è disabilitato in caso di esportazione verso il programma Prevendita (PvCe).</p>
<p>
<b>
<A name=Codagente>Cod. agente</A>
</b>L'agente rappresenta colui che percepisce le provvigioni dalle vendite, mentre il vettore è rappresentato dal venditore (e quindi il terminale) che effettua le vendite. Normalmente quindi vanno codificati tanti agenti quanti sono i vettori. Nella situazione in cui l'azienda si avvale di una società esterna che si dedica alla commercializzazione dei prodotti con tali sistemi, l'agente è rappresentato da tale azienda esterna, su cui sono determinate le provvigioni, mentre il vettore/venditore sarà l'incaricato dell'azienda esterna che si occupa della vendita.</p>
<p>
<b>
<A name=CodVettoretermi>Cod. Vettore (terminale)</A>
</b>Rappresenta il venditore, e quindi anche il terminale. Vedi sopra per ulteriori informazioni.</p>
<p>
<b>
<A name=Documentodicari>Documento di carico XE, numero</A>
</b>Indicare il numero documento della bolla di carico XE, con cui è stato caricato l'automezzo. Se in Business il numero documento possiede la serie, può essere omessa. Il campo è disabilitato in caso d'esportazione verso il programma Prevendita (PvCe).</p>
<p>
<b>
<A name=Documentodicari>Documento di carico XE, data</A>
</b>Indicare la data della bolla di carico XE, con cui è stato caricato l'automezzo, di default è proposta la data di sistema. Il campo è disabilitato se si tratta d'esportazione verso il programma Prevendita (PvCe).</p>
<p>
<b>
<A name=Documentodicari>Documento di carico XE, causale</A>
</b>Indicare la causale di magazzino utilizzata nella bolla di carico XE, con cui è stato caricato l'automezzo. Il campo è disabilitato se si tratta d'esportazione verso il programma Prevendita (PvCe).</p>
<p>
<b>Procedi </b>Attiva il processo di esportazione. Specifiche esportazione dati:</p>
<ol>
<li>Il file di esportazione assume il nome AGExxx.DOS in cui xxx rappresenta il codice agente; il file è generato nel percorso indicato nell'opzione di registro \Bstvtras\PocketPC\PercorsoUpload; se non impostata si assume la cartella in cui è installato Business.
<li>Sono sempre esportati tutti i dati e non le sole variazioni, quindi la base dati del programma dev'essere vuota, ad esclusione delle tabelle relative alle causali di magazzino e codici Iva.
<li>Se già esiste il file, prima di procedere ne è richiesta la sovrascrittura.
<li>Sono gestiti solo agenti e vettori con codici a 3 cifre, max 999 agenti e vettori.
<li>La tabella dei codici IVA non è esportata da Business.
<li>La tabella delle causali di magazzino non è esportata da Business.
<li>Non sono esportate le partite contabili aperte dei clienti.
<li>Specifiche esportazione clienti: <ol>
<li>sono esportati solo quelli relativi al primo mastro clienti dichiarato in ordine di codice nella tabella mastri;
<li>sono esportati solo i clienti associati all'agente e al vettore indicato in maschera, se invece è abilitato il flag "Esporta tutti i clienti" sono esportati tutti i clienti indistintamente;
<li>il programma opera solamente con struttura del piano dei conti standard CCCMMSSSS;
<li>vanno gestiti max 99 listini con non più di 2 cifre, associati ai clienti;
<li>il giorno di visita può essere solo uno nell'arco della settimana ed è rilevato dal campo Giorno di consegna in anagrafica; indicando (Qualsiasi) non è esportato alcun giorno di visita/ordine visita;
<li>per l'ordine visita (campo alfanumerico) è esportato il campo Affidabilità, e rappresenta l'ordine della visita nel giorno di visita sopra indicato. In questo campo possono essere indicati sia lettere che numeri;
<li>i clienti nella cui anagrafica è impostato un qualsiasi tipo di blocco, saranno bloccati anche sul terminale di Tentata Vendita;
<li>sono esportate le destinazioni diverse associate ai clienti selezionati. Sono esportati solo i codici di destinazione &amp;= a 999;
<li>in base al campo Tipo fatt. sul cliente è esportata la tipologia predefinita del documento sul terminale: se indicato Accompagnatoria il documento predefinito è Fattura, se indicato Riepilogativa il documento predefinito è D.D.T., in tutti gli altri casi il documento predefinito è D.D.T. valorizzato;
<li>di default i clienti sono esportati con l'indicazione relativa al "Numero copie documenti da stampare" (campo "cli_ncopie" della tabella "ANACLI") impostata a 1; con l'opzione Bstvtras\Opzioni\NumeroCopieDoc si parametrizza questo valore con un numero che va da 1 a 9.</li>
</ol>
<li>Specifiche esportazione articoli: <ol>
<li>sono esportati SOLO gli articoli che possiedono il flag Stampa in inventario;
<li>non sono esportati gli articoli gestiti a commessa su 'Ordini/Impegno/Magazzino', gli articoli gestiti a fase e gli articoli gestiti a ubicazioni dinamiche;
<li>sono scartati gli articoli il cui codice eccede i 16 caratteri, sono comunque accettati codici articoli numerici e alfanumerici;
<li>l'unità di misura è troncata a 2 caratteri;
<li>non è gestito il prezzo base sugli articoli, sono unicamente esportati i listini;
<li>tutti gli articoli sono esportati come "omaggiabili" nel programma sul terminale.</li>
</ol>
<li>Specifiche esportazione listini: <ol>
<li>sono rilevati solo i listini il cui codice possiede al massimo 2 cifre, max 99;
<li>possono essere gestiti al massimo 99.999 record di listini articolo;
<li>non sono esportati i prezzi speciali articolo/cliente;
<li>sono esportati prezzi con al massimo 3 decimali: se in Business sono abilitate opzioni per portare il numero dei decimali oltre il 3° decimale, i decimali oltre il 3° sono arrotondati. I prezzi, per il software di Tentata vendita, si intendono IVA esclusa;
<li>gli eventuali articoli con moltiplicatore prezzo diverso da 1 sono esportati col prezzo riferito ad 1 UMP: esempio molt. prezzo = 100, prezzo 12,45  è esportato il prezzo 0,125 , arrotondato a 3 decimali;
<li>sono esportati i prezzi di listino unicamente nella valuta di conto;
<li>come data di validità dei listini si utilizza la data elaborazione presente in finestra;
<li>il prezzo di listino non deve essere superiore al valore 99.999.999,99;
<li>non sono esportate le date di validità, sono esportati i soli listini validi alla data di elaborazione;
<li>non sono esportati prezzi di listino a scaglioni di quantità;
<li>non sono esportati gli sconti.</li>
</ol>
<li>Specifiche esportazione barcode: <ol>
<li>sono rilevati i soli codici a barre registrati sulla unità di misura principale;
<li>sono esportati i cod. a barre dei soli articoli esportati;
<li>in presenza di più codici a barre per il medesimo articolo è rilevato il primo, quella con bc_code più basso;</li>
</ol>
<li>Specifiche esportazione tabella pagamenti <ol>
<li>sono esportate tutte le forme di pagamento indicate in Business, per quanto riguarda unicamente codice e descrizione;</li>
</ol>
<li>Specifiche esportazione tabelle agenti, vettori, automezzi <ol>
<li>sono esportati sia gli agenti che i vettori al programma di tentata vendita, tutti quelli codificati nella base dati di Business;
<li>sono esportati e gestiti solo gli agenti e i vettori il cui codice a 2 cifre, max 99;
<li>nella tabella automezzi è esportato unicamente il magazzino (codice e descrizione) indicato in finestra;</li>
</ol>
<li>Specifiche esportazione carico di magazzino <ol>
<li>sono esportate la giacenze correnti, se positive, del magazzino indicato in maschera;
<li>come sopra indicato, non sono trasferite le giacenze di articoli gestiti a fase, commessa, ubicazioni dinamiche;
<li>le giacenze, per gli articoli gestiti a lotti, sono suddivise per lotto;
<li>per gli articoli gestiti a lotto di default è esportato il lotto di Business, numerico o alfanumerico a seconda della gestione scelta, vedi anche <A href="ambsmg31.htm">gestione dei lotti alfanumerici</A>; se abilitata l'opzione di registro Bstvtras\Opzioni\LottoAlfaSePresente a -1 è esportato il campo "Identificativo lotto alfanumerico" (analotto.alo_codalf) se valorizzato e se presente la Anagrafica lotto, altrimenti è valorizzato col lotto di Business, numerico o alfanumerico. Il lotto è inserito nel campo "mov_lot" della tabella "CERMOV" del tracciato di scambio dati col terminalino MIT. Il lotto gestito dal programma di tentata vendita non può essere superiore a 20 caratteri;
<li>se la giacenza risulta essere di quantità &gt; a 99.999.999,999 sarà esportato 99.999.999,999;
<li>come causale movimento di carico giacenze è assegnata la causale di magazzino indicata in maschera, nel riquadro Documento di carico XE.</li>
</ol>
<li>Specifiche esportazione partire aperte: <ol>
<li>è esportato lo scadenziario relativo alle scadenze aperte; se per la partita sono previste più rate, sono esportate tante voci quante sono le rate;
<li>l'estremo della partita esportato su 12 caratteri è formato in questo modo: <ul>
<li>2 cifre per l'anno
<li>1 carattere serie
<li>6 cifre per il numero partita, troncando per partite superiori a 999999;
<li>2 cifre per la rata, troncando per rate superiori a 99;
<li>1 carattere per il flag normale/integrativo, S o N;
<li>ad esempio, 05A00000101N per la partita 1/A, rata 1 del 2015 normale, non integrativa.</li>
</ul>
</li>
</ol>
</li>
</ol>
<p>Terminata la generazione del file, può essere eseguito un comando (da Shell) per il trasferimento del file stesso: la stringa di comando va indicata nell'opzione di registro \Bstvtras\PocketPC\ComandoUpload. Se si vuole eseguire il comando in modalità silent, cioè con interfaccia nascosta, utilizzare l'opzione di registro \Bstvtras\PocketPC\ComandoUploadHide con valore -1; 0 è il valore predefinito.</p>
<p>
<b>
<A name=Scaricaterminal>
<u>Scarica terminale</u>
</A>
</b>
</p>
<p>Consente di scaricare i dati di vendita dal terminale: il programma genera i documenti (corrispettivi o bolle/fatture), impegni clienti e preventivi dal file prelevato dal terminale. Se nei dati prelevati dal terminale sono presenti dati relativi ad incassi, di partite o documenti, il programma alla fine espone un file di testo, aperto con Notepad, con l'elenco degli incassi rilevati. Non sono generate le registrazioni contabili di saldo delle partite.</p>
<p>
<IMG src="../images/help_bstvtr04.gif">
</p>
<p>
<b>
<A name=Codmagazzinoaut>Cod. magazzino (automezzo)</A>
</b>Rappresenta il magazzino su cui avvengono i movimenti nei documenti di magazzino acquisiti (bolle, fatture o corrispettivi). Se si effettua importazione da PvCe (programma di prevendita) è il magazzino su cui sono importati gli ordini acquisiti.</p>
<p>
<b>
<A name=Codagente>Cod. agente</A>
</b>L'agente rappresenta colui che percepisce le provvigioni dalle vendite, determinate al momento dell'acquisizione.</p>
<p>
<b>
<A name=CodVettoretermi>Cod. Vettore (terminale)</A>
</b>Rappresenta il venditore, e quindi anche il terminale. É effettuato un controllo nel file acquisito, in modo che il vettore indicato in maschera corrisponda al vettore indicato sul file.</p>
<p>
<A name=Estremidocument>
<b>Estremi documenti da generare, Corrispettivi</b>
</A>Genera un unico documento di tipo Corrispettivo emesso, ignorando qualsiasi suddivisione in documenti presente nel file acquisito da terminale. Il numero del documento è ri-attribuito dalla tabella delle numerazioni.</p>
<p>
<b>
<A name=Estremidocument>Estremi documenti da generare, Bolle/fatture</A>
</b>Genera documenti in base al tipo indicato nel file acquisito. Come numero documento è mantenuto quello presente nel file prelevato da terminale.</p>
<p>
<b>
<A name=Estremidocument>Estremi documenti da generare, Serie</A>
</b>É la serie dei documenti acquisiti, di default è indicato [spazio].</p>
<p>
<b>
<A name=Estremidocument>Estremi documenti da generare, Anno</A>
</b>É l'anno dei documenti acquisiti, di default è indicato l'anno della data di sistema.</p>
<p>
<b>
<A name=Estremidocument>Estremi documenti da generare, Deroga data documenti</A>
</b>Se selezionata, è possibile indicare la data da attribuire ai documenti generati in deroga alla data presente nel file acquisito.</p>
<p>
<b>
<A name=Estremidocument>Estremi documenti da generare, Acquisisci ordini</A>
</b>Se selezionato, il programma acquisisce anche gli ordini/preventivi.</p>
<p>
<b>
<A name=Estremidocument>Estremi documenti da generare, Acquisisci ordini, Serie</A>
</b>É la serie degli ordini acquisiti, di default è indicato [spazio].</p>
<p>
<b>
<A name=Estremidocument>Estremi documenti da generare, Acquisisci ordini, Anno</A>
</b>É l'anno degli ordini acquisiti, di default è indicato l'anno della data di sistema.</p>
<p>
<b>
<A name=Procedipulsante>Procedi</A>
</b>Attiva il processo d'importazione dei documenti. Specifiche importazione documenti:</p>
<ol>
<li>Il file da importare assume il nome AGExxx.OUT dove xxx rappresenta il codice agente; il file è di default rilevato nel percorso indicato nell'opzione di registro Bstvtras\PocketPC\PercorsoDownload; se non impostata, s'assume la cartella in cui è installato Business; attraverso l'opzione Bstvtras\PocketPC\EstensioneFileDownload, che di default vale OUT, è possibile specificare una diversa estensione al file da acquisire.
<li>Prima di procedere con l'acquisizione dei dati può essere eseguito un comando (da Shell sincrona) per il trasferimento del file stesso da terminale a PC: la stringa di comando va indicata nell'opzione di registro Bstvtras\PocketPC\ComandoDownload. Se si esegue il comando in modalità silent (con interfaccia nascosta) si utilizza l'opzione di registro Bstvtras\PocketPC\ComandoDownloadHide con valore -1; 0 è il valore predefinito.
<li>Il file da acquisire è comunque scelto attraverso una finestra di selezione del file.
<li>Nel programma di Tentata vendita residente sul terminale PocketPC, s'imposta un'opzione che consente di riportare la serie (campo Bol_bar) uguale al campo tipo documento (campo Bol_tdo) nel tracciato di ritorno con i documenti, sia sulle testate che sulle righe. Per effettuare questa operazione nel file di configurazione FLAGS.INI del programma TCVE occorre aggiungere l'opzione, in coda a quelle presenti, BarraDoc=S.
<li>Non sono acquisti, come sopra riportato, gli incassi relativi a partite aperte pregresse dei clienti e non è gestito lo sconto pagamento indicabile sul programma del terminale.
<li>Specifiche importazione testate documenti: <ol>
<li>il tipo del documento generato è un Corrispettivo emesso se in maschera è indicata l'opzione su Corrispettivi, e in tal caso è generato un unico documento contenente tutte le righe, in caso contrario è una Fattura immediata emessa se nel programma di Tentata Vendita si è scelto un tipo doc. Fattura, oppure DDT emesso se nel programma sul terminale si è scelto DDT o DDT valorizzato, in tal caso sono generati tanti documenti quanti sono quelli presenti nel file acquisito da terminale;
<li>la serie e l'anno dei documenti/ordini generati è sempre quella indicata in maschera prima di procedere;
<li>il numero documento è letto dalle numerazioni, se si è scelto di importare i movimenti come corrispettivi, è invece attribuito quello assegnato dal programma sul terminale in caso si acquisiscano come bolle o fatture; in tal caso non sono aggiornate le numerazioni di Business. É da tener presente che nel caso esista già un documento con gli stessi estremi (tipo, anno, serie, numero) sarà segnalata tale situazione e scartato il documento;
<li>il conto intestatario dei documenti generati è rappresentato dal conto (fornitore) associato all'agente se si è scelto d'importare i movimenti come unico corrispettivo; è invece attribuito quello assegnato dal programma sul terminale in caso si acquisiscano come bolle o fatture, in quest'ultimo caso, sarà scartato l'intero documento se il cliente acquisito non esiste nella base dati di Business;
<li>la destinazione diversa è acquisita dal programma terminale nel caso in cui s'importino i documenti come bolle/fatture/ordini. Nel caso di acquisizione dei documenti come unico corrispettivo, la destinazione diversa del documento è posta a zero.
<li>la data del documento è acquisita dal file prelevato dal terminale, a meno che non si sia selezionato in maschera di derogare la data. Nel caso di acquisizione come corrispettivi, la data dell'unico documento è rilevata dal primo movimento letto nel file;
<li>per gli ordini, la data di consegna equivale alla data ordine;
<li>il codice pagamento è acquisito dal file prelevato dal terminale;
<li>lo sconto pagamento NON viene acquisito;
<li>il codice tipo bolla/fattura assume codice 1 fisso; ciò comporta che tale codice dev'essere presente nella base dati di Business;
<li>i documenti sono acquisiti unicamente nella valuta di conto;
<li>il documento è di tipo Iva compresa (scorporo), se acquisito come corrispettivo emesso, è invece con prezzi Iva esclusa in caso siano acquisiti come bolle/fatture/ordini. Visto che il programma di Tentata Vendita opera unicamente con prezzi Iva esclusa, quando s'importano i movimenti come corrispettivo, i prezzi letti sono dapprima con Iva, quindi scorporati, per rispettare le regole di calcolo dei documenti in regime di scorporo; ciò determina inevitabili differenze a livello di totale documento per effetto degli arrotondamenti;
<li>i campi agente e magazzino 1 sono rilevati direttamente dalla finestra;
<li>l'agente 2 normalmente è valorizzato a zero; se abilitata l'opzione di registro <code><A href="ampers07.htm#BSTVTRAS_OPZIONI_RilevaAgente2DaAnagrafica">BSTVTRAS\OPZIONI\RilevaAgente2DaAnagrafica</A> = -1</code> il programma, importando fatture/DDT e ordini, valorizza il campo col codice agente 2 (subagente) indicato in Anagrafica cliente. Non è valorizzato il campo per i documenti di tipo corrispettivo, perchè il programma crea un unico documento cumulativo di tutte le vendite, intestato al fornitore associato all'agente indicato in finestra;
<li>come campo causale di testata è utilizzata una qualsiasi causale presente sulle righe;
<li>il campo incassato di piede è rilevato dal file del terminale in caso di acquisizione dei movimenti come bolle/fatture, è reso uguale al totale documento in caso di acquisizione dei movimenti come corrispettivo;
<li>i campi codice esenzione e listino sono rilevati dall'anagrafica del conto intestatario del documento;
<li>Addebita spese incasso e addebita spese bolli non sono mai selezionati, pertanto non sono rilevate eventuali spese d'incasso / bolli;
<li>i campi Abi e Cab sono rilevati dall'anagrafica del conto intestatario del documento;
<li>tutti i campi di totalizzazione (castelletti, totali merce, totali documento,...) sono ricalcolati in base alle normali regole di calcolo dei documenti.</li>
</ol>
<li>Specifiche importazione righe documenti: <ol>
<li>se il codice articolo rilevato dal file non esiste nella base dati di Business, è utilizzato in sua vece l'articolo D nella descrizione articolo, sul movimento è inserita la stringa Articolo XXX inesistente;
<li>le causali di magazzino sono acquisite dal file esterno e differenziate se si tratta di riga omaggio, reso o vendita;
<li>in caso di riga omaggio, il campo Stampa a Omaggio (Imp.+IVA);
<li>il codice Iva è acquisito dal file esterno;
<li>il prezzo è rilevato tal quale dal file rilevato dal terminale, se il documento è acquisito come bolla/fattura/ordini; è invece con Iva e successivamente scorporato se il documento è acquisto come corrispettivo: ciò determina differenze a livello di totale documento a causa degli arrotondamenti. Nel caso di documento corrispettivo, con righe di tipo reso, il prezzo e il prezzo con Iva sono resi negativi per far corrispondere il totale documento; a livello di quantità invece è mantenuta positiva poichè sarà il segno dell'apposita causale di reso a determinare che si tratta di carico di magazzino, e non di scarico. I prezzi s'intendono sempre relativi ad una unità di misura principale dell'articolo, non sono infatti previsti i moltiplicatori prezzo/q.tà;
<li>sono rilevati i 4 sconti di riga gestiti dal programma Tentata vendita;
<li>le provvigioni, sia a percentuale che valore, sono rilevate secondo le normali regole di priorità presenti in Business;
<li>le provvigioni dell'agente 2, sia a percentuale che valore, sono rilevate secondo le normali regole di priorità presenti in Business, se è valorizzato in testata l'agente 2, vedi sopra;
<li>il campo valore riga è ricalcolato nel momento dell'importazione della riga;
<li>la contropartita vendite è rilevata dall'articolo;
<li>i campi codice famiglia, conto contropartita, codice centro e i campi Intrastat non sono impostati;
<li>i numeri di riga sono riattribuiti;
<li>il lotto è rilevato dal file esterno (campo "boc_lot" della tabella "VNBOLCOR"), di default se il lotto acquisito dal file è numerico, è acquisito nel movimento, altrimenti compare un messaggio informativo e acquisita la riga con lotto a zero, da integrare in seguito a mano da parte dell'operatore; invece se è abilitata l'opzione di registro Bstvtras\Opzioni\LottoAlfaSePresente a -1, il programma rileva il lotto nel modo seguente: <ol>
<li>il lotto rilevato dal file è controllato se presente nell'Anagrafica lotti per l'articolo corrente, rilevandolo dal campo Identificativo lotto alfanumerico ed è acquisito il lotto di Business, numerico o alfanumerico a seconda della gestione scelta; vedi anche <A href="ambsmg31.htm">gestione dei lotti alfanumerici</A>. Se sono presenti più anagrafiche lotti relative allo stesso articolo e stesso identificativo lotto alfanumerico, è rilevato il lotto più basso;
<li>se il punto 1. ha esito negativo e il lotto rilevato dal file esterno è numerico, è inserito tal quale nel movimento di magazzino di Business;
<li>se il punto 1. ha esito negativo, il lotto rilevato dal file esterno è alfanumerico e l'articolo è gestito a lotti, il movimento è assegnato al lotto fittizio indicato nell'opzione di registro BSTVTRAS\OPZIONI\LottoFittizio, che di default assume valore 999999999. Nel campo Note del documento di magazzino è conservato il lotto alfanumerico presente nel file esterno non rilevato nell'Anagrafica lotti di Business, nel formato "Lotto: <i>id_lotto_alfanumerco</i>". Se l'articolo non è gestito a lotti, il movimento riporta il lotto pari a zero.</li>
</ol>
<p>Se il carico del terminalino è stato eseguito con l'opzione Bstvtras\Opzioni\LottoAlfaSePresente disabilitata, anche lo scarico deve avvenire con l'opzione impostata allo stesso modo: ci deve essere congruenza tra file di carico e quello di scarico. Il lotto gestito dal programma Tentata vendita non può essere superiore a 20 caratteri.</p>
</li>
</ol>
<li>Al termine dell'importazione il file NON è eliminato.</li>
</ol>
</TD></TR></TABLE><TABLE border=0 cellSpacing=0 cellPadding=0><TR><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/software-retail-negozi/"><IMG border=0 src="../images/help_home_01_Gestisci.gif"></A></TD><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/controllo-di-gestione/"><IMG border=0 src="../images/help_home_02_Controlla.gif"></A></TD><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/crm/"><IMG border=0 src="../images/help_home_03_Fidelizza.gif"></A></TD><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/analisi-dati-datawarehouse/"><IMG border=0 src="../images/help_home_04_DWH.gif"></A></TD><TD vAlign=center width=169 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/project-management/"><IMG border=0 src="../images/help_home_05_Gestisci.gif"></A></TD><TD vAlign=center width=146 align=right><IMG border=0 src="../images/help_home_NTS_logo_up.gif"></TD></TR><TR><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/logistica/"><IMG border=0 src="../images/help_home_06_Organizza.gif"></A></TD><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/customer-service/"><IMG border=0 src="../images/help_home_07_Gestisci.gif"></A></TD><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/produzione/"><IMG border=0 src="../images/help_home_08_Pianifica.gif"></A></TD><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/archiviazione-documenti/"><IMG border=0 src="../images/help_home_09_Archivia.gif"></A></TD><TD vAlign=center width=169 align=right><IMG border=0 src="../images/help_home_NTS_logo_down1.gif"></TD><TD vAlign=center width=146 align=right><A href="http://www.ntsinformatica.it"><IMG border=0 alt="Clicca per accedere al sito di NTS Informatica" src="../images/help_home_NTS_logo_down2.gif"></A></TD></TR><TR><TD width=987 colSpan=6><IMG border=0 src="../images/help_home_Line.gif"></TD></TR></TABLE></body></html>