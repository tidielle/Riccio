<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3c.org/TR/1999/REC-html401-19991224/loose.dtd">
<html>
<head>
<title> AM: Configurazioni per importare da Excel</title>
<LINK rel=stylesheet type=text/css href="style_topic.css">
<SCRIPT LANGUAGE="JavaScript">
<!-- Begin
loadImage1 = new Image();
loadImage1.src = "../images/help_home_Button_01_Roll-over.gif";
staticImage1 = new Image();
staticImage1.src = "../images/help_home_Button_01_Roll-out.gif";

loadImage2 = new Image();
loadImage2.src = "../images/help_home_Button_02_Roll-over.gif";
staticImage2 = new Image();
staticImage2.src = "../images/help_home_Button_02_Roll-out.gif";

loadImage3 = new Image();
loadImage3.src = "../images/help_home_Button_03_Roll-over.gif";
staticImage3 = new Image();
staticImage3.src = "../images/help_home_Button_03_Roll-out.gif";

loadImage4 = new Image();
loadImage4.src = "../images/help_home_Button_04_Roll-over.gif";
staticImage4 = new Image();
staticImage4.src = "../images/help_home_Button_04_Roll-out.gif";

// End -->
</SCRIPT>

</head>
<body lang=it topMargin=3>
<TABLE width=987 border=0><TR><TD vAlign=top align=right><p><code>Data ultimo aggiornamento: <A name=hINIeDATlAGGp></A>31/07/2015</FONT><A name=hFINeDATlAGGp></A></code></p></TD></TR></TABLE><TABLE cellSpacing=0 border=0><TR><TD colSpan=4><A href="http://www.ntsinformatica.it"><IMG border=0 alt="Clicca per accedere al sito di NTS Informatica" src="../images/help_home_banner.gif"></A></TD></TR></TABLE><TABLE cellSpacing=0 cellPadding=0 border=0><TR><TD align=left><A onmouseover="image1.src=loadImage1.src;" onmouseout="image1.src=staticImage1.src;" href="cose.htm"><IMG border=0 name=image1 alt="Clicca per accedere all'argomento" src="../images/help_home_Button_01_Roll-out.gif"></A></TD><TD align=center><A onmouseover="image2.src=loadImage2.src;" onmouseout="image2.src=staticImage2.src;" href="pc.htm"><IMG border=0 name=image2 alt="Clicca per accedere all'argomento" src="../images/help_home_Button_02_Roll-out.gif"></A></TD><TD align=center><A href="ambsargmod.htm"><IMG border=0 name=image3 alt="Clicca per accedere all'argomento" src="../images/help_home_Button_03_Roll-over.gif"></A></TD><TD align=right><A onmouseover="image4.src=loadImage4.src;" onmouseout="image4.src=staticImage4.src;" href="gaguidaan.htm"><IMG border=0 name=image4 alt="Clicca per accedere all'argomento" src="../images/help_home_Button_04_Roll-out.gif"></A></TD></TR><TR><TD colSpan=4><A href="http://www.ntsinformatica.it"><IMG border=0 alt="Clicca per accedere al sito di NTS Informatica" src="../images/help_home_Button_03_Roll-over-row.gif"></A></TD></TR><TR><TD bgColor=#009ee2 height=53 vAlign=middle width=987 colSpan=4 align=left><p><FONT class=title color=white size=6><b>Configurazioni per importare da Excel</b></FONT></p></TD></TR><TR><TD vAlign=middle colSpan=4 align=left></TD></TR></TABLE><TABLE width=987 border=0>
<TR>
<TD>
<p>Codificare nella <A href="bsieprof.htm">Definizione profili</A> il profilo di importazione.</p>
<p>Codificare nella <A href="bsiesctb.htm">Definizione schema tabella esterne</A> il nome della tabella (identificatore univoco) e il nome del file XLS da cui importare, indicando come <A href="bsiesctb.htm#TipoTabella">Tipo tabella</A> "Jet o altri Jet ISAM" e come <A href="bsiesctb.htm#Stringadiconn">Stringa di connessione</A> "EXCEL 8.0;HDR=No;IMEX=1" o "Excel 12.0;HDR=No;IMEX=1" (senza doppi apici). La direttiva "IMEX=1;" indica al driver Excel ISAM di usare la modalità Import, la quale utilizza i parametri di registro di Windows descritti più sotto. Nell'<A href="bsiesctb.htm#Elencocampi">Elenco campi</A> si definiscono nell'ordine i nomi dei campi F1, F2, F3, F4, ... corrispondenti alle colonne dell'area da importare. I campi saranno tipizzati in base al contenuto dei dati in ogni singola colonna.</p>
<p>Nella <A href="bsiemptb.htm">Impostazione Import/Export</A> si crea la corrispondenza tabelle col nome della tabella di Business (da scrivere) e la tabella esterna (file XLS); nella colonna <A href="bsiemptb.htm#ClausolaFROM">Clausola FROM</A> si indica ad esempio "[NomeFoglio$A1:E100]" dove va indicato esplicitamente il nome del foglio e l'area in cui leggere i dati da importare. Ovviamente il numero delle colonne selezionate deve corrispondere al numero dei campi definiti nello Schema tabelle esterne. Per quanto riguarda le righe, invece, indicare un range di righe sufficientemente ampio per evitare che import successivi con più dati non importino tutti i record. Le eventuali righe vuote finali non vengono importate. Se nella prima righa sono indicati i nomi delle colonne scartare la prima righa dal range di selezione (ad esempio [NomeFoglio$A2:E100]).</p>
<p>
<IMG src="../images/help_amimpexp05_01.jpg" width=987>
</p>
<p>
<b>
<A name=Modificaallachi>Modifica alla chiave di registro</A>
</b>
</p>
<p>Sulla macchina in cui si esegue l'importazione occorre modificare le seguenti opzioni di registro sotto la cartella HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Jet\3.5\Engines\Excel (per Excel 97) e sotto la cartella HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Jet\4.0\Engines\Excel (per Excel 2000 e successive versioni)</p>
<p>NB: per le macchine a 64bit tale percorso si trova sotto: 
<br>HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\Microsoft\Jet\3.5\Engines\Excel (per Excel 97) e sotto la cartella HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\Microsoft\Jet\4.0\Engines\Excel (per Excel 2000 e successive versioni)</p>
<p>ci possono essere altri punti a seconda della versione di Office, per esempio 
<br>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Office\12.0\Access Connectivity Engine\Engines\Excel 
<br>HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\Microsoft\Office\12.0\Access Connectivity Engine\Engines\Excel 
<br>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Office\13.0\Access Connectivity Engine\Engines\Excel 
<br>HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\Microsoft\Office\13.0\Access Connectivity Engine\Engines\Excel 
<br>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Office\14.0\Access Connectivity Engine\Engines\Excel 
<br>HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\Microsoft\Office\14.0\Access Connectivity Engine\Engines\Excel 
<br>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Office\15.0\Access Connectivity Engine\Engines\Excel 
<br>HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\Microsoft\Office\15.0\Access Connectivity Engine\Engines\Excel 
<br>
</p>
<p>
<i>
<u>FirstRowHasNames</u>
</i>, indicando il valore '00' al posto di '01' (significa che nella prima riga del foglio Excel ci sono dati significativi e non i titoli di colonna):</p>
<p>
<IMG src="../images/help_bsieexcel1.gif">
</p>
<p>Modificare il valore in '00':</p>
<p>
<IMG src="../images/help_bsieexcel2.gif">
</p>
<p>
<i>
<u>TypeGuessRows</u>
</i>, indicando il valore '0' al posto di '8' (comanda al driver di scandire tutte le righe per decidere il tipo di dato in una colonna, anziché scandire solo le prime 8 righe; questo può risultare in un maggiore impegno di tempo durante l'import di dati, ma esclude errori di conversione):</p>
<p>
<IMG src="../images/help_bsieexcel3.gif">
</p>
<p>Modificare il valore in '0':</p>
<p>
<IMG src="../images/help_bsieexcel4.gif">
</p>
<p>
<i>
<u>ImportMixedTypes</u>
</i>, lasciare il valore predefinito 'Text' (indica al driver di convertire i dati letti in testo se sono presenti dati misti, ad es. valori numerici, date, testo, ...):</p>
<p>
<IMG src="../images/help_bsieexcel5.gif">
</p>
<p>Nelle nuove versioni l'opzione del registro di windows per segnalare se considerare la prima riga del foglio di EXCEL come intestazione di colonna o meno, non viene più letta dal registro, se non definito con l'apposito parametro nella stringa di connessione, la prima riga del file viene considerata sempre come 'intestazione di colonna' ed i dati partono sempre dalla riga 2. Per indicare come considerare la prima riga occorre passare un parametro aggiuntivo HDR=Yes o HDR=No nella stringa di connessione: con HDR=No il nome delle colonne del datatable sarà F1, F2, F3, diversamente il nome viene preso dalla cella della prima riga del foglio di excel, per esempio "Excel 8.0;HDR=Yes;IMEX=1" o "Excel 12.0;HDR=Yes;IMEX=1".</p>
<p>Lanciando un import da excel xlsx potrebbe verificarsi l'errore 'Il provider 'Microsoft.ACE.OLEDB.12.0' non è registrato nel computer locale.', questo probabilmente perchè l'installazione di office non ha installato il componente in oggetto, installare i seguenti componenti <A href="http://www.microsoft.com/en-us/download/details.aspx?id=23734">http://www.microsoft.com/en-us/download/details.aspx?id=23734</A>.</p>
</TD></TR></TABLE><TABLE border=0 cellSpacing=0 cellPadding=0><TR><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/software-retail-negozi/"><IMG border=0 src="../images/help_home_01_Gestisci.gif"></A></TD><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/controllo-di-gestione/"><IMG border=0 src="../images/help_home_02_Controlla.gif"></A></TD><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/crm/"><IMG border=0 src="../images/help_home_03_Fidelizza.gif"></A></TD><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/analisi-dati-datawarehouse/"><IMG border=0 src="../images/help_home_04_DWH.gif"></A></TD><TD vAlign=center width=169 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/project-management/"><IMG border=0 src="../images/help_home_05_Gestisci.gif"></A></TD><TD vAlign=center width=146 align=right><IMG border=0 src="../images/help_home_NTS_logo_up.gif"></TD></TR><TR><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/logistica/"><IMG border=0 src="../images/help_home_06_Organizza.gif"></A></TD><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/customer-service/"><IMG border=0 src="../images/help_home_07_Gestisci.gif"></A></TD><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/produzione/"><IMG border=0 src="../images/help_home_08_Pianifica.gif"></A></TD><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/archiviazione-documenti/"><IMG border=0 src="../images/help_home_09_Archivia.gif"></A></TD><TD vAlign=center width=169 align=right><IMG border=0 src="../images/help_home_NTS_logo_down1.gif"></TD><TD vAlign=center width=146 align=right><A href="http://www.ntsinformatica.it"><IMG border=0 alt="Clicca per accedere al sito di NTS Informatica" src="../images/help_home_NTS_logo_down2.gif"></A></TD></TR><TR><TD width=987 colSpan=6><IMG border=0 src="../images/help_home_Line.gif"></TD></TR></TABLE></body></html>