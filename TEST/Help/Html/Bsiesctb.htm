<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3c.org/TR/1999/REC-html401-19991224/loose.dtd">
<html>
<head>
<title> GA: Definizione schema tabelle esterne</title>
<LINK rel=stylesheet type=text/css href="style_topic.css">
<SCRIPT LANGUAGE="JavaScript">
<!-- Begin
loadImage1 = new Image();
loadImage1.src = "../images/help_home_Button_01_Roll-over.gif";
staticImage1 = new Image();
staticImage1.src = "../images/help_home_Button_01_Roll-out.gif";

loadImage2 = new Image();
loadImage2.src = "../images/help_home_Button_02_Roll-over.gif";
staticImage2 = new Image();
staticImage2.src = "../images/help_home_Button_02_Roll-out.gif";

loadImage3 = new Image();
loadImage3.src = "../images/help_home_Button_03_Roll-over.gif";
staticImage3 = new Image();
staticImage3.src = "../images/help_home_Button_03_Roll-out.gif";

loadImage4 = new Image();
loadImage4.src = "../images/help_home_Button_04_Roll-over.gif";
staticImage4 = new Image();
staticImage4.src = "../images/help_home_Button_04_Roll-out.gif";

// End -->
</SCRIPT>

</head>
<body lang=it topMargin=3>
<TABLE width=987 border=0><TR><TD vAlign=top align=right><p><code>Data ultimo aggiornamento: <A name=hINIeDATlAGGp></A>28/07/2015</FONT><A name=hFINeDATlAGGp></A></code></p></TD></TR></TABLE><TABLE cellSpacing=0 border=0><TR><TD colSpan=4><A href="http://www.ntsinformatica.it"><IMG border=0 alt="Clicca per accedere al sito di NTS Informatica" src="../images/help_home_banner.gif"></A></TD></TR></TABLE><TABLE cellSpacing=0 cellPadding=0 border=0><TR><TD align=left><A onmouseover="image1.src=loadImage1.src;" onmouseout="image1.src=staticImage1.src;" href="cose.htm"><IMG border=0 name=image1 alt="Clicca per accedere all'argomento" src="../images/help_home_Button_01_Roll-out.gif"></A></TD><TD align=center><A onmouseover="image2.src=loadImage2.src;" onmouseout="image2.src=staticImage2.src;" href="pc.htm"><IMG border=0 name=image2 alt="Clicca per accedere all'argomento" src="../images/help_home_Button_02_Roll-out.gif"></A></TD><TD align=center><A onmouseover="image3.src=loadImage3.src;" onmouseout="image3.src=staticImage3.src;" href="ambsargmod.htm"><IMG border=0 name=image3 alt="Clicca per accedere all'argomento" src="../images/help_home_Button_03_Roll-out.gif"></A></TD><TD align=right><A href="gaguidaan.htm"><IMG border=0 name=image4 alt="Clicca per accedere all'argomento" src="../images/help_home_Button_04_Roll-over.gif"></A></TD></TR><TR><TD colSpan=4><A href="http://www.ntsinformatica.it"><IMG border=0 alt="Clicca per accedere al sito di NTS Informatica" src="../images/help_home_Button_04_Roll-over-row.gif"></A></TD></TR><TR><TD bgColor=#009ee2 height=53 vAlign=middle width=987 colSpan=4 align=left><p><FONT class=title color=white size=6><b>Definizione schema tabelle esterne</b></FONT></p></TD></TR><TR><TD vAlign=middle colSpan=4 align=left></TD></TR></TABLE><TABLE width=987 border=0>
<TR>
<TD>
<p>
<b>Nome programma: BSIESCTB.DLL</b>
<br>
<b>Moduli richiesti: Import/Export</b>
<br>Report programma: <A href="ampers08.htm#BSIESCTB">vai ai report</A>
</p>
<p>Con questo programma è possibile definire le caratteristiche delle tabelle su cui Business deve andare a scrivere, nel caso di esportazioni, o da cui deve leggere, nel caso di importazioni.</p>
<p>
<u>
<i>
<b>Elenco tabelle:</b>
</i>
</u>
</p>
<p>
<IMG src="../images/help_bsiesctb.gif">
</p>
<p>
<b>
<A name=Nometabella>Nome tabella</A>
</b>
</p>
<p>Stringa di massimo 30 caratteri che identifica il nome della tabella esterna, se si tratta di un file ASCII può rappresentare il nome del file.</p>
<p>
<b>
<A name=Nomedelfile>Nome del file</A>
</b>
</p>
<p>Stringa di massimo 30 caratteri che identifica il nome del file, può essere uguale al nome tabella se si tratta di file ASCII (si consiglia come estensione del file <code>.txt</code>); se si tratta di file di Microsoft Access rappresenta il nome del file MDB (estensione inclusa). Se il nome del file inizia per ? (per esempio ?artico.txt) nel momento in cui il programma <A href="bsieimpo.htm">Strumento di import/export</A> dovrà aprire il file per leggerlo o scriverlo apparirà la schermata per poter indicare dove prelevare il file (ed eventualmente anche cambiare il nome de file stesso).</p>
<p>
<b>
<A name=Descrizionetabe>Descrizione tabella</A>
</b>
</p>
<p>è la descrizione della tabella esterna; una stringa di massimo 50 caratteri non obbligatoria.</p>
<p>
<b>
<A name=TipoTabella>Tipo tabella</A>
</b>
</p>
<p>Rappresenta il tipo di tabella e può assumere i seguenti valori:</p>
<ul>
<li>
<u>Jet ISAM</u>: file ASCII leggibile con driver Text ISAM di Microsoft Jet
<li>
<u>ASCII Text File</u>: file ASCII scrivibile gestito direttamente dal programma
<li>
<u>Jet o altri Jet ISAM</u>: tabella Microsoft Jet oppure accessibile medianti altri driver ISAM sempre per Microsoft Jet (DBF, Paradox, Foxpro, ...), attualmente sono gestiti solo database MSAccess in import/export e MSExcel in import
<li>
<u>Xml</u>: file XML gestito direttamente dal programma sia in lettura che in scrittura (solo per profili che fanno uso del motore NET)
<li>
<u>OleDbConnection</u>: per importare o esportare direttamente su tabelle di SQL Server, per ulteriori informazioni vedere <A href="amimpexp06.htm">Import/export da OLEDBProvider generico</A>
</li>
</ul>
<p>è l'impostazione di questo campo che indica al motore di import/export le strategie di lettura e scrittura dei dati. Mentre per file di tipo ASCII occorre definire due tracciati (uno per l'import ed uno per l'export), per file esterni di tipo MSAccess e Xml ne occorre soltanto uno.</p>
<p>
<b>
<A name=Stringadiconn>Stringa di connessione</A>
</b>
</p>
<p>è la stringa di connessione da utilizzare quando si usa un tipo tabella <u>Jet o altri Jet ISAM</u> per accedere ad archivi diversi da MSAccess mediante driver ISAM (DBF, Paradox, Foxpro, ...). Ad esempio, per MSExcel sarà "EXCEL 8.0; IMEX=1;" (senza doppi apici).</p>
<p>Note particolari su Tipo tabella/Stringa di connessione (solo per profili che fanno uso del motore NET):</p>
<ul>
<li>
<u>Jet o altri Jet ISAM</u>/MSAccess: in export su MDB sono gestiti db di tipo 1997 (default), 2000, 2003 (identico a 2000) e 2007. Per impostare altri tipi di db basta indicare nello schema tabella esterna, nella colonna stringa di connessione il valore 'Access 1997' oppure 'Access 2000' oppure 'Access 2007' (per access 2007 l'estensione del file deve essere .accdb, ma bus non lo controlla). Per ora in export su MDB nelle tabelle create non vengono settate le regole di validazione del campo, il campo richiesto e consenti lunghezza 0.
<li>
<u>Xml</u>: in export su XML ad inizio elaborazione il file .xml viene sempre distrutto. Se l'elaborazione prevede l'export di diverse tabelle e più di una dovrà essere scritta sullo stesso file .xml, i dati verranno accodati. In caso di relazioni tra tabelle in export, verrà realizzato un file master-detail solo se il nome del file .xml di export è lo stesso su entrambi gli schemi tabelle esterne. Specifiche di file, come ad esempio indicare nell'intestazione file xml il carattere utilizzato (per esempio standalone="yes"), vanno riportare nello schema tabelle esterne nel campo stringa di connessione. In fase di impostazione tabelle esterne, il tracciato per il file .xml deve essere realizzato come se si stesse producendo un export su ASCII. Per assegnare un nome al tag di inizio/fine tabella (il default è come il nome della tabella esterna seguito da '_table') basta scriverlo in schema tabelle esterne nel campo <u>Descrizione</u> (e deve essere diverso dal nome della tabella esterna). <b>NB:</b> in import da XML non è possibile utilizzare i campi select, from, where, group by, having, order by personalizzati.
<li>
<u>Jet o altri Jet ISAM</u>/MSExcel: in import è gestita anche l'acquisizione da file di excel 2007 e superiori in formato xlsx, indicando nella stringa di connessione il parametro Excel 12.0 invece di Excel 8.0. 
<br>L'opzione del registro di windows per segnalare se considerare la prima riga del foglio di EXCEL come intestazione di colonna o meno, non viene più letta dal motore 12 di excel, se non definito con l'apposito parametro nella stringa di connessione, la prima riga del file viene considerata sempre come 'intestazione di colonna' ed i dati partono sempre dalla riga 2. 
<br>Per indicare come considerare la prima riga occorre passare un parametro aggiuntivo HRD=Yes o HDR=No nella stringa di connessione: con NO il nome delle colonne del datatable sarà F1, F2, F3, diversamente il nome viene preso dalla cella della prima riga del foglio di excel. 
<br>Esempio: "Excel 12.0;HDR=No;IMEX=1"</li>
</ul>
<p>
<b>
<A name=ProprietagraveC>Proprietà ColNameHeader</A>
</b>
</p>
<p>è da indicare solamente se il tipo tabella ha valore <u>Jet ISAM</u>; può assumere i valori 'True' (impostazione predefinita) o 'False' a seconda che il file ASCII possieda, o meno, nella prima riga i nomi dei campi.</p>
<p>
<b>
<A name=ProprietagraveF>Proprietà format</A>
</b>
</p>
<p>è da indicare solamente se il tipo tabella ha valore <u>Jet ISAM</u>, consiste nel tipo di formato del file ASCII e può assumere i valori: 'FixedLength' se i campi sono a lunghezza fissa (impostazione predefinita); 'TabDelimited' se i campi sono delimitati da caratteri Tab; 'Delimited(<i>x</i>)' se i campi sono delimitati dal carattere <i>x</i>. Il carattere <i>x</i> indica un carattere generico, a seconda del carattere indicato come separatore sarà necessario sostituire la <i>x</i> con il relativo carattere nella combo box in questione. Supponiamo i campi sono separati da un <i>!</i> si dovrà sostituire la <i>x</i>con <i>!</i>.</p>
<p>Note particolari su Tipo tabella/Proprietà Format (solo per profili che fanno uso del motore NET):</p>
<ul>
<li>
<u>ASCII Text File</u>: ora in export sono gestiti nativamente file ASCII non a lunghezza fissa (come già gestito in import). Per poterli settare basta indicare nello schema tabelle come tipo di file 'ASCII Text file' e come 'Proprietà format' un valore diverso da 'FixedLength'. <b>NB:</b> un file di export 'ASCII Text file' di tipo 'CSVDelimited' se salvato con estensione CSV può essere aperto da MSExcel (corrisponde ad un file di testo a lunghezza variabile con separatore ";").</li>
</ul>
<p>
<b>
<A name=ProprietagraveM>Proprietà MaxScanRows</A>
</b>
</p>
<p>è da indicare solamente se il tipo tabella ha valore <u>Jet ISAM</u> e deve essere sempre indicato il valore 0.</p>
<p>
<b>
<A name=ProprietagraveC>Proprietà CharacterSet</A>
</b>
</p>
<p>è da indicare solamente se il tipo tabella ha valore <u>Jet ISAM</u> e può assumere i valori 'OEM' (impostazione predefinita) se il set di caratteri è quello Windows, 'ANSI' se il set di caratteri è quello DOS.</p>
<p>
<b>
<A name=ProprietagraveN>Proprietà NumberLeadingZeros</A>
</b>
</p>
<p>è da indicare solamente se il tipo tabella ha valore <u>Jet ISAM</u> e deve essere sempre indicato il valore 1.</p>
<p>
<b>
<A name=ProprietagraveD>Formato Data/Ora</A>
</b>
</p>
<p>Rappresenta una stringa che indica il formato della data/ora da importare o esportare, per esempio per interpretare la stringa '15101998153058' (15 Ottobre 1998 ore 15:05:58) sarà necessario indicare la seguente stringa: 'ddMMyyyyhhnnss'. <b>NB:</b> in un profilo che usa il motore NET la stringa di formattazione è case sensitive, per esempio il formato yyyymmdd (mese in minuscolo) non è corretto, ma deve essere yyyyMMdd.</p>
<p>
<b>
<A name=NoteEsempio>Note/esempio file</A>
</b>
</p>
<p>In questo campo è possibile memorizzare se necessario delle note oppure un esempio del file che dovrà essere importato/esportato.</p>
<p>
<u>
<i>
<b>Elenco campi:</b>
</i>
</u>
</p>
<p>
<IMG src="../images/help_bsiesctb1.gif">
</p>
<p>
<b>
<A name=Ordinamento>Ordinamento</A>
</b>
</p>
<p>Indica un numero che rappresenta la sequenza del campo, può assumere i valori da 1 a 256 ed è obbligatorio.</p>
<p>
<b>
<A name=Nomecampo>Nome campo</A>
</b>
</p>
<p>Indicare il nome del campo di massimo 30 caratteri (obbligatorio). Se l'importazione avviene da file di Microsoft Excel nell'elenco campi si definiranno nell'ordine i nomi dei campi F1, F2, F3, F4, ... corrispondenti alle colonne dell'area da importare. Non è necessario tipizzare i campi in base al contenuto dei dati in ogni singola colonna. Per ulteriori impostazioni nell'import da file di Microsoft Excel vedere <A href="amimpexp05.htm">Configurazioni per importare da Excel</A>.</p>
<p>
<b>
<A name=Tipocampo>Tipo campo</A>
</b>
</p>
<p>Indicare una stringa che rappresenta il tipo di campo, può assumere i valori: 'Char' campo testo, 'Short' numerico intero, 'Long' numerico lungo, 'Single' numerico a precisione singola, 'Double' numerico a precisione doppia, 'Datetime' campo data/ora. Qualora il tipo tabella sia <u>Jet o altri Jet ISAM</u> e si sia indicata una stringa di connessione, il tipo campo non è significativo perché viene determinato dal driver di import.</p>
<p>
<b>
<A name=Dimensione>Dimensione</A>
</b>
</p>
<p>Rappresenta la dimensione, in byte, del campo. Questo dato è obbligatorio per le tabelle di tipo <u>Jet ISAM</u> di formato 'FixedLength' e per le tabelle di tipo <u>ASCII Text File</u>. Per tabelle di tipo MSAccess è obbligatorio solo per i campi di tipo CHAR, in tutti gli altri casi impostare 1.</p>
<p>
<b>
<A name=Inchiaveprimari>In chiave primaria</A>
</b>
</p>
<p>Utilizzato da file MSAccess, selezionare se il campo è una chiave primaria.</p>
<p>
<b>
<A name=Richiesto>Richiesto</A>
</b>
</p>
<p>Utilizzato da file MSAccess, selezionare se il campo deve essere obbligatoriamente compilato (solitamente in questi casi si imposta anche un valore di default).</p>
<p>
<b>
<A name=Defaultcampo>Default campo</A>
</b>
</p>
<p>Utilizzato da file MSAccess, impostare, se necessario, il valore che il campo deve assumere per default. Per i campi numerici inserire un numero, per i campi di testo inserire il valore tra doppi apici.</p>
<p>
<b>
<A name=Validazionecamp>Validazione campo</A>
</b>
</p>
<p>Utilizzato da file MSAccess, impostare se necessario i valori che il campo può assumere. Per i campi numerici inserire i possibili valori separati da OR, per i campi di testo inserire ogni singolo valore tra apici semplici e separare i dati con OR.</p>
<p>
<b>
<A name=Contatore>Contatore</A>
</b>
</p>
<p>Utilizzato da file MSAccess, selezionare se il campo è un campo contatore (il campo contatore è un campo che si incrementa in automatico e non deve venir inserito nella corrispondenza campi).</p>
<p>
<b>
<A name=Consentilunghez>Consenti lunghezza 0</A>
</b>
</p>
<p>Utilizzato da file MSAccess, selezionare se il campo può non essere compilato.</p>
<p>
<u>
<i>
<b>Funzioni di toolbar:</b>
</i>
</u>
</p>
<p>
<b>
<A name=FunzionedimenuI>Importa campi</A>
</b>
</p>
<p>Questa funzione è stata realizzata per facilitare l'inserimento dei campi se il file da trattare è un database di tipo MSAccess. Attivando la funzione verrà richiesto il nome del tabase contenente la tabella di cui si desidera importare la struttura, quindi in una successiva maschera si selezionerà la tabella interessata e confermando verrà copiata la struttura della tabella nell'elenco dei campi. <b>NB:</b> utilizzare i file di database modello .MOD per importare i campi nello schema tabelle esterne, non è consigliato utilizzare i database con tabelle allegate in quanto nei campi <u>Contatore</u> e <u>Default campo</u> i valori non vengono rilevati, eventualmente se si importa da tabelle allegate verificare tali campi, soprattutto nel caso si esporti su un .MDB dove in mancanza dei valori di default dei campi chiave questo porta ad un errore del profilo di export.</p>
<p>
<b>Importa da Database SQL esterno</b>
</p>
<p>Serve per pololare l'elenco campi in automatico leggendo la struttura della tabella da SQL Server nel caso in cui il tipo tabelal sia impostato a <u>OleDbConnection</u>.</p>
</TD></TR></TABLE><TABLE border=0 cellSpacing=0 cellPadding=0><TR><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/software-retail-negozi/"><IMG border=0 src="../images/help_home_01_Gestisci.gif"></A></TD><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/controllo-di-gestione/"><IMG border=0 src="../images/help_home_02_Controlla.gif"></A></TD><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/crm/"><IMG border=0 src="../images/help_home_03_Fidelizza.gif"></A></TD><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/analisi-dati-datawarehouse/"><IMG border=0 src="../images/help_home_04_DWH.gif"></A></TD><TD vAlign=center width=169 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/project-management/"><IMG border=0 src="../images/help_home_05_Gestisci.gif"></A></TD><TD vAlign=center width=146 align=right><IMG border=0 src="../images/help_home_NTS_logo_up.gif"></TD></TR><TR><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/logistica/"><IMG border=0 src="../images/help_home_06_Organizza.gif"></A></TD><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/customer-service/"><IMG border=0 src="../images/help_home_07_Gestisci.gif"></A></TD><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/produzione/"><IMG border=0 src="../images/help_home_08_Pianifica.gif"></A></TD><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/archiviazione-documenti/"><IMG border=0 src="../images/help_home_09_Archivia.gif"></A></TD><TD vAlign=center width=169 align=right><IMG border=0 src="../images/help_home_NTS_logo_down1.gif"></TD><TD vAlign=center width=146 align=right><A href="http://www.ntsinformatica.it"><IMG border=0 alt="Clicca per accedere al sito di NTS Informatica" src="../images/help_home_NTS_logo_down2.gif"></A></TD></TR><TR><TD width=987 colSpan=6><IMG border=0 src="../images/help_home_Line.gif"></TD></TR></TABLE></body></html>