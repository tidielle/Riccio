<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3c.org/TR/1999/REC-html401-19991224/loose.dtd">
<html>
<head>
<title> AM: Impostazione del flusso GPV, RTS WPos1 e Regitratore di cassa</title>
<LINK rel=stylesheet type=text/css href="style_topic.css">
<SCRIPT LANGUAGE="JavaScript">
<!-- Begin
loadImage1 = new Image();
loadImage1.src = "../images/help_home_Button_01_Roll-over.gif";
staticImage1 = new Image();
staticImage1.src = "../images/help_home_Button_01_Roll-out.gif";

loadImage2 = new Image();
loadImage2.src = "../images/help_home_Button_02_Roll-over.gif";
staticImage2 = new Image();
staticImage2.src = "../images/help_home_Button_02_Roll-out.gif";

loadImage3 = new Image();
loadImage3.src = "../images/help_home_Button_03_Roll-over.gif";
staticImage3 = new Image();
staticImage3.src = "../images/help_home_Button_03_Roll-out.gif";

loadImage4 = new Image();
loadImage4.src = "../images/help_home_Button_04_Roll-over.gif";
staticImage4 = new Image();
staticImage4.src = "../images/help_home_Button_04_Roll-out.gif";

// End -->
</SCRIPT>

</head>
<body lang=it topMargin=3>
<TABLE width=987 border=0><TR><TD vAlign=top align=right><p><code>Data ultimo aggiornamento: <A name=hINIeDATlAGGp></A>06/08/2014</FONT><A name=hFINeDATlAGGp></A></code></p></TD></TR></TABLE><TABLE cellSpacing=0 border=0><TR><TD colSpan=4><A href="http://www.ntsinformatica.it"><IMG border=0 alt="Clicca per accedere al sito di NTS Informatica" src="../images/help_home_banner.gif"></A></TD></TR></TABLE><TABLE cellSpacing=0 cellPadding=0 border=0><TR><TD align=left><A onmouseover="image1.src=loadImage1.src;" onmouseout="image1.src=staticImage1.src;" href="cose.htm"><IMG border=0 name=image1 alt="Clicca per accedere all'argomento" src="../images/help_home_Button_01_Roll-out.gif"></A></TD><TD align=center><A onmouseover="image2.src=loadImage2.src;" onmouseout="image2.src=staticImage2.src;" href="pc.htm"><IMG border=0 name=image2 alt="Clicca per accedere all'argomento" src="../images/help_home_Button_02_Roll-out.gif"></A></TD><TD align=center><A href="ambsargmod.htm"><IMG border=0 name=image3 alt="Clicca per accedere all'argomento" src="../images/help_home_Button_03_Roll-over.gif"></A></TD><TD align=right><A onmouseover="image4.src=loadImage4.src;" onmouseout="image4.src=staticImage4.src;" href="gaguidaan.htm"><IMG border=0 name=image4 alt="Clicca per accedere all'argomento" src="../images/help_home_Button_04_Roll-out.gif"></A></TD></TR><TR><TD colSpan=4><A href="http://www.ntsinformatica.it"><IMG border=0 alt="Clicca per accedere al sito di NTS Informatica" src="../images/help_home_Button_03_Roll-over-row.gif"></A></TD></TR><TR><TD bgColor=#009ee2 height=53 vAlign=middle width=987 colSpan=4 align=left><p><FONT class=title color=white size=6><b>Impostazione del flusso GPV, RTS WPos1 e Regitratore di cassa</b></FONT></p></TD></TR><TR><TD vAlign=middle colSpan=4 align=left></TD></TR></TABLE><TABLE width=987 border=0><TR><TD>
<p>NTS Informatica supporta i registratori di cassa tramite il programma di collegamento "WPOS1", da acquistare a parte e realizzato dalla RTS Engineering di Bologna (<A href="http://www.rtseng.it/">www.rtseng.it</A>), il quale provvede all'invio dei dati prodotti dal gestionale (file ASCII in formato Sarema Language) al registratore fisicamente collegato al PC tramite la porta seriale.</p>
<p>Poichè esistono tanti programmi WPOS1 quanti sono i modelli di registratori supportati, si consiglia di consultare il sito della RTS alla pagina: <A href="http://www.rtseng.it/SelectWpos1.php">http://www.rtseng.it/SelectWpos1.php</A>
</p>
<p>
<b>Specifiche di funzionamento</b>
</p>
<p>Le opzioni di registro che venivano lette dal Retail VB6 sono state tutte sostituite da campi sul database, modificabili dal programma <b>Registratore di cassa:</b>
</p>
<ul>
<li>Percorso file WPos1
<li>Comando Chiusura di Cassa ( vedi manuale WPos1 di ogni registratore di cassa)
<li>Generazione file Wpos1</li>
</ul>
<p>Sono disponibili 2 modalità per la creazione del file, con i dati dello scontrino in Sarema Language per il registratore di cassa:</p>
<ul>
<li>Modalità diretta
<li>Profilo Import/Export</li>
</ul>
<p>
<b>Configurazione collegamento con il registratore di cassa</b>
</p>
<ol>
<li>Individuare la matricola del registratore di cassa da interfacciare
<li>Scaricare il WPos1 relativo al registratore di cassa da interfacciare
<li>Installare il programma, la cartella di default proposta è C:\programmi\RTS WPos1 (il supporto è fornito direttamente da RTS Engineering)
<li>Creare con il Blocco note (Notepad) un file di nome <i>SR_STARX.001</i> contenente la password fornita da RTS e salvarlo nella cartella di installazione come sopra indicato (ad esempio <i>C:\Programma\RTS Wpos1</i>). Tale file viene poi copiato e rinominato, dal profilo di esportazione in <i>SR_START.001</i>, una sorta di file "semaforo" per far partire il processo di stampa dello scontrino i cui dati Business li inserisce nel file <i>SR_DATI.001</i> (consultare comunque la documentazione fornita con il programma WPOS1 per informazioni più dettagliate).
<br>
<b>Attenzione!</b> Se si crea il file con il Notepad e le cartelle di Windows nascondono le estensioni dei file, controllare che il file non venga salvato con nome SR_STARX.001.TXT, file che ovviamente non verrà riconosciuto.
<li>Verificare se e su quale porta seriale COM viene eseguito il DUMP dal WPos1.
<li>Eseguire il test di comunicazione del WPos1<IMG border=0 src="../images/help_ambsgpv05.gif">
<li>Qualora il registratore di cassa sia collegato su una porta seriale diversa dalla COM1, modificare il nome del file con <i>SR_DATI.002</i> , qualora il reg. di cassa sia collegato sulla COM2, SR_DATI.003 se collegato sulla COM3. lo stesso vale per il file semaforo, SR_START.002 se il registratore di cassa è stato collegato sulla porta COM2, SR_START.003 se collegato sulla COM3.
<li>Configurare il programma <b>Registratore di Cassa</b> (J - 4 - C) del <b>GPV</b>
</li>
</ol>
<p>
<b>NB: </b>In caso di errori in fase di Test WPos1 o di stampa Corrispettivo, verificare la presenza del file SR_ERR.001 ed il relativo contenuto per richiedere assistenza a RTS Engineering.</p>
<p>
<b>Flusso dati tra GPV, WPos1 e Registratore di Cassa</b>
</p>
<p>Quando si salva un Corrispettivo in GPV, con la spunta su "Stampa Scontrino" se il salvataggio del documento va a buon fine, il programma crea un file denominato SR_DATI.001 e duplica il file SR_STARX.001 rinominandolo SR_START.001 (se questo file è bloccato da un'altro pc, il GPV ritenta il lancio dello scontrino per altri 5 secondi, per gestire più pc che condividono lo stesso registratore di cassa). Il WPos1 in attesa della presenza del file SR_START.001, legge il file SR_DATI.001 ed invia le informazioni al registratore di cassa tramite la porta COM. Se il processo va a buon fine viene stampato lo scontrino e cancellati i due file SR_START e SR_DATI, in caso contrario il WPos1 crea il file di errore SR_ERR.001</p>
</TD></TR></TABLE><TABLE border=0 cellSpacing=0 cellPadding=0><TR><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/software-retail-negozi/"><IMG border=0 src="../images/help_home_01_Gestisci.gif"></A></TD><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/controllo-di-gestione/"><IMG border=0 src="../images/help_home_02_Controlla.gif"></A></TD><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/crm/"><IMG border=0 src="../images/help_home_03_Fidelizza.gif"></A></TD><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/analisi-dati-datawarehouse/"><IMG border=0 src="../images/help_home_04_DWH.gif"></A></TD><TD vAlign=center width=169 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/project-management/"><IMG border=0 src="../images/help_home_05_Gestisci.gif"></A></TD><TD vAlign=center width=146 align=right><IMG border=0 src="../images/help_home_NTS_logo_up.gif"></TD></TR><TR><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/logistica/"><IMG border=0 src="../images/help_home_06_Organizza.gif"></A></TD><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/customer-service/"><IMG border=0 src="../images/help_home_07_Gestisci.gif"></A></TD><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/produzione/"><IMG border=0 src="../images/help_home_08_Pianifica.gif"></A></TD><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/archiviazione-documenti/"><IMG border=0 src="../images/help_home_09_Archivia.gif"></A></TD><TD vAlign=center width=169 align=right><IMG border=0 src="../images/help_home_NTS_logo_down1.gif"></TD><TD vAlign=center width=146 align=right><A href="http://www.ntsinformatica.it"><IMG border=0 alt="Clicca per accedere al sito di NTS Informatica" src="../images/help_home_NTS_logo_down2.gif"></A></TD></TR><TR><TD width=987 colSpan=6><IMG border=0 src="../images/help_home_Line.gif"></TD></TR></TABLE></body></html>