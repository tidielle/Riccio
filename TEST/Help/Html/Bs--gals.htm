<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3c.org/TR/1999/REC-html401-19991224/loose.dtd">
<html>
<head>
<title> GA: Gestione Tipi alert</title>
<LINK rel=stylesheet type=text/css href="style_topic.css">
<SCRIPT LANGUAGE="JavaScript">
<!-- Begin
loadImage1 = new Image();
loadImage1.src = "../images/help_home_Button_01_Roll-over.gif";
staticImage1 = new Image();
staticImage1.src = "../images/help_home_Button_01_Roll-out.gif";

loadImage2 = new Image();
loadImage2.src = "../images/help_home_Button_02_Roll-over.gif";
staticImage2 = new Image();
staticImage2.src = "../images/help_home_Button_02_Roll-out.gif";

loadImage3 = new Image();
loadImage3.src = "../images/help_home_Button_03_Roll-over.gif";
staticImage3 = new Image();
staticImage3.src = "../images/help_home_Button_03_Roll-out.gif";

loadImage4 = new Image();
loadImage4.src = "../images/help_home_Button_04_Roll-over.gif";
staticImage4 = new Image();
staticImage4.src = "../images/help_home_Button_04_Roll-out.gif";

// End -->
</SCRIPT>

</head>
<body lang=it topMargin=3>
<TABLE width=987 border=0><TR><TD vAlign=top align=right><p><code>Data ultimo aggiornamento: <A name=hINIeDATlAGGp></A>06/06/2016</FONT><A name=hFINeDATlAGGp></A></code></p></TD></TR></TABLE><TABLE cellSpacing=0 border=0><TR><TD colSpan=4><A href="http://www.ntsinformatica.it"><IMG border=0 alt="Clicca per accedere al sito di NTS Informatica" src="../images/help_home_banner.gif"></A></TD></TR></TABLE><TABLE cellSpacing=0 cellPadding=0 border=0><TR><TD align=left><A onmouseover="image1.src=loadImage1.src;" onmouseout="image1.src=staticImage1.src;" href="cose.htm"><IMG border=0 name=image1 alt="Clicca per accedere all'argomento" src="../images/help_home_Button_01_Roll-out.gif"></A></TD><TD align=center><A onmouseover="image2.src=loadImage2.src;" onmouseout="image2.src=staticImage2.src;" href="pc.htm"><IMG border=0 name=image2 alt="Clicca per accedere all'argomento" src="../images/help_home_Button_02_Roll-out.gif"></A></TD><TD align=center><A onmouseover="image3.src=loadImage3.src;" onmouseout="image3.src=staticImage3.src;" href="ambsargmod.htm"><IMG border=0 name=image3 alt="Clicca per accedere all'argomento" src="../images/help_home_Button_03_Roll-out.gif"></A></TD><TD align=right><A href="gaguidaan.htm"><IMG border=0 name=image4 alt="Clicca per accedere all'argomento" src="../images/help_home_Button_04_Roll-over.gif"></A></TD></TR><TR><TD colSpan=4><A href="http://www.ntsinformatica.it"><IMG border=0 alt="Clicca per accedere al sito di NTS Informatica" src="../images/help_home_Button_04_Roll-over-row.gif"></A></TD></TR><TR><TD bgColor=#009ee2 height=53 vAlign=middle width=987 colSpan=4 align=left><p><FONT class=title color=white size=6><b>Gestione Tipi alert</b></FONT></p></TD></TR><TR><TD vAlign=middle colSpan=4 align=left></TD></TR></TABLE><TABLE width=987 border=0>
<TR>
<TD>
<p>
<b>Nome programma: BS--GALS.DLL</b>
<br>
<b>Moduli richiesti: Vendite/fatturazione, Contab. generale e sempl., Cespiti, CRM, Moduli Supplementari NTS</b>
<br>Report programma: <A href="ampers08.htm#BS--GALS">vai ai report</A>
</p>
<p>Questo è il programma di impostazione dei tipi di alert, che pilota la generazione di alert nel gestionale.</p>
<p>
<IMG src="../images/help_bs--gals_04.jpg">
</p>
<p>
<b>
<A name=IdTipoAlert>Id. Tipo Alert</A>
</b>Identificativo del tipo alert, che deve essere maggiore di 1000 sui nuovi inserimenti. Infatti i tipi alert aventi identiticativo minore o uguale a 1000 sono quelli distribuiti da NTS Informatica, pertanto ne è impedita la modifica, la cancellazione e la creazione di nuovi con codice in tale range.</p>
<p>
<b>
<A name=DescrTipoAlert>Descr. Tipo Alert</A>
</b>La descrizione del tipo alert, obbligatoria, è utilizzata per segnalare cos'è accaduto in Business NET, cioè cosa segnala l'alert che si è generato.</p>
<p>
<b>Attivo </b>Se non spuntato l'alert non sarà eseguito.</p>
<p>
<b>
<A name=Mittente>Mittente</A>
</b>É l'operatore di Business che si vuole far risultare come mittente dell'alert, obbligatorio. Usare la parola chiave predefinita 'CURRENT' se si vuole che sia l'operatore corrente di Business, altrimenti indicarne uno solo.</p>
<p>
<b>
<A name=Destinatari>Destinatari</A>
</b>Sono gli operatori di Business a cui si vuole indirizzare l'alert. Verrà generato un alert per ogni operatore indicato. Usare la parola chiave predefinita 'ALL' per indicare tutti gli operatori registrati in Business.</p>
<p>Per ogni destinatario è possibile dettagliare le tipologie degli alert da generare (Popup, E-Mail, Attività CRM, procedura da eseguire). Gli alert da generare di defaul sono quelli specificati nella maschera principale nella parte 'Specifiche Alert da generare' ad ognuno dei quali corrisponde un numero identificativo (1 per Popup, 2 per E-Mail, ...).</p>
<p>Per specificare alert diversi da generare per un destinatario occorre specificarlo con la seguente sintassi sempre all'interno del campo dove andiamo a definire i destinatari. Per specificare quali alert generare basta porre dopo il nome del destinatario il carattere <b>|</b> seguito dai numeri identificativi degli alert da generare. Ad esempio :</p>
<p>
<IMG src="../images/help_bn__gals1.gif">
</p>
<p>Se non viene specificato alcun alert come ad esempio per il destinatario <i>roberto;</i> vengono presi quelli di default specificati nella maschera principale.</p>
<p>è possibile indicare fra i destinatari dell'alert di tipo E-Mail anche un cliente/fornitore o una risorsa dell'organizzazione del cliente/fornitore avente un determinato ruolo, a tale proposito vedere anche la parte dell'help in linea <A href="amalert05.htm">Alert di tipo e-mail per clienti/fornitori</A>.</p>
<p>
<b>
<A name=TipoLancio>Tipo Lancio</A>
</b>Scegliere "Da programma interattivo" se va valutato durante l'esecuzione di un particolare programma di Business; scegliere invece "Da programma timer" se va valutato durante l'esecuzione del programma "Esecuzione automatica procedure di alerting". Vedi la parte dell'help in linea: <A href="amalert01.htm">Il sistema degli alerting</A> per vedere le varie modalità di lancio di tale programma.</p>
<p>
<b>
<A name=Programma>Programma</A>
</b>Se tipo lancio è "Da programma interattivo", qui va indicato obbligatoriamente il programma di Business durante la cui esecuzione si andrà ad analizzare questo tipo alert.</p>
<p>
<b>
<A name=IdEvento>Id. Evento</A>
</b>Se tipo lancio è "Da programma interattivo", qui va indicato obbligatoriamente l'identificativo dell'evento interno del programma di Business durante la cui esecuzione si analizza questo tipo alert. A parità di programma di Business, utilizzare identificativi evento univoci.</p>
<p>
<b>
<A name=Dataorapartenza>Data/ora partenza schedulazione</A>
</b>Se tipo lancio è "Da programma timer", qui va indicata obbligatoriamente la data/ora di inizio per una valutazione del tipo alert da parte del programma Esecuzione automatica procedure di alerting. Se la data/ora di inizio è "Nel futuro", tale tipo alert sarà ovviamente scartato.</p>
<p>
<b>
<A name=Periodicitagrav>Periodicità schedulazione (ore)</A>
</b>Se tipo lancio è "Da programma timer", qui va indicato obbligatoriamente ogni quante ore dev'essere ripetuta la valutazione di questo tipo alert da parte del programma Esecuzione automatica procedure di alerting. Il valore richiesto deve essere &gt;= 0,01 ore, corrispondente circa ad 1 minuto. Esempio: Per indicare ogni 2 ore e mezza: indicare 2,5.</p>
<p>
<b>
<A name=Dataoraultimaes>Data/ora ultima esecuzione schedulazione</A>
</b>Se tipo lancio è "Da programma timer", qui è automaticamente indicata (campo non editabile) la data/ora di ultima valutazione di tale tipo alert da parte del programma Esecuzione automatica procedure di alerting.</p>
<p>Un tipo alert non sarà mai valutato 2 volte all'interno della periodicità di schedulazione calcolata a partire dalla data/ora di ultima esecuzione di schedulazione.</p>
<p>
<b>
<A name=Perditta>Per ditta</A>
</b>Se spuntato, significa che il tipo alert va valutato solo quando si opera su di una certa ditta. Altrimenti, va valutato per tutte le ditte presenti.</p>
<p>
<b>
<A name=Ditta>Ditta</A>
</b>Se spuntato "per ditta", qui va indicata obbligatoriamente l'unica ditta per la quale va valutato questo tipo di alert.</p>
<p>
<b>
<A name=CodProceduraper>Cod. Procedura per condizionare la generazione dell'alert</A>
</b>Deve rigorosamente essere una funzione (Function) VB-Script con una particolare interfaccia e che ritorni un valore booleano. Sarà eseguita per controllare se quel determinato tipo alert è verificato (valore di ritorno = True), in tale caso Business provvederà a generare gli opportuni alert. Se il tipo alert non è verificato (valore di ritorno = False), non sarà generato alcun alert.</p>
<p>Tale procedura normalmente non sarà indicata, pertanto Business considererà automaticamente soddisfatto il requisito di generazione dell'alert, nel caso in cui il tipo di lancio sia "da programma interattivo", perché in tale caso il test di condizionamento dell'alert sarà direttamente scritto in VB-6 nel programma stesso.</p>
<p>Sarà invece molto probabilmente utile e necessaria per i tipi alert "da programma timer" per i quali non è possibile intervenire direttamente nel codice con VB-6. Le procedure saranno scritte tramite l'apposito programma (condiviso con il modulo Import-Export): 'Definizione Procedure Import-Export e Alerting' (menu di Business 8-6).</p>
<p>Esempio di interfaccia funzione:</p>
<pre><code>Function RigheOrdineScadute(strCodditt, dynMsgOutParam)
  'strCodditt [parametro passato ByVal]
  'è la ditta da esaminare (= " " significa tutte)
  'dynMsgOutParam [parametro passato ByRef]
  'è un recordset disconnesso contenente eventuali parametri aggiuntivi passati
  'alla Function e che deve essere riempito opportunamente con il testo dell'alert
  'e con l'indicazione della ditta sulla quale si è verificato l'alert
  If &lt;condizione soddisfatta&gt; Then
      RigheOrdineScadute = True
  Else
      RigheOrdineScadute = False
  End If
End Function</code></pre>
<p>Struttura del recordset disconnesso dynMsgOutParam:</p>
<pre><code>'qui va indicata la ditta per la quale si è generato l'alert
dynMsgOutParam.Fields.Append "codditt", adVarChar, 12

'qui va indicato il testo dell'alert
.Fields.Append "strMsg", adVarChar, 30000

'solo per alert di tipo Attività CRM
.Fields.Append "strCodLead", adVarChar, 9

'solo per alert di tipo E-Mail
.Fields.Append "strConto", adVarChar, 9
  
'eventuali parametri aggiuntivi in input utili nello script
.Fields.Append "strParam1", adVarChar, 255
.Fields.Append "strParam2", adVarChar, 255
.Fields.Append "strParam3", adVarChar, 255
.Fields.Append "strParam4", adVarChar, 255
.Fields.Append "strParam5", adVarChar, 255
.Fields.Append "strParam6", adVarChar, 255
.Fields.Append "strParam7", adVarChar, 255
.Fields.Append "strParam8", adVarChar, 255
.Fields.Append "strParam9", adVarChar, 255
.Fields.Append "strParam10", adVarChar, 255
.Fields.Append "strParam11", adVarChar, 255
.Fields.Append "strParam12", adVarChar, 255
.Fields.Append "strParam13", adVarChar, 255
.Fields.Append "strParam14", adVarChar, 255
.Fields.Append "strParam15", adVarChar, 255
.Fields.Append "strParam16", adVarChar, 255
.Fields.Append "strParam17", adVarChar, 255
.Fields.Append "strParam18", adVarChar, 255
.Fields.Append "strParam19", adVarChar, 255
.Fields.Append "strParam20", adVarChar, 255</code></pre>
<p>
<b>
<A name=Popup>Popup</A>\Post</b> Se spuntato, genera un alert di tipo Popup. L'alert sarà visualizzato sul PC del destinatario, solo se avrà in quel momento in esecuzione il programma Busserv.exe distribuito con Business, tale informazione sarà reperita dalla tabella degli operatori di Business dove deve essere indicato nel campo 'Nome PC abituale' il PC abituale di lavoro di quell'utente di Business.</p>
<p>NB: il caso MITTENTE=DESTINATARIO se alert di tipo POST non è ammesso, quindi non è possibile mandare un alert di tipo POST a se stessi; in pratica se la persona che crea la situazione da monitorare è la stessa che nè vuole notifica con i POST NON SI POTRA' FARE.</p>
<p>Se è abilitata l'opzione di registro "OPZIONI\SocialAbilitaAlertPost=-1", il programma consente di inviare le alert di tipo popup come Post di business Social. Questo è possibile solo se gli utenti (sia quelli che devono ricevere l'alert sia quello che li invia) sono Social e hanno una relazione tra di loro. In questo modo l'alert sarà visualizzato nelle notizie, per esempio:</p>
<p>
<IMG src="../images/help_bs--gals_02.jpg">
</p>
<p>
<b>
<A name=E-Mail>E-Mail</A>
</b>Se spuntato, genera un alert di tipo E-Mail. Arriverà una E-Mail al destinatario, all'indirizzo prelevato dalla tabella dell'organizzazione azienda, individuando il componente dell'organizzazione che risulta essere agganciato all'operatore indicato appunto quale destinatario.</p>
<p>
<b>
<A name=AttivitaCRM>Attività CRM</A>
</b>Se spuntato, genera automaticamente un alert di tipo Attività CRM. Sarà creata automaticamente un'attività per il CRM, avente un certo Cod. Tipo Attività, un certo Oggetto e con una certa Data di esecuzione. Essa sarà assegnata (operatore incaricato previsto) al componente dell'organizzazione che risulta essere agganciato all'operatore indicato appunto quale destinatario del tipo alert.</p>
<p>Per le attività legate ad utenti CRM, è obbligatorio che sia compilato il codice lead, mentre per gli operatori non CRM il codice lead non è obbligatorio. Per far funzionare correttamente la generazione delle attività negli alert occorre procedere in questo modo:</p>
<ol>
<li>UTENTE NON CRM: l'alert può creare un'attività senza codice lead, che saranno visibili dall'operatore destinatario attraverso l'agenda, se attivo il modulo E-mail Integrata. L'agenda per gli utenti non CRM è stata introdotta all'interno della Consolle E-mail.
<li>UTENTE CRM: l'alert deve creare attività con un codice lead fittizio, che saranno visibili dall'operatore destinatario, attraverso l'agenda all'interno della consolle CRM. Occorre quindi creare per ogni operatore CRM, per cui verranno create delle attività, un codice lead fittizio (ad esempio se stesso). Occorre inoltre aggiungere al dynaset nella funzione per la gerazione degli alert (dal menu 1.O.7 - Tipi Alert) il codice lead a cui verranno associate le attività, tramite l'istruzione dynMsgoutParam("strCodLead") = "codice_lead" dove "codice_lead" sarà il codice del lead fittizio creato.</li>
</ol>
<p>
<b>
<A name=Proceduradaeseg>Procedura da eseguire</A>
</b>Se spuntato, genera automaticamente un alert di tipo Procedura da eseguire; sarà eseguita una certa funzione Vb-Script che farà determinate operazioni.</p>
<p>
<b>
<A name=CodTipoAttivita>Cod. Tipo Attività</A>
</b>Se è stato spuntato il flag per generare un alert di tipo Attività CRM, qui va indicato obbligatoriamente un tipo per l'attività da generare, attività che deve obbligatoriamente essere di tipo previsionale, cioè da eseguire. Per farlo occorre utilizzare l'apposito programma del modulo CRM Tipi Attività/Contatto (menu di Business G-C-4).</p>
<p>
<b>
<A name=Oggetto>Oggetto</A>
</b>Se è stato spuntato il flag per generare un alert di tipo Attività CRM, qui va indicato obbligatoriamente l'oggetto per l'Attività CRM da generare.</p>
<p>
<b>
<A name=Oredaaggiungere>Ore da aggiungere alla data esecuzione per l'attività da generare</A>
</b>Se è stato spuntato il flag per generare un alert di tipo Attività CRM, qui va indicato l'eventuale numero di ore da aggiungere alla data di esecuzione dell'alert per impostare la data/ora prevista per l'Attività CRM da generare.</p>
<p>
<b>
<A name=CodProcedura>Cod. Procedura</A>
</b>Se è stato spuntato il flag per generare un alert di tipo Procedura da eseguire, qui va indicato obbligatoriamente il cod. di una procedura Vb-Script che farà le opportune operazioni del caso. Tale procedura dovrà essere scritta con lo stesso programma e le stesse regole di nomenclatura già sopra indicate per il Cod. Procedura per condizionare la generazione dell'alert.</p>
</TD></TR></TABLE><TABLE border=0 cellSpacing=0 cellPadding=0><TR><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/software-retail-negozi/"><IMG border=0 src="../images/help_home_01_Gestisci.gif"></A></TD><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/controllo-di-gestione/"><IMG border=0 src="../images/help_home_02_Controlla.gif"></A></TD><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/crm/"><IMG border=0 src="../images/help_home_03_Fidelizza.gif"></A></TD><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/analisi-dati-datawarehouse/"><IMG border=0 src="../images/help_home_04_DWH.gif"></A></TD><TD vAlign=center width=169 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/project-management/"><IMG border=0 src="../images/help_home_05_Gestisci.gif"></A></TD><TD vAlign=center width=146 align=right><IMG border=0 src="../images/help_home_NTS_logo_up.gif"></TD></TR><TR><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/logistica/"><IMG border=0 src="../images/help_home_06_Organizza.gif"></A></TD><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/customer-service/"><IMG border=0 src="../images/help_home_07_Gestisci.gif"></A></TD><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/produzione/"><IMG border=0 src="../images/help_home_08_Pianifica.gif"></A></TD><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/archiviazione-documenti/"><IMG border=0 src="../images/help_home_09_Archivia.gif"></A></TD><TD vAlign=center width=169 align=right><IMG border=0 src="../images/help_home_NTS_logo_down1.gif"></TD><TD vAlign=center width=146 align=right><A href="http://www.ntsinformatica.it"><IMG border=0 alt="Clicca per accedere al sito di NTS Informatica" src="../images/help_home_NTS_logo_down2.gif"></A></TD></TR><TR><TD width=987 colSpan=6><IMG border=0 src="../images/help_home_Line.gif"></TD></TR></TABLE></body></html>