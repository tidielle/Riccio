<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3c.org/TR/1999/REC-html401-19991224/loose.dtd">
<html>
<head>
<title> AM: Integrazione del datawarehouse con fonti dati esterni (SQL Server)</title>
<LINK rel=stylesheet type=text/css href="style_topic.css">
<SCRIPT LANGUAGE="JavaScript">
<!-- Begin
loadImage1 = new Image();
loadImage1.src = "../images/help_home_Button_01_Roll-over.gif";
staticImage1 = new Image();
staticImage1.src = "../images/help_home_Button_01_Roll-out.gif";

loadImage2 = new Image();
loadImage2.src = "../images/help_home_Button_02_Roll-over.gif";
staticImage2 = new Image();
staticImage2.src = "../images/help_home_Button_02_Roll-out.gif";

loadImage3 = new Image();
loadImage3.src = "../images/help_home_Button_03_Roll-over.gif";
staticImage3 = new Image();
staticImage3.src = "../images/help_home_Button_03_Roll-out.gif";

loadImage4 = new Image();
loadImage4.src = "../images/help_home_Button_04_Roll-over.gif";
staticImage4 = new Image();
staticImage4.src = "../images/help_home_Button_04_Roll-out.gif";

// End -->
</SCRIPT>

</head>
<body lang=it topMargin=3>
<TABLE border=0 width=987><TR><TD vAlign=top align=right><p><FONT size=2><CODE>Data ultimo aggiornamento: <A name=hINIeDATlAGGp></A>09/11/2012</FONT><A name=hFINeDATlAGGp></A></CODE></p></TD></TR></TABLE><TABLE border=0 cellSpacing=0><TR><TD colSpan=4><A href="http://www.ntsinformatica.it"><IMG border=0 alt="Clicca per accedere al sito di NTS Informatica" src="../images/help_home_banner.gif"></A></TD></TR></TABLE><TABLE border=0 cellSpacing=0 cellPadding=0><TR><TD align=left><A onmouseover="image1.src=loadImage1.src;" onmouseout="image1.src=staticImage1.src;" href="cose.htm"><IMG border=0 name=image1 alt="Clicca per accedere all'argomento" src="../images/help_home_Button_01_Roll-out.gif"></A></TD><TD align=middle><A onmouseover="image2.src=loadImage2.src;" onmouseout="image2.src=staticImage2.src;" href="pc.htm"><IMG border=0 name=image2 alt="Clicca per accedere all'argomento" src="../images/help_home_Button_02_Roll-out.gif"></A></TD><TD align=middle><A href="ambsargmod.htm"><IMG border=0 name=image3 alt="Clicca per accedere all'argomento" src="../images/help_home_Button_03_Roll-over.gif"></A></TD><TD align=right><A onmouseover="image4.src=loadImage4.src;" onmouseout="image4.src=staticImage4.src;" href="gaguidaan.htm"><IMG border=0 name=image4 alt="Clicca per accedere all'argomento" src="../images/help_home_Button_04_Roll-out.gif"></A></TD></TR><TR><TD colSpan=4><A href="http://www.ntsinformatica.it"><IMG border=0 alt="Clicca per accedere al sito di NTS Informatica" src="../images/help_home_Button_03_Roll-over-row.gif"></A></TD></TR><TR><TD bgColor=#009ee2 height=53 vAlign=center width=987 colSpan=4 align=left><p><FONT class=title color=white size=6><b>Integrazione del datawarehouse con fonti dati esterni (SQL Server)</b></FONT></p></TD></TR><TR><TD vAlign=center colSpan=4 align=left></TD></TR></TABLE><TABLE border=0 width=987><TR><TD><p>In questa parte trattaremo l'integrazione dei dati del datawarehouse con altre fonti dati esterni, presenti su supporti di tipo Excel, Access o SQL Server. Come primo esempio tratteremo un'integrazione con dati di tipo SQL Server, ma per semplicità importeremo i dati di una tabella del database di Business in uso, ma che serve comunque per capire come procedere per importare i dati da questo tipo di fonte dati in un qualsiasi caso (per importare tabelle da altri database da una qualsiasi istanza SQL Server siano essi di Business oppure no, basterà intevenire a livello di stringa di connessione, al momento della definizione dati esterni).</p><p>Per replicare l'esempio basta utilizzare il database di PROVA fornito attivando il modulo della contabilità analitica (non si tratta di quello della duplice contabilile, ma di quello standard), eventualmente se non si disponesse del modulo in questione è possibile replicare gli esempi successivi di Excel e Access, in formato SQL Server. Si è scelto di lavorare sullo scenario 7 della contabilità analitica perchè riveste un valido caso di applicazione, inoltre, oltre alla tematica di integrazione dati, affronta anche l'inserimento di nuove dimensioni di tipo dato e la possibilità di integrare i dati dei budget nello scenario dell'analitica.</p><p>Come prima cosa imputiamo alcuni dati direttamente da prima nota di contabilità analitica come da schermata sotto, naturalmente per realizzare tali scritture occorre preventivamente creare gli appositi budget.</p><p><IMG border=0 src="../images/help_ambsdwh07_01.gif"></p><p>Una volta inseriti i dati sopra lanciamo l'estazione dei dati del solo scenario 7, in modo da riportarli nella tabella dwarehe e per poteri poi analizzare.</p><p><IMG border=0 src="../images/help_ambsdwh07_02.gif"></p><p>A questo punto creiamo una statistica datawarehouse di prova che fa uso di tali dati (schermata sotto).</p><p><IMG border=0 src="../images/help_ambsdwh07_03.gif"></p><p>E verifichiamo tramite i dati pivot l'avvenuta estrazione dei dati e salviamo lo scenario.</p><p><IMG border=0 src="../images/help_ambsdwh07_04.gif"></p><p>A questo punto entriamo nel budget della commessa 1 per il conto 1010002, precedentemente creato altrimenti non avremmo potuto creare le registrazioni in prima nota di analitica, e inseriamo il dettaglio budget mensile sempre come da schermata sotto.</p><p><IMG src="../images/help_ambsdwh07_13.jpg" width=987></p><p>Una volta inserito i dati nel dettaglio, rimanendo posizionati sulla griglia, se utilizziamo la funzione di visualizza datatable possiamo ottenere il nome della tabella del dettaglio budget mensile (BUDGETMEN) e i relativi nomi delle colonne (NB: a volte il nome della tabella e/o delle colonne mostrate in questa schermata sono diversi da quelle del database, si consiglia quindi in caso di incertezza di fare riferimento alla struttura del database).</p><p><IMG src="../images/help_ambsdwh07_14.jpg" width=987></p><p>A questo punto visto che vogliamo integrare i dati del valore budget e della quantià budget, poichè nello scenario 7 non abbiamo dimensioni di tipo dato (gruppo=5) disponibili ad ospitare tali informazioni, dobbiamo creare queste due nuove dimensioni, tramite il programma di gestione scenari, ad esempio con progressivo campo 20700 e 20701 (maggiore di 20000). Visto che in questo caso dobbiamo obbligatoriamente usare un campo di dwarehe (questo perchè quando si importano dati esterni questi finiscono sempre in dwarehe) possiamo riciclare uno dei campi presenti su tale tabella non usati dallo scenario 7 dell'analitica di tipo numerico, tra i tanti a disposizione scegliamo ad esempio i campi dwarehe.dw_valbudg e dwarehe.dw_qtabudg (utilizzati nello scenario 1 ma non nel 7 quindi disponibili).</p><p><IMG border=0 src="../images/help_ambsdwh07_07.gif"></p><p>Naturalmente il passaggio sopra può essere saltato se, sullo scenario, abbiamo già delle dimensioni di tipo dato adatte ad ospitare i dati estreni da importare.</p><p>Definiamo ora l'impostazione dei dati esterni di tipo SQL Server, in questo caso i campi obbligatori sono, oltre ad assegnare un progressivo import e selezionare come tipo estensione SQL Server, il nome della tabella (nel nostro caso BUDGETMEN) una descrizione a piacere e la stringa di connessione all'istanza\database di SQL Server (nel nostro caso possiamo copiare la stringa di connessione presente in gestione aziende/database dell'azienda in uso).</p><p><IMG src="../images/help_ambsdwh07_05.jpg"></p><p>Definito il record sopra, tramite il menu strumenti passiamo a compilare il dettaglio dell'import dei dati esterni, dovre praticamente si va a fare una corrispondenza fra i campi di BUDGETMEN e di DWAREHE, un pò come nell'import/export. Qui per ogni progressivo campo che desideriamo compilare possiamo far corrispondere una colonna della tabella che vogliamo importare marcando la colonna di griglia <U>tipo cella = colonna</U>, oppure un valore fisso <U>tipo cella = costante</U> (altri valori come cella fissa, colonna multipla, ... verrano trattati negli esempi successivi).</p><p><IMG border=0 src="../images/help_ambsdwh07_09.gif"></p><p>I campi che vanno obbligatoriamente impostati sono, oltre ovviamente al codice ditta e scenario (chiavi di DWAREHE), quelli presenti nelle tabelle in INNER JOIN nella query SQL dello scenario (nel nostro esempio non c'e' ne sono, ma ad esempio visualizzando la query SQL dello scenario del magazzino troviamo), mentre è consigliato inserire come dimensione di periodo i dati relativi al giorno, mese e anno oppure (altrenativamente) alla data (questo soprattutto perchè tali campi sono usati anche dal programma di estrazione dati). Naturalmente se non vengono compilati tutti i campi che partecipano alle INNER JOIN delle tabelle, l'elaborazione di import dati esterni non darà errore e i record verranno comunque creati in DWAREHE, ma poi questi non verranno visualizzati nell'analisi statistica poichè scartati dalla query SQL dello scenario.</p><p><IMG border=0 src="../images/help_ambsdwh07_12.gif"></p><p>Finito di definire la relazione dati SQL Server sopra, possiamo rielaborare lo scenario 7 tramite il programma di estrazione dati datawarehouse, il quale oltre a trattare i dati standard di Business della contabilità analitica, troverà anche la nuova impostazione dati esterni e procederà anche all'aggiunta di ulteriori record in DWAREHE secondo le regole ivi definite. Dopo l'elaborazione, se rientraimo nella statistica precedentemente creata, troveremo i due nuovi campi dato aggiunti valore e quantità budget.</p><p><IMG border=0 src="../images/help_ambsdwh07_10.gif"></p><p>Una volta selezionati, se passiamo alla visualizzazione dati pivot, ci ritroveremo i dati di BUDGETMEN che tramite la definizione di import dati esterni SQL Server, sono stati importati in fase di estrazione dati in DWAREHE.</p><p><IMG border=0 src="../images/help_ambsdwh07_11.gif"></p></TD></TR></TABLE><TABLE border=0 cellSpacing=0 cellPadding=0><TR><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/software-retail-negozi/"><IMG border=0 src="../images/help_home_01_Gestisci.gif"></A></TD><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/controllo-di-gestione/"><IMG border=0 src="../images/help_home_02_Controlla.gif"></A></TD><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/crm/"><IMG border=0 src="../images/help_home_03_Fidelizza.gif"></A></TD><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/analisi-dati-datawarehouse/"><IMG border=0 src="../images/help_home_04_DWH.gif"></A></TD><TD vAlign=center width=169 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/project-management/"><IMG border=0 src="../images/help_home_05_Gestisci.gif"></A></TD><TD vAlign=center width=146 align=right><IMG border=0 src="../images/help_home_NTS_logo_up.gif"></TD></TR><TR><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/logistica/"><IMG border=0 src="../images/help_home_06_Organizza.gif"></A></TD><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/customer-service/"><IMG border=0 src="../images/help_home_07_Gestisci.gif"></A></TD><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/produzione/"><IMG border=0 src="../images/help_home_08_Pianifica.gif"></A></TD><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/archiviazione-documenti/"><IMG border=0 src="../images/help_home_09_Archivia.gif"></A></TD><TD vAlign=center width=169 align=right><IMG border=0 src="../images/help_home_NTS_logo_down1.gif"></TD><TD vAlign=center width=146 align=right><A href="http://www.ntsinformatica.it"><IMG border=0 alt="Clicca per accedere al sito di NTS Informatica" src="../images/help_home_NTS_logo_down2.gif"></A></TD></TR><TR><TD width=987 colSpan=6><IMG border=0 src="../images/help_home_Line.gif"></TD></TR></TABLE></body></html>