<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3c.org/TR/1999/REC-html401-19991224/loose.dtd">
<html>
<head>
<title> AM: Schedulazione di elaborazioni batch</title>
<LINK rel=stylesheet type=text/css href="style_topic.css">
<SCRIPT LANGUAGE="JavaScript">
<!-- Begin
loadImage1 = new Image();
loadImage1.src = "../images/help_home_Button_01_Roll-over.gif";
staticImage1 = new Image();
staticImage1.src = "../images/help_home_Button_01_Roll-out.gif";

loadImage2 = new Image();
loadImage2.src = "../images/help_home_Button_02_Roll-over.gif";
staticImage2 = new Image();
staticImage2.src = "../images/help_home_Button_02_Roll-out.gif";

loadImage3 = new Image();
loadImage3.src = "../images/help_home_Button_03_Roll-over.gif";
staticImage3 = new Image();
staticImage3.src = "../images/help_home_Button_03_Roll-out.gif";

loadImage4 = new Image();
loadImage4.src = "../images/help_home_Button_04_Roll-over.gif";
staticImage4 = new Image();
staticImage4.src = "../images/help_home_Button_04_Roll-out.gif";

// End -->
</SCRIPT>

</head>
<body lang=it topMargin=3>
<TABLE width=987 border=0><TR><TD vAlign=top align=right><p><code>Data ultimo aggiornamento: <A name=hINIeDATlAGGp></A>22/01/2016</FONT><A name=hFINeDATlAGGp></A></code></p></TD></TR></TABLE><TABLE cellSpacing=0 border=0><TR><TD colSpan=4><A href="http://www.ntsinformatica.it"><IMG border=0 alt="Clicca per accedere al sito di NTS Informatica" src="../images/help_home_banner.gif"></A></TD></TR></TABLE><TABLE cellSpacing=0 cellPadding=0 border=0><TR><TD align=left><A onmouseover="image1.src=loadImage1.src;" onmouseout="image1.src=staticImage1.src;" href="cose.htm"><IMG border=0 name=image1 alt="Clicca per accedere all'argomento" src="../images/help_home_Button_01_Roll-out.gif"></A></TD><TD align=center><A onmouseover="image2.src=loadImage2.src;" onmouseout="image2.src=staticImage2.src;" href="pc.htm"><IMG border=0 name=image2 alt="Clicca per accedere all'argomento" src="../images/help_home_Button_02_Roll-out.gif"></A></TD><TD align=center><A href="ambsargmod.htm"><IMG border=0 name=image3 alt="Clicca per accedere all'argomento" src="../images/help_home_Button_03_Roll-over.gif"></A></TD><TD align=right><A onmouseover="image4.src=loadImage4.src;" onmouseout="image4.src=staticImage4.src;" href="gaguidaan.htm"><IMG border=0 name=image4 alt="Clicca per accedere all'argomento" src="../images/help_home_Button_04_Roll-out.gif"></A></TD></TR><TR><TD colSpan=4><A href="http://www.ntsinformatica.it"><IMG border=0 alt="Clicca per accedere al sito di NTS Informatica" src="../images/help_home_Button_03_Roll-over-row.gif"></A></TD></TR><TR><TD bgColor=#009ee2 height=53 vAlign=middle width=987 colSpan=4 align=left><p><FONT class=title color=white size=6><b>Schedulazione di elaborazioni batch</b></FONT></p></TD></TR><TR><TD vAlign=middle colSpan=4 align=left></TD></TR></TABLE><TABLE width=987 border=0>
<TR>
<TD>
<p>Per far operare Business NET in modalità batch basta impostare il parametro /B <b>
<u>(modalità batch)</u>
</b> come parametro di avvio di busnet.exe, gli eventuali child\programmi avviati non visualizzeranno MAI dei messaggi a video, non chiederanno conferme nell'esecuzione di determinate operazioni e scriveranno in un file di log le operazioni che in precedenza venivano chieste a video. I programmi che possono operare in modalità batch\schedulabile sono:</p>
<p>1) BN__ETIM - ESECUZIONE AUTOMATICA PROCEDURE DI ALER 
<br>2) BNDWGEND - ESTRAZIONE DATI PER DATAWAREHOUSE 
<br>3) BNDWQVDA - ANALISI DATI DATAWAREHOUSE 
<br>4) BNEMGMAI - ESECUZIONE AUTOMATICA RICEZIONE E-MAIL 
<br>5) BNIEIMPO - STRUMENTO DI IMPORT/EXPORT 
<br>6) BNMGRCAP - RICOSTRUZIONE PROGRESSIVI DI MAGAZZINO 
<br>7) BNNPIENP - IMPORT / EXPORT VS NETPRO CLASSIC 
<br>8) BNPAPNPA - CONTABILIZZAZIONE PARCELLE 
<br>9) BNPKRICM - STAMPE DA PICKING 
<br>10) BNPKSTET - STAMPE DA PICKING 
<br>11) BNREPNCO - CONTABILIZZAZIONE CORRISPETTIVI 
<br>12) BNRGSYNC - SINCRONIZZAZIONE NEGOZI E SERVER CENTRALE 
<br>13) BNRGSYSE - SINCRONIZZAZIONE SERVER CENTRALE E NEGOZI 
<br>14) BNTFESEC - ESTRAZIONE SCADENZE EXTRACONTABILI 
<br>15) BNVEPNFA - CONTABILIZZAZIONE DOCUMENTI DI MAGAZZINO</p>
<p>In pratica all'avvio della procedura viene creato in file nella directory di lavoro avente con nome BusNetBatch_<i>nomeprocesso</i>.log e tutti i messaggi di errore, invece di essere visualizzati all'utente, verranno salvati in questo file di log. Sempre in questo file viene memorizzata data e ora di quando è stato avviato Business NET e quali form sono state avviate durante la sessione di lavoro. Alla chiusura del programma da far eseguire verrà chiuso in automatico anche Business NET.</p>
<p>Nel caso che il programma da avviare chieda informazioni all'utente tramite messaggi (ad esempio 'Procedere con l'elaborazione?', oppure 'Visualizzare il file di log') questi messaggi verranno salvati sempre nel file .log predetto e la procedura procederà come se si fosse scelto il valore predefinito per il messaggio.</p>
<p>Per poter attivare la procedura sopra descritta all'avvio di Business NET occorre specificare la riga di comando come segue:</p>
<p>
<b>Busnet.exe operatore password_operatore database profilo_di_business child_da_eseguire /B parametri_di_avvio ditta_da_utilizzare</b>
</p>
<p>Ad esempio, per avviare in modalità batch il programma 'esecuzione automatica alerting':</p>
<p>Busnet.exe Mirto . PROVA14 Business BN__ETIM /B c:\programmi\bus\asc\bn__etim.bub prova</p>
<p>ovvero verrà avviato business utilizzando l'operatore 'Mirto' senza password, sul database PROVA14, ditta PROVA; il programma da avviare è BN__ETIM ed i parametri di avvio sono contenuti nel file c:\programmi\bus\asc\bn__etim.bub</p>
<p>
<b>NB:</b> Rispetto ai consueti parametri della riga di comando di Business è stato aggiunto il parametro /B che sostituisce il /R (o uno, o l'altro) ed in coda è stato aggiunto il codice ditta da utilizzare per l'elaborazione. <u>
<b>Business NET se avviato con il parametro /B (modalità batch) non consuma più una licenza e non verifica se sono state già tutte utilizzate</b>
</u>.</p>
<p>Per realizzare il file .BUB, basta premere CTRL+ALT+F5 sulla form dopo aver impostato la maschera con le impostazioni da utilizzare per l'elaborazione. Il file verrà creato sempre in Asc. A volte la combinazione tasti CTRL+ALT+F5 non genera il file BUB, spesso perchè la combinazione viene intercettata da programmi terzi. nel caso non funzionasse in tutti i programmi schedulabili sopracitati nel menu strumenti è disponibile la voce 'Crea file per la schedulazione' che fa la stessa cosa.</p>
<p>
<IMG src="../images/help_am3tier_01.jpg">
</p>
<p>
<b>
<i>
<u>Esempio di schedulazione batch di un programma NET (estrazione dati datawarehouse)</u>
</i>
</b>
</p>
<p>Come prima cosa occorre accedere al programma da schedulare, nel nostro caso l'estrazione dati datawarehouse, manualmente si settano i controlli in maschera come desiderato e tramite il Ctrl+Alt+F5 si genera il file BUB nella Asc che ci servirà per la schedulazione.</p>
<p>
<IMG border=0 src="../images/help_am3tiernet_01.gif">
</p>
<p>Il file BUB verrà creato nella directory Asc e avrà come nome semplicemente il nome del programma da schedulare, nel nostro caso BNDWGEND.</p>
<p>
<IMG border=0 src="../images/help_am3tiernet_02.gif">
</p>
<p>A questo punto possiamo provare subito se l'esecuzione batch va a buon fine, lanciando l'apposita stringa di comando da Esegui di Windows digitando:</p>
<p>C:\Program Files\Bus\Busnet.exe admin . PROVA Business BNDWGEND /B C:\Bus\Asc\BNDWGEND.BUB PROVA</p>
<p>
<IMG border=0 src="../images/help_am3tiernet_03.gif">
</p>
<p>Ovviamente a video non vediamo niente in quanto il processo parte in modalità batch, per vedere l'effettivo funzionamento possiamo verificarlo da task manager, nell'iimagine sotto possiamo vedere che al lancio della stringa precedente è partito un Busnet.exe con PID (proces ID) 2488.</p>
<p>
<IMG border=0 src="../images/help_am3tiernet_15.gif">
</p>
<p>Una volta terminato il processo batch, andando nella directory di Business troviamo 2 log e consultandoli possiamo verificare l'avvenuto completamento dell'operazione e eventuali errori.</p>
<p>
<IMG border=0 src="../images/help_am3tiernet_04.gif">
</p>
<p>Nel file di log BusNetBatch_PID.log (nell'esempio BusNetBatch_2488.log) troveremo informazioni\errori relative all'avvio del programma batch.</p>
<p>
<IMG src="../images/help_am3tier_02.jpg" width=987>
</p>
<p>Nel file di log PROGRAMMA_OPERATORE.log (nell'esempio BNDWGEND_admin.log) troviamo eventuali messaggi\errori relativi all'esecuzione del programma batch.</p>
<p>
<IMG border=0 src="../images/help_am3tiernet_17.gif">
</p>
<p>Ora dopo aver verificato il corretto funzionamento possiamo passare alla schedulazione del processo tramite ad esempio le operazioni pianificate\unità di pianificazione di Windows. Nell'esempio mostriamo come crare tale schedulazione sull'unità di pianificazione di Windows 7, ma per gli altri casi risulta comunque simile.</p>
<p>
<IMG border=0 src="../images/help_am3tiernet_05.gif">
</p>
<p>Una volta aperta l'unità di pianificazione procedere alla creazione di una nuova attività di base, ed inserire un nome e descrizione a piacere e procedere con il tasto avanti.</p>
<p>
<IMG border=0 src="../images/help_am3tiernet_06.gif">
</p>
<p>Specificare la schedulazione dell'attività, nell'esempio si è scelto di schedulare l'estrazione dati del datawarehouse ogni giorno.</p>
<p>
<IMG border=0 src="../images/help_am3tiernet_07.gif">
</p>
<p>Alle ore 22.00 (si sarebbe potuto optare ad esempio anche per una programmazione settimanale scegliendo i soli giorni lavorativi sempre alle ore 22.00).</p>
<p>
<IMG border=0 src="../images/help_am3tiernet_08.gif">
</p>
<p>Ora specificare come tipo azione l'avvio programma e passare alla scelta successiva.</p>
<p>
<IMG border=0 src="../images/help_am3tiernet_09.gif">
</p>
<p>Selezionare tramite sfoglia l'eseguibile Busnet.exe ed imputare negli argomenti quelli della stringa di comando precedentemente lanciata con esegui!</p>
<p>
<IMG border=0 src="../images/help_am3tiernet_10.gif">
</p>
<p>Precedere alla finestra successiva di riepilogo e spuntare se necessario il flag di aprire la finestra di dialogo Propietà quando viene scelto Fine per entrare in una configurazione più avanzata dell'attività. Premere fine.</p>
<p>
<IMG border=0 src="../images/help_am3tiernet_11.gif">
</p>
<p>Se si è attivato il flag precedente si consiglia di impostare sotto le opzioni di sicurezza di eseguire il processo indipendentemente dalla connessione degli utenti, con i privilegi più elevati. Inoltre è consigliabile impostare il cambio utente con uno di tipo amministratore.</p>
<p>
<IMG border=0 src="../images/help_am3tiernet_12.gif">
</p>
<p>Passando al tab azioni è possibile verificare o intervenire sull'azione creata.</p>
<p>
<IMG border=0 src="../images/help_am3tiernet_13.gif">
</p>
<p>Nel tab impostazioni invece è consigliabile intervenire sul flag di <u>interrompi se eseguita per oltre</u> in base alla schedulazione precedentemente impostata.</p>
<p>
<IMG border=0 src="../images/help_am3tiernet_14.gif">
</p>
<p>A questo punto premere ok e indicare l'utente e password di Windows con il quale verrà lanciata l'azione (si ricorda ancora di utilizzare un utente di tipo amministratore).</p>
<p>
<IMG border=0 src="../images/help_am3tiernet_18.gif">
</p>
<p>Ora troveremo l'attività con l'azione creata all'interno dell'unità di pianificazione.</p>
<p>
<IMG src="../images/help_am3tier_03.jpg" width=987>
</p>
<p>Immaginiamo ora di volere invece schedulare 2 avvi diversi per l'estrazioni dati del datawarehouse una sullo scenario 1 e una sullo scenario 7. Occore innanzitutto creare il file BUB per lo scenario 1 e rinominarlo ad esempio da BNDWGEND.BUB in BNDWGEND_SCEN1.BUB, poi occorre creare il file BUB per lo scenario 7 e rinominarlo ad esempio da BNDWGEND.BUB in BNDWGEND_SCEN7.BUB; le rinomine servono altrimenti il secondo file BUB sostituirebbe il primo.</p>
<p>
<IMG src="../images/help_am3tier_04.jpg" width=987>
</p>
<p>Una volta creati i due file BUB</p>
<p>
<IMG border=0 src="../images/help_am3tiernet_21.gif">
<IMG border=0 src="../images/help_am3tiernet_22.gif">
</p>
<p>si può passare come prima alla creazione dell'attività questa volta con due azioni (oppure si possono creare due attività ciascuna con un azione), l'importante è specificare bene per ogni azione il nome del file BUB rinominato.</p>
<p>
<IMG src="../images/help_am3tier_05.jpg" width=987>
</p>
</TD></TR></TABLE><TABLE border=0 cellSpacing=0 cellPadding=0><TR><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/software-retail-negozi/"><IMG border=0 src="../images/help_home_01_Gestisci.gif"></A></TD><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/controllo-di-gestione/"><IMG border=0 src="../images/help_home_02_Controlla.gif"></A></TD><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/crm/"><IMG border=0 src="../images/help_home_03_Fidelizza.gif"></A></TD><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/analisi-dati-datawarehouse/"><IMG border=0 src="../images/help_home_04_DWH.gif"></A></TD><TD vAlign=center width=169 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/project-management/"><IMG border=0 src="../images/help_home_05_Gestisci.gif"></A></TD><TD vAlign=center width=146 align=right><IMG border=0 src="../images/help_home_NTS_logo_up.gif"></TD></TR><TR><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/logistica/"><IMG border=0 src="../images/help_home_06_Organizza.gif"></A></TD><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/customer-service/"><IMG border=0 src="../images/help_home_07_Gestisci.gif"></A></TD><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/produzione/"><IMG border=0 src="../images/help_home_08_Pianifica.gif"></A></TD><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/archiviazione-documenti/"><IMG border=0 src="../images/help_home_09_Archivia.gif"></A></TD><TD vAlign=center width=169 align=right><IMG border=0 src="../images/help_home_NTS_logo_down1.gif"></TD><TD vAlign=center width=146 align=right><A href="http://www.ntsinformatica.it"><IMG border=0 alt="Clicca per accedere al sito di NTS Informatica" src="../images/help_home_NTS_logo_down2.gif"></A></TD></TR><TR><TD width=987 colSpan=6><IMG border=0 src="../images/help_home_Line.gif"></TD></TR></TABLE></body></html>