<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3c.org/TR/1999/REC-html401-19991224/loose.dtd">
<html>
<head>
<title> GA: Impostazione Import/Export</title>
<LINK rel=stylesheet type=text/css href="style_topic.css">
<SCRIPT LANGUAGE="JavaScript">
<!-- Begin
loadImage1 = new Image();
loadImage1.src = "../images/help_home_Button_01_Roll-over.gif";
staticImage1 = new Image();
staticImage1.src = "../images/help_home_Button_01_Roll-out.gif";

loadImage2 = new Image();
loadImage2.src = "../images/help_home_Button_02_Roll-over.gif";
staticImage2 = new Image();
staticImage2.src = "../images/help_home_Button_02_Roll-out.gif";

loadImage3 = new Image();
loadImage3.src = "../images/help_home_Button_03_Roll-over.gif";
staticImage3 = new Image();
staticImage3.src = "../images/help_home_Button_03_Roll-out.gif";

loadImage4 = new Image();
loadImage4.src = "../images/help_home_Button_04_Roll-over.gif";
staticImage4 = new Image();
staticImage4.src = "../images/help_home_Button_04_Roll-out.gif";

// End -->
</SCRIPT>

</head>
<body lang=it topMargin=3>
<TABLE border=0 width=987><TR><TD vAlign=top align=right><p><FONT size=2><CODE>Data ultimo aggiornamento: <A name=hINIeDATlAGGp></A>07/11/2012</FONT><A name=hFINeDATlAGGp></A></CODE></p></TD></TR></TABLE><TABLE border=0 cellSpacing=0><TR><TD colSpan=4><A href="http://www.ntsinformatica.it"><IMG border=0 alt="Clicca per accedere al sito di NTS Informatica" src="../images/help_home_banner.gif"></A></TD></TR></TABLE><TABLE border=0 cellSpacing=0 cellPadding=0><TR><TD align=left><A onmouseover="image1.src=loadImage1.src;" onmouseout="image1.src=staticImage1.src;" href="cose.htm"><IMG border=0 name=image1 alt="Clicca per accedere all'argomento" src="../images/help_home_Button_01_Roll-out.gif"></A></TD><TD align=middle><A onmouseover="image2.src=loadImage2.src;" onmouseout="image2.src=staticImage2.src;" href="pc.htm"><IMG border=0 name=image2 alt="Clicca per accedere all'argomento" src="../images/help_home_Button_02_Roll-out.gif"></A></TD><TD align=middle><A onmouseover="image3.src=loadImage3.src;" onmouseout="image3.src=staticImage3.src;" href="ambsargmod.htm"><IMG border=0 name=image3 alt="Clicca per accedere all'argomento" src="../images/help_home_Button_03_Roll-out.gif"></A></TD><TD align=right><A href="gaguidaan.htm"><IMG border=0 name=image4 alt="Clicca per accedere all'argomento" src="../images/help_home_Button_04_Roll-over.gif"></A></TD></TR><TR><TD colSpan=4><A href="http://www.ntsinformatica.it"><IMG border=0 alt="Clicca per accedere al sito di NTS Informatica" src="../images/help_home_Button_04_Roll-over-row.gif"></A></TD></TR><TR><TD bgColor=#009ee2 height=53 vAlign=center width=987 colSpan=4 align=left><p><FONT class=title color=white size=6><b>Impostazione Import/Export</b></FONT></p></TD></TR><TR><TD vAlign=center colSpan=4 align=left></TD></TR></TABLE><TABLE border=0 width=987><TR><TD><p><b>Nome programma: BSIEMPTB.DLL</b><br><b>Moduli richiesti: Import/Export</b><br>Report programma: <A href="ampers08.htm#BSIEMPTB">vai ai report</A></p><p>Questo programma consente di definire tutte le caratteristiche delle operazioni da compiere per ogni profilo di Import/Export. In particolare sarà possibile far corrispondere una tabella di Business con una, di tipo esterno, dalla quale importare o sulla quale esportare i dati; per ognuna di queste corrispondenze sarà possibile far corrispondere i campi di Business con quelli esterni oppure determinare un valore da attribuire in uscita secondo diverse metodologie.</p><p><U><I><b>Corrispondenze tabelle:</b></I></U></p><p><IMG src="../images/help_bsiemptb.gif"></p><p>Mediante questa scheda è possibile far corrispondere una tabella di Business con una tabella; per ogni profilo non è possibile più avere più volte la stessa corrispondenza Tabelle Business – Tabella esterna.</p><p><b><A name=Profilo>Profilo</A></b></p><p>Indica il codice del profilo al quale appartiene questa corrispondenza tabelle; questo campo non è mai modificabile in quanto si riferisce sempre al codice del profilo aperto selezionato mediante la casella a discesa 'Profilo', che indica, tra l'altro, il tipo di profilo (importazione o esportazione).</p><p><b><A name=Aggiornalistapr>Aggiorna lista profili</A></b></p><p>Esegue una rilettura dei profili dall'elenco contenuto nella tabella 'Profili di import/export'.</p><p><b><A name=Collegamentoaut>Collegamento automatico campi</A></b></p><p>Questa funzione è abilitata solo se si è posizionati in 'Corrispondenza campi'.</p><p>Esegue un collegamento automatico tra nome campo di Business e nome campo esterno a parità di nome.</p><p><b><A name=TabellaBusiness>Tabella Business</A></b></p><p>In questo campo si indica il nome di una tabella di Business (max 30 caratteri), selezionandola eventualmente aprendo la lista tabelle abilitata su questo campo, dalla esportare se si tratta di profilo di esportazione, o su cui importare se si tratta di profilo di importazione. L'indicazione di questo campo è obbligatoria.</p><p><b><A name=Tabellaesterna>Tabella esterna</A></b></p><p>In questo campo va indicato il nome di una tabella esterna (max 30 caratteri), precedentemente creata con il programma di 'Definizione schema tabelle' (richiamabile anche da questa finestra mediante il pulsante 'Definizione schema tabelle'). L'indicazione di questo campo è obbligatoria.</p><p><b><A name=Descrizione>Descrizione</A></b></p><p>Rappresenta la descrizione (max 40 caratteri) del tipo di operazione che compie il processo di Import/Export indicato in questa riga; è un dato non obbligatorio ma utile per distingue i vari processi in fase di esecuzione.</p><p><b><A name=Ordinamento>Ordinamento</A></b></p><p>è un dato obbligatorio, rappresentato da un numero, che indica l'ordine di questa corrispondenza rispetto le altre; all'interno dello stesso profilo il numero di ordinamento deve essere univoco.</p><p><b><A name=Primaria>Primaria</A></b></p><p>è un indicatore che specifica se questa 'Corrispondenza tabella' può essere avviata singolarmente (primaria e visibile all'esterno) oppure è una corrispondenza di relazione (secondaria e invisibile all'esterno) che non può essere eseguita da sola, ma verrà automaticamente trattata quando vengono analizzate le relazioni fra 'Corrispondente tabelle'; ad esempio quando si esportano documenti di magazzino (D.D.T.) , essendo costituiti da testate e righe, si dovranno inserire 2 'Corrispondenze tabelle': testmag - Testmag.dat di tipo primario ed un'altra movmag - Movmag.dat secondaria, poste in relazione.</p><p><b><A name=Tipofiltro>Tipo filtro</A></b></p><p>è una colonna che può assumere 4 valori:</p><ul><li><I>(Nessuno)</I>: non applica nessun filtro selezionando i record da importare/esportare; <li><I>Usa filtro predefinito</I>: per estrarre i record da esportare/importare utilizza i filtri indicati nella colonna 'Filtro WHERE'; in questa colonna si deve utilizzare la sintassi della clausola WHERE dell'SQL; <li><I>Usa filtro esteso</I>: la selezione dei record viene effettuata mediante una finestra, più sotto riportata, preimpostabile che appare in fase di esecuzione richiedendo i filtri per l'estrazione dei record. <li><I>Usa filtro funzione</I>: la selezione dei record viene fatta basandosi sul risultato della funzione il cui codice deve venir indicato nella colonna 'Filtro WHERE'. Praticamente: <ol><li>creare una funzione da <A href="bsieproc.htm">Definizione funzioni I/E</A> che restituisca una stringa (filtro where con sintassi SQL), per esempio: <p><CODE>Function where<br><br>where = "codditt = '" &amp; gstrExt &amp; "'"<br><br>End Function</CODE></p><li>impostare come <U>Tipo filtro</U> = <U>Usa filtro funzione</U><li>specificare nella <U>Filtro WHERE</U> il codice della funzione creata al punto 1</li></ol></li></ul><p>è possibile utilizzare il filtro esteso o il filtro Data/ora solamente se la corrispondenza tabelle è di tipo primario.</p><p><b><A name=FiltroWHERE>Filtro WHERE</A></b></p><p>Questo campo può essere utilizzato solo se il tipo filtro assume valore 'Usa filtro predefinito' o 'Usa filtro data'. In questa colonna si deve utilizzare la sintassi della clausola WHERE dell'SQL; nel caso di esportazione si dovranno indicare i campi della tabella di Business, mentre per le importazioni dovranno essere indicati i campi della tabella esterna. Per esempio per esportare le anagrafiche articoli appartenenti al gruppo 1, si dovrà indicare 'ar_gruppo = 1', per esportare testate di DDT si dovrà indicare 'tm_tipork' = 'B'. Per questo campo non ci sono limiti nel numero di caratteri.</p><p><b><A name=ListacampiSELEC>Lista campi (SELECT)</A></b></p><p>Questo campo (normalmente non visibile) contiene la lista dei campi da estrarre dall'origine; normalmente assume il valore '*' (asterisco) per indicare tutti i campi della/e tabelle di origine. è utile per specificare campi che sono il risultato di funzioni di aggregazione SQL come Sum(), Cout(*), First(), Min(), Max(), ecc, che necessitano l'uso di un alias per essere referenziati, oppure per specificare la lista dei campi quando la query di estrazione dati (SELECT) usa un collegamento tra 2 o più tabelle (JOIN) la cui somma dei campi supera i 256. Per questo campo non ci sono limiti nel numero di caratteri.</p><p><b><A name=ClausolaFROM>Clausola FROM</A></b></p><p>Questo campo (normalmente non visibile) può contenere la clausola FROM della query di estrazione dei dati dall'origine; se non utilizzata verrà indicata la sola tabella di origine (Business e esterna). Per questo campo non ci sono limiti nel numero di caratteri.</p><p>Qualora si stia impostando una importazione da foglio di Microsoft Excel, occorrerà impostare in questa colonna il nome del foglio seguito dall'area contente i dati da importare. Ad esempio, se dovessimo importare un listino dal file Prova.xls, cartella Listini e i dati fossero contenuti nelle colonne da A a D, fino alla riga 50, scriveremmo: [Listini$A1:D100] (in realtà al posto di 100 si sarebbe potuto scrivere 50, ma se in una successiva importazione ci fossero state più di 50 righe, quelle oltre la cinquantesima sarebbero state scartate!)</p><p><b><A name=OrdinamentoORDE>Ordinamento (ORDER BY)</A></b></p><p>Questo campo (normalmente non visibile) può contenere la clausola ORDER BY della query di estrazione dei dati dall'origine; se non utilizzata i record verranno selezionati nell'ordine in cui sono conservati nella tabella di origine (Business e esterna). Questo campo è limitato ad un massimo di 50 caratteri.</p><p><b><A name=RaggruppamentoG>Raggruppamento (GROUP BY)</A></b></p><p>Questo campo (normalmente non visibile) può contenere la clausola GROUP BY della query di estrazione dei dati dall'origine; se non utilizzata i record non verranno raggruppati. Questo campo è limitato ad un massimo di 50 caratteri.</p><p><b><A name=ClausolaHAVING>Clausola HAVING</A></b></p><p>Questo campo (normalmente non visibile) può contenere la clausola HAVING della query di estrazione dei dati dall'origine solamente se è stato specificato una raggruppamento nella colonna precedente; se non utilizzata tutti i record di gruppo verranno selezionati. Questo campo è limitato ad un massimo di 50 caratteri.</p><p><b><A name=Soloprimorecord>Solo primo record</A></b></p><p>è un indicatore che specifica se viene trattato solo il primo record selezionato dalla tabella di origine; può essere indicato solo nei profili di importazione. Si può abilitare, ad esempio, nella corrispondenza tabella secondaria, quando si importano documenti di magazzino per creare l'anagrafica dell'articolo se mancante prima di scrivere il movimento di magazzino, come nell'esempio sotto riportato:</p><p><b><A name=TabBusinessTabE>Tab. BusinessTab. EsternaPrimariaSolo primo recordTipo di operazione</A></b></p><p>TestmagTestmag.datSNAggiungi solo</p><p>MovmagMovmag.datNNAggiungi solo</p><p>ArticoMovmag.datNSAggiungi solo</p><p><U>Relazione tabelle:</U></p><p><b><A name=OrdinerelTabBus>Ordine rel.Tab. Business. 1Tab. esterna 1Tab. Business 2Tab. esterna2</A></b></p><p>1TestmagTestmag.datMovmagMovmag.dat</p><p>2MovmagMovmag.datArticoMovmag.dat</p><p><U>Relazione campi:</U></p><p><b><A name=OrdinerelCampoo>Ordine rel.Campo origine 1Campo origine 2</A></b></p><p>1test_tiporkriga_tipork</p><p>1test_annoriga_anno</p><p>1test_serieriga_serie</p><p>1test_numdocriga_numdoc</p><p>2riga_codartriga_codart</p><p>L'opzione 'Solo primo record' abilitata sulla corrispondenza Artico – Movmag.dat assicura che, quando vengono selezionati i record dei movimenti di un determinato articolo, venga trattato solo il primo record (quello significativo) migliorando i tempi di importazione.</p><p><b><A name=Tipooperazione>Tipo operazione</A></b></p><p>è un campo che può assumere uno dei seguenti valori:</p><ul><li><I>Aggiungi solo</I>: i record verranno solo aggiunti; nell'esportazione si file ASCII è la sola importazione disponibile; nell'importazione qualora il record da aggiungere sia già presente (controllando la chiave primaria della tabella di Business) il programma salta a quello successivo. <li><I>Aggiorna solo</I>: i record vengono solo aggiornati; questa impostazione non è disponibile nelle esportazioni su file ASCII; nell'importazione qualora il record da aggiornare non sia presente (controllando la chiave primaria della tabella di Business) il programma passa a quello successivo. <li><I>Aggiungi o Aggiorna</I>: i record se presenti in Business vengono aggiornati, se mancanti vengono aggiunti; non è disponibile nelle esportazioni su file ASCII; il controllo della presenza del record viene fatto controllando la chiave primaria della tabella di Business. <li><I>Aggiungi solo (segnala esist.)</I>: il programma opera come l'opzione 'Aggiungi solo' ma invece di saltare i record già presenti, segnala, nel log delle importazioni, e nella tabella contenente gli errori di importazione, ne segnala la presenza. <li><I>Inserimento massivo:</I> il programma opera come l'opzione 'Aggiungi solo' ma non controlla la presenza o meno di un record con chiave uguale a quella del record che si sta inserendo. Qualora si verificasse una situazione simile verrebbe scatenatu un errore. Con questa soluzione l'inserimento delle informazioni sul database di Business è più veloce rispetto alla soluzione 'Aggiungi solo'.</li></ul><p><b><A name=Tipodatabase>Tipo database</A></b></p><p>Questa colonna contiene l'indicazione del tipo di database Business su cui operare con l'importazione o l'esportazione; può essere indicato l'archivio procedura (contenente l'elenco ABI-CAB, l'elenco dei codici TARIC per l'Intrastat, le stampe parametriche, ecc.) oppure l'archivio azienda correntemente aperta.</p><p><b><A name=Analizzarelazio>Analizza relazioni</A></b></p><p>Questo indicatore fa si che il programma analizzi o meno le relazioni esistenti fra le corrispondenze tabelle; è aggiunto per ragioni di prestazioni, per evitare che vengano attivati i meccanismi di controllo su tutti i livelli di relazioni, anche se non necessari.</p><p><b><A name=UsaScriptEngine>Usa ScriptEngine</A></b></p><p>Specifica se questa corrispondenza tabelle, utilizza o meno routine personalizzate da far eseguire allo Script Engine sia a livello di tabella che a livello di campo; è obbligatorio abilitare l'opzione quando è indicato uno o più codici di procedura da eseguire. L'uso di questa impostazione agisce sensibilmente sulle prestazioni dell'Import/Export a causa delle operazioni aggiuntive che il motore compie durante tutte le fasi del processo (precarica nello Script Engine di tutte le funzioni da caricare all'avvio, esposizione, record per record, delle variabili contenenti i valori dei campi di origine e quelli, in seguito alla valutazione, dei campi di destinazione).</p><p><b><A name=Segnalaassenzar>Segnala assenza record</A></b></p><p>Indica se segnalare o meno la mancanza di record da selezionare dall'origine; normalmente questa opzione è abilitata allo scopo di segnalare nel log file (o a video se si tratta di relazione primaria) l'assenza di record, si disabilita quando è possibile che sull'origine non siano presenti record: per esempio esportano o importando documenti di magazzino che trattano articoli gestiti a matricole e non, quando vengono selezionate le matricole per riga di documento, evita il messaggio quando esporta o importa articoli che non prevedono le matricole.</p><p><b><A name=RoutineInitiali>Routine Initialize</A></b></p><p>Può indicare il codice della routine che il programma di Import/Export (mediante lo Script Engine) eseguirà <b>prima di creare il file esterno</b>. Il codice che si indica deve riferirsi ad una routine esistente. è obbligatorio che l'opzione 'Usa ScriptEngine' sia abilitata prima di inserire un codice. Questa routine viene lanciata solo su tabelle primarie di livello 1.</p><p><b><A name=RoutineBeforeAl>Routine BeforeAll</A></b></p><p>Può indicare il codice della routine che il programma di Import/Export (mediante lo Script Engine) eseguirà <b>prima di trattare il primo record</b> di questa corrispondenza tabelle. Il codice che si indica deve riferirsi ad una routine esistente. è obbligatorio che l'opzione 'Usa ScriptEngine' sia abilitata prima di inserire un codice.</p><p><b><A name=RoutineBeforeIn>Routine BeforeIns</A></b></p><p>Può indicare il codice della routine che il programma di Import/Export (mediante lo Script Engine) eseguirà <b>prima di inserire ogni record</b> di questa corrispondenza tabelle. Il codice che si indica deve riferirsi ad una routine esistente. è obbligatorio che l'opzione 'Usa ScriptEngine' sia abilitata prima di inserire un codice.</p><p><b><A name=RoutineBeforeUp>Routine BeforeUpd</A></b></p><p>Può indicare il codice della routine che il programma di Import/Export (mediante lo Script Engine) eseguirà <b>prima di aggiornare ogni record</b>, già esistente sulla tabella di destinazione, di questa corrispondenza tabelle. Il codice che si indica deve riferirsi ad una routine esistente. è obbligatorio che l'opzione 'Usa ScriptEngine' sia abilitata prima di inserire un codice.</p><p><b><A name=RoutineAfterCor>Routine AfterCorBeforeIns</A></b></p><p>Può indicare il codice della routine che il programma di Import/Export (mediante lo Script Engine) eseguirà <b>prima di inserire ogni record </b>(ma <b>dopo aver analizzato le relazioni</b> che hanno indicato, come 'Tempo di valutazione', il valore 'Prima della scrittura del record'), di questa corrispondenza tabelle. Il codice che si indica deve riferirsi ad una routine esistente. è obbligatorio che l'opzione 'Usa ScriptEngine' sia abilitata prima di inserire un codice.</p><p><b><A name=RoutineAfterCor>Routine AfterCorBeforeUpd</A></b></p><p>Può indicare il codice della routine che il programma di Import/Export (mediante lo Script Engine) eseguirà <b>prima di aggiornare ogni record </b>(ma <b>dopo aver analizzato le relazioni</b> che hanno indicato, come 'Tempo di valutazione', il valore 'Prima della scrittura del record'), già esistente sulla tabella di destinazione, di questa corrispondenza tabelle. Il codice che si indica deve riferirsi ad una routine esistente. è obbligatorio che l'opzione 'Usa ScriptEngine' sia abilitata prima di inserire un codice.</p><p><b><A name=RoutineAfterIns>Routine AfterIns</A></b></p><p>Può indicare il codice della routine che il programma di Import/Export (mediante lo Script Engine) eseguirà <b>dopo l'inserimento di ogni record</b>, con esito positivo, di questa corrispondenza tabelle. Il codice che si indica deve riferirsi ad una routine esistente. è obbligatorio che l'opzione 'Usa ScriptEngine' sia abilitata prima di inserire un codice.</p><p><b><A name=RoutineAfterUpd>Routine AfterUpd</A></b></p><p>Può indicare il codice della routine che il programma di Import/Export (mediante lo Script Engine) eseguirà <b>dopo l'aggiornamento di ogni record</b>, con esito positivo, già esistente sulla tabella di destinazione, di questa corrispondenza tabelle. Il codice che si indica deve riferirsi ad una routine esistente. è obbligatorio che l'opzione 'Usa ScriptEngine' sia abilitata prima di inserire un codice.</p><p><b><A name=RoutineAfterCor>Routine AfterCorAfterIns</A></b></p><p>Può indicare il codice della routine che il programma di Import/Export (mediante lo Script Engine) eseguirà <b>dopo l'inserimento di ogni record</b>, con esito positivo, (ma <b>dopo aver analizzato le relazioni</b> che hanno indicato, come 'Tempo di valutazione', il valore 'Dopo la scrittura del record'), di questa corrispondenza tabelle. Il codice che si indica deve riferirsi ad una routine esistente. è obbligatorio che l'opzione 'Usa ScriptEngine' sia abilitata prima di inserire un codice.</p><p><b><A name=RoutineAfterCor>Routine AfterCorAfterUpd</A></b></p><p>Può indicare il codice della routine che il programma di Import/Export (mediante lo Script Engine) eseguirà <b>dopo l'aggiornamento di ogni record</b>, con esisto positivo, (ma <b>dopo aver analizzato le relazioni</b> che hanno indicato, come 'Tempo di valutazione', il valore 'Dopo la scrittura del record'), già esistente sulla tabella di destinazione, di questa corrispondenza tabelle. Il codice che si indica deve riferirsi ad una routine esistente. è obbligatorio che l'opzione 'Usa ScriptEngine' sia abilitata prima di inserire un codice.</p><p><b><A name=RoutineAfterAll>Routine AfterAll</A></b></p><p>Può indicare il codice della routine che il programma di Import/Export (mediante lo Script Engine) eseguirà <b>dopo aver trattato l'ultimo record</b> di questa corrispondenza tabelle. Il codice che si indica deve riferirsi ad una routine esistente. è obbligatorio che l'opzione 'Usa ScriptEngine' sia abilitata prima di inserire un codice.</p><p><b><A name=RoutineTerminat>Routine Terminate</A></b></p><p>Può indicare il codice della routine che il programma di Import/Export (mediante lo Script Engine) eseguirà <b>dopo aver salvato e chiuso </b>il file esterno (ad esempio per inviarlo tramite e-mail oppure spostarlo in un'altra cartella). Il codice che si indica deve riferirsi ad una routine esistente. è obbligatorio che l'opzione 'Usa ScriptEngine' sia abilitata prima di inserire un codice. Questa routine viene lanciata solo su tabelle primarie di livello 1.</p><p><b><A name=PreSelezione>Pre-Selezione</A></b></p><p>Se si seleziona questa voce nel momento in cui viene eseguito il programma 'Strumento di import/export' le tabelle avranno già la spunta per essere eseguite.</p><p><U><I><b>Filtri estesi:</b></I></U></p><p><IMG src="../images/help_bsiemptb1.gif"></p><p>I filtri estesi vengono impostati solamente se la colonna 'Tipo filtro' è impostata a 'Usa filtri estesi'; si attiva quando si è posizionati sulla riga di corrispondenza tabelle col menu Record|Imposta filtri estesi oppure col tasto di scelta rapida Ctrl+I.</p><p>Mediante questa finestra è possibile indicare al massimo 10 filtri sui campi della tabella di origine selezionabili mediante la casella a discesa; dopo la selezione di un campo di Business automaticamente verrà indicata la descrizione, e il tipo del campo. Il valore predefinito impostato è quello che l'utente avrà già preimpostato, ma comunque modificabile, al momento della esecuzione del processo di Import/Export. Qualora necessiti come valore è possibile specificare anche il valore nullo indicando la scritta 'Null' possibile solo con operatore uguale '=' o diverso '&lt;&gt;'. All'interno del campo 'Valore predefinito' è obbligatorio indicare valori congruenti con il tipo di campo (es. un campo di tipo numerico potrà accettare solo cifre e non lettere).</p><p><IMG src="../images/help_bsiemptb2.gif"></p><p>Una volta indicati tutti i filtri occorre metterli in relazione utilizzando i pulsanti al fianco di ogni filtro seguiti dagli operatori di legame (AND, OR o NOT) ed eventualmente dai livelli di parentesi; i marcatori '{Val0} – {Val9} saranno sostituiti con i valori che l'operatore indicherà in fase di esecuzione. Il pulsante 'Elimina' cancella il contenuto della relazione filtri; col pulsante 'Rimuovi tutto', invece si cancellano le impostazioni di tutti i filtri per reinserirli.</p><p><U><I><b>Corrispondenza campi:</b></I></U></p><p>In questa sezione viene impostato il modo in cui viene attribuito un valore da inserire sul campo della tabella di destinazione. Nei profili di esportazione i campi di destinazione sono quelli elencati nella colonna 'Nome campo esterno', viceversa nelle esportazioni sono quelli indicati nella colonna 'Nome campo Business'. Ai campi viene impostato un valore seguendo queste priorità:</p><ol><li>Se nella colonna 'Nome campo esterno' (per l'importazione) o 'Nome campo Business (nell'esportazione) esiste un valore diverso da '(Nessuno)' il programma legge il contenuto di questo campo di origine e lo tratta nel seguente modo: <ul><li>se esiste una trascodifica su questo campo la rileva, eventualmente chiedendola all'utente qualora manchi, e attribuisce il valore ottenuto alla destinazione; <li>in mancanza di trascodifiche, se esiste nella colonna 'Coeff. divisione' un valore diverso da zero e il campo di destinazione è numerico effettua la divisione prima di attribuirlo alla destinazione.</li></ul><li>Se come campo di origine è indicato il valore '(Nessuno)', quindi non esiste il campo da cui prelevare i dati, esplicitamente indicato, ed è inserito qualcosa nella colonna 'Valore campo', il programma attribuirà questo valore alla destinazione. <li>Se non è indicato il campo di origine e il valore campo predefinito, il programma cercherà di valutare la funzione, eventualmente specificata nella colonna 'Codice funzione', il cui valore restituito sarà attribuito al campo di destinazione.</li></ol><p>Resta inteso che, qualora, in seguito a queste valutazioni, il valore attribuito risulta essere nullo (anche in seguito a errore di conversione di dati non omogenei), il programma attribuisce, segnalando nel log degli eventi questa situazione, al campo di destinazione il valore predefinito, qualora sia rilevabile (come nel caso di importazione), oppure un valore predefinito specifico per tipo di campo di destinazione (per l'esportazione, ad esempio, su file ASCII, il programma attribuisce caratteri spazio per i campi testo o data, 0 (zeri) per i caratteri numerici).</p><p>Come regola generale, nell'importazione, non è obbligatorio inserire una corrispondenza campi per ogni campo di Business, in quando su quelli non eventualmente ridefiniti sarà il gestore del database ad attribuirgli il valore predefinito se esistente; è comunque obbligatorio almeno definire i campi della chiave primaria. è obbligatorio invece ridefinire tutti i campi di destinazione nel caso di esportazione.</p><p><IMG src="../images/help_bsiemptb3.gif"></p><p><b><A name=Ordinamento>Ordinamento</A></b></p><p>è l'ordine con cui i campi vengono trattati durante il processo di Import/Export. è un campo numerico, univoco all'interno di ogni corrispondenza tabelle, che assume particolare importanza quando si utilizza lo Script Engine, e in particolare le variabili che contengono, record per record, il contenuto dei campi da attribuire alla destinazione: nell'immagine sopra indicata, ad esempio, durante la fase di attribuzione del valore al campo di ordine 9 ('mm_colli' destinazione Business, 'quant' origine file ascii Movmag.dat) si ha già a disposizione nello ScriptEngine la variabile 'IeOu2mm_unmis', precedente di ordine 8, ma non la variabile 'IeOu2mm_prezzo' successiva di ordine 12; questa variabile sarà ancora Empty se si tratta del primo record, oppure conterrà il valore del campo 'mm_prezzo' attribuito nel record precedente e quindi <b>non</b> attendibile.</p><p><b><A name=NomecampoBusine>Nome campo Business</A></b></p><p>è il nome del campo Business (max 30 caratteri) selezionabile dalla casella a discesa, che rappresenta la destinazione nel caso di importazione, l'origine in caso di esportazione. è una dato sempre obbligatorio. Qualora, nell'esportazione, non sia necessario un campo di origine, indicare il valore '(Nessuno)'.</p><p><b><A name=Nomecampoestern>Nome campo esterno</A></b></p><p>è il nome del campo esterno (max 30 caratteri) selezionabile dalla casella a discesa, che rappresenta l'origine nel caso di importazione, la destinazione in caso di esportazione. è una dato sempre obbligatorio.</p><p>Qualora, nell'importazione, non sia necessario un campo di origine, indicare il valore '(Nessuno)'.</p><p><b><A name=Valorecampo>Valore campo</A></b></p><p>è un campo, di massimi 50 caratteri, che può contenere un valore fisso da attribuire al campo di destinazione durante il processo di Import/Export. Ha priorità 2 come indicato sopra nelle note generali. è obbligatorio che in questo campo venga indicato un valore congruente con il tipo di dato della destinazione per evitare segnalazioni di errori di conversione di tipi durante l'esecuzione.</p><p><b><A name=Codicefunzione>Codice funzione</A></b></p><p>Può indicare il codice di una routine funzione (che restituisce quindi un valore) o una istruzione VBScript, che il programma eseguirà per restituire il valore da attribuire al campo di destinazione. Ha priorità 3 come indicato nelle note generali. Il risultato di questa funzione o istruzione sia congruente con il tipo di dato della destinazione per evitare segnalazioni di errori di conversione di tipi durante l'esecuzione. è obbligatorio che l'opzione 'Usa ScriptEngine', sulla corrispondenza tabelle a cui questa impostazione di campo appartiene, sia abilitata.</p><p><b><A name=NullgtBlank>Null -&gt; Blank</A></b></p><p>è una opzione, utilizzabile solo nell'importazione da tabelle di tipo 'Jet ISAM Text' o 'ASCII Text file', che abilita la conversione del valore nullo dell'origine in un carattere spazio, questo a causa del fatto che in un file di testo a campi a lunghezza fissa, caratteri spazio vengono interpretati come valore nullo; in alcune circostanza, come ad esempio per la serie dei documenti di magazzini, è necessario operare questa conversione.</p><p><b><A name=FomatVB>Fomat VB</A></b></p><p>Rappresenta un campo di testo, di massimi 50 caratteri, che contiene la stringa di formattazione (secondo la sintassi della funzione Format() del Visual Basic for Application, rilevabile in qualsiasi guida di un programma che implementa questo linguaggio quale Microsoft Access, Microsoft Excel, ecc.) utilizzabile solamente nelle esportazioni su tabelle esterne di tipo 'ASCII Text file'. Se omessa, per i campi numerici interi (long, single) il valore viene comunque arrotondato all'intero; per i campi che prevedono valori decimali (double, currency) il valore viene arrotondato al secondo decimale.</p><p><b><A name=Coefficientediv>Coefficiente divisione</A></b></p><p>è un numero che, se diverso da 0, può indicare un multiplo o sottomultiplo di 10 per consentire di trattare, in fase di esportazione o importazione i campi numerici non interi senza l'utilizzo del separatore decimale: se il programma legge dal campo di origine il valore numerico 10050006 e come coefficiente di divisione è indicato 100, alla destinazione il programma attribuirà il valore 10.050,06. L'uso di questo coefficiente è possibile solo sui campi numerici e se esiste l'indicazione del campo di origine.</p><p><b><A name=Trascodifica>Trascodifica</A></b></p><p>è un'opzione che indica se il campo di origine deve essere o meno trascodificato, facendo corrispondere ad un valore di origine, un altro per la destinazione. Se questa opzione è abilitata, è obbligatorio indicare un codice trascodifica esistente nella colonna successiva. L'abilitazione di questa opzione è possibile solo se esiste l'indicazione del campo di origine.</p><p><b><A name=Codicetrascodif>Codice trascodifica</A></b></p><p>è un campo che contiene il codice trascodifica riferita al campo di origine di questa corrispondenza campi. Durante la fase di esecuzione, se il valore di un campo che si riceve in origine non è tra quelli previsti, il programma può, a seconda di come impostata la trascodifica, chiede all'utente il valore di destinazione o procedere attribuendo il valore predefinito del campo di destinazione, se rilevabile, oppure il valore nullo segnalando comunque l'operazione compiuta nel log file. I valori che l'utente inserisce, verranno salvati e saranno utilizzati dal programma automaticamente dal quel momento in poi.</p><p><U><I><b>Relazioni tabelle:</b></I></U></p><p>Mediante queste scheda vengono messe in relazione più corrispondenze tabelle. L'uso di queste relazioni fa si che quando il programma di Import/Export tratta un record analizzi, prima e dopo la scrittura del record, tutte le tabelle in relazione: questo allo scopo, ad esempio, di trattare i documenti di magazzino, che sono costituiti da testate e righe, e tutti gli altri casi in cui devono essere considerati unicamente, per vincoli di integrità referenziale sul database, dati localizzati su tabelle diverse ma comunque legati.</p><p>Allo stato è possibile solo al massimo utilizzare 4 livelli di relazione; durante l'imputazione delle relazione il programma non controlla questo limite; sarà solo in fase di esecuzione che segnalerà il raggiungimento del 4 livello di relazione, causato spesso da riferimenti circolari non consentiti. Non c'è limite al numero di relazioni per ogni livello.</p><p>Un altro vincolo sulle relazioni tabelle è dato dal fatto che tutte le tabelle esterne della relazione primaria e di tutti i livelli sottostanti, devono essere dello stesso tipo (attualmente o Jet ISAM Text o ASCII Text file).</p><p>Corrispondenze tabelle poste in relazione devono appartenere allo stesso profilo.</p><p><IMG src="../images/help_bsiemptb4.gif"></p><p><b><A name=Profiloinrelazi>Profilo in relazione</A></b></p><p>è il codice del profilo della corrispondenza tabella posta in relazione. Non è mai editabile sia sull'inserimento che in modifica.</p><p><b><A name=TabellaBusiness>Tabella Business in relazione</A></b></p><p>è il nome della tabella di Business esistente posta in relazione (max 30 caratteri).</p><p><b><A name=Tabellaesternai>Tabella esterna in relazione</A></b></p><p>è il nome della tabella di Business esistente posta in relazione (max 30 caratteri).</p><p>I 3 campi sopra elencati devono appartenere ad una Corrispondenza tabelle già definitiva per il profilo.</p><p><b><A name=Ordinerelazione>Ordine relazione</A></b></p><p>è la sequenza con cui vengono analizzate le relazioni dal programma. Questo numero deve essere univoco all'interno di ogni corrispondenza tabella primaria a parità di Tempo di valutazione.</p><p><b><A name=Tempodivalutazi>Tempo di valutazione</A></b></p><p>è un campo che può assumere due valori: <I>Dopo la scrittura del record</I> dove la relazione viene eseguita dopo aver inserito o modificato, con esito positivo, il record sulla tabella di destinazione primaria<I>; Prima della scrittura del record </I>dove la relazione viene eseguita prima di aver inserito o modificato, con esito positivo il record.</p><p><b><A name=Sospendirelazio>Sospendi relazione</A></b></p><p>Questa opzione, normalmente non abilitata, forza l'esclusione dell'analisi della relazione corrente. Può essere utilizzata soprattutto in fase di test di un profilo di Import/Export.</p><p><b><A name=Validitagravere>Validità relazione</A></b></p><p>Questo campo contiene la condizione necessarie per rendere valido il legame di relazione corrente. Può assumere il valore <I>Solo in inserimento</I> dove la relazione viene considerata solo se il record, sulla tabella di destinazione primaria, è stato aggiunto; <I>Solo in aggiornamento</I> dove la relazione viene considerata solo se il record è stato aggiornato; <I>Sempre</I> la relazione viene sempre eseguita.</p><p><U><I><b>Relazione campi:</b></I></U></p><p>Con questa scheda vengono messi in relazione i campi fra le tabelle poste in relazione in precedenza. I nomi dei campi sono sempre riferiti alle tabelle di origine.</p><p><IMG src="../images/help_bsiemptb5.gif"></p><p><b><A name=Ordinecampo>Ordine campo</A></b></p><p>è un numero che indica l'ordine del campo posto in relazione. Deve essere univoco per ogni tabella posta in relazione.</p><p><b><A name=Nomecampo>Nome campo</A></b></p><p>è il nome del campo (max 30 caratteri) della tabella di origine primaria selezionabile mediante la casella a discesa.</p><p><b><A name=Nomecamporelazi>Nome campo relazione</A></b></p><p>è il nome del campo (max 30 caratteri) della tabella di origine secondaria selezionabile mediante la casella a discesa.</p><p>Sarà cura dell'utente far si che il tipo dei campi posti in relazione sia uguale al fine di evitare segnalazioni di errore durante l'esecuzione.</p><p><U><I><b>Funzioni di toolbar:</b></I></U></p><p><b><A name=CollegamentoAutomaticoCampi>Collegamento automatico campi</A></b></p><p>Tramite questa funzione è possibile compilare più velocemente (ove possibile) la griglia della corrispondenza campi, questa funzione aggiunge nella griglia tutti i campi della tabella esterna che hanno lo stesso nome nella tabella di business.</p><p><IMG src="../images/help_bsiemptb8.gif"></p><p><b><A name=PrecompilaCampiImportare>Precompila campi da importare</A></b></p><p>Tramite questa funzione è possibile compilare più velocemente la griglia della corrispondenza campi, a seconda che il profilo si tratti di un import o di un export nella griglia verranno esplosi rispoettivamente tutti i campi della tabella di business o della tabella esterna. Successivamente l'utente andrà a definire come devono essere valorizzati suddetti campi.</p><p><IMG src="../images/help_bsiemptb6.gif"></p><p><IMG src="../images/help_bsiemptb7.gif"></p></TD></TR></TABLE><TABLE border=0 cellSpacing=0 cellPadding=0><TR><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/software-retail-negozi/"><IMG border=0 src="../images/help_home_01_Gestisci.gif"></A></TD><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/controllo-di-gestione/"><IMG border=0 src="../images/help_home_02_Controlla.gif"></A></TD><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/crm/"><IMG border=0 src="../images/help_home_03_Fidelizza.gif"></A></TD><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/analisi-dati-datawarehouse/"><IMG border=0 src="../images/help_home_04_DWH.gif"></A></TD><TD vAlign=center width=169 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/project-management/"><IMG border=0 src="../images/help_home_05_Gestisci.gif"></A></TD><TD vAlign=center width=146 align=right><IMG border=0 src="../images/help_home_NTS_logo_up.gif"></TD></TR><TR><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/logistica/"><IMG border=0 src="../images/help_home_06_Organizza.gif"></A></TD><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/customer-service/"><IMG border=0 src="../images/help_home_07_Gestisci.gif"></A></TD><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/produzione/"><IMG border=0 src="../images/help_home_08_Pianifica.gif"></A></TD><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/archiviazione-documenti/"><IMG border=0 src="../images/help_home_09_Archivia.gif"></A></TD><TD vAlign=center width=169 align=right><IMG border=0 src="../images/help_home_NTS_logo_down1.gif"></TD><TD vAlign=center width=146 align=right><A href="http://www.ntsinformatica.it"><IMG border=0 alt="Clicca per accedere al sito di NTS Informatica" src="../images/help_home_NTS_logo_down2.gif"></A></TD></TR><TR><TD width=987 colSpan=6><IMG border=0 src="../images/help_home_Line.gif"></TD></TR></TABLE></body></html></body></html>