<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3c.org/TR/1999/REC-html401-19991224/loose.dtd">
<html>
<head>
<title> GA: Import/export VS NetPro Classic</title>
<LINK rel=stylesheet type=text/css href="style_topic.css">
<SCRIPT LANGUAGE="JavaScript">
<!-- Begin
loadImage1 = new Image();
loadImage1.src = "../images/help_home_Button_01_Roll-over.gif";
staticImage1 = new Image();
staticImage1.src = "../images/help_home_Button_01_Roll-out.gif";

loadImage2 = new Image();
loadImage2.src = "../images/help_home_Button_02_Roll-over.gif";
staticImage2 = new Image();
staticImage2.src = "../images/help_home_Button_02_Roll-out.gif";

loadImage3 = new Image();
loadImage3.src = "../images/help_home_Button_03_Roll-over.gif";
staticImage3 = new Image();
staticImage3.src = "../images/help_home_Button_03_Roll-out.gif";

loadImage4 = new Image();
loadImage4.src = "../images/help_home_Button_04_Roll-over.gif";
staticImage4 = new Image();
staticImage4.src = "../images/help_home_Button_04_Roll-out.gif";

// End -->
</SCRIPT>

</head>
<body lang=it topMargin=3>
<TABLE width=987 border=0><TR><TD vAlign=top align=right><p><code>Data ultimo aggiornamento: <A name=hINIeDATlAGGp></A>23/12/2015</FONT><A name=hFINeDATlAGGp></A></code></p></TD></TR></TABLE><TABLE cellSpacing=0 border=0><TR><TD colSpan=4><A href="http://www.ntsinformatica.it"><IMG border=0 alt="Clicca per accedere al sito di NTS Informatica" src="../images/help_home_banner.gif"></A></TD></TR></TABLE><TABLE cellSpacing=0 cellPadding=0 border=0><TR><TD align=left><A onmouseover="image1.src=loadImage1.src;" onmouseout="image1.src=staticImage1.src;" href="cose.htm"><IMG border=0 name=image1 alt="Clicca per accedere all'argomento" src="../images/help_home_Button_01_Roll-out.gif"></A></TD><TD align=center><A onmouseover="image2.src=loadImage2.src;" onmouseout="image2.src=staticImage2.src;" href="pc.htm"><IMG border=0 name=image2 alt="Clicca per accedere all'argomento" src="../images/help_home_Button_02_Roll-out.gif"></A></TD><TD align=center><A onmouseover="image3.src=loadImage3.src;" onmouseout="image3.src=staticImage3.src;" href="ambsargmod.htm"><IMG border=0 name=image3 alt="Clicca per accedere all'argomento" src="../images/help_home_Button_03_Roll-out.gif"></A></TD><TD align=right><A href="gaguidaan.htm"><IMG border=0 name=image4 alt="Clicca per accedere all'argomento" src="../images/help_home_Button_04_Roll-over.gif"></A></TD></TR><TR><TD colSpan=4><A href="http://www.ntsinformatica.it"><IMG border=0 alt="Clicca per accedere al sito di NTS Informatica" src="../images/help_home_Button_04_Roll-over-row.gif"></A></TD></TR><TR><TD bgColor=#009ee2 height=53 vAlign=middle width=987 colSpan=4 align=left><p><FONT class=title color=white size=6><b>Import/export VS NetPro Classic</b></FONT></p></TD></TR><TR><TD vAlign=middle colSpan=4 align=left></TD></TR></TABLE><TABLE width=987 border=0>
<TR>
<TD>
<p>
<b>Nome programma: BNNPIENP.DLL</b>
<br>
<b>Moduli richiesti: Collegamento a NetPro Classic</b>
</p>
<p>Con questo programma è possibile gestire l'integrazione con NetPro Classic di Messolutions.</p>
<p>
<IMG src="../images/help_bsnpienp_01.jpg">
</p>
<p>L'integrazione tra Business e Net@Pro (di seguito MES) avviene nel seguente modo:</p>
<ul>
<li>In Bus viene gestito sempre tutto il ciclo sia attivo che passivo, vengono gestite le anagrafiche clienti/fornitori, articoli, distinte basi
<li>Devono essere gestite manualmente sia un Bus che in MES, con gli stessi codici, le seguenti tabelle: <ul>
<li>Tabella magazzini
<li>Tabella centri di lavoro
<li>Tabella operai
<li>Tabella lavorazioni: sul MES non esiste, ma le descrizioni delle lavorazioni devono essere uguali a quelle della tabella lavorazioni di Business</li>
</ul>
<li>Business passa periodicamente le esistenze di magazzino al MES, i clienti/fornitori e gli articoli; le giacenze di magazzino sono fondamentali per una corretta elaborazione MRP sul MES, per cui è bene che vengano passate prima del lancio dell'MRP di MES!
<li>Al salvataggio di ordini di Business viene eseguito l'aggiornamento degli archivi di MES tramite tabelle di transito. Per gli ordini di produzione interni, la modifica/cancellazione in Bus è possibile solo fino a quando in MES l'ordine non è diventato esecutivo 'EMI'. Eventualmente per poter eseguire modifiche bisogna prima cancellare l'ordine in MES (o impostarlo in status 'REL')
<li>Periodicamente (volendo anche in modo schedulato) vengono importati da MES i carichi da produzione interni</li>
</ul>
<p>Per una corretta gestione del mes con Business le operazioni di aggiornamento sono divise in 2 modalità: quelle schedulate e quelle immediate. MES per esportare i dati può operare in modo manuale o in modo schedulato.</p>
<ul>
<li>Per quanto riguarda l'elaborazione MRP di MES si consiglia di eseguirla manualmente dal MES e successivamente di importarla manualmente in BUS (ricordandosi prima dell'import in Bus di fare sul MES un 'esporta tabelle').
<li>Per quanto riguarda l'export dal MES dei carichi da produzione interni realizzati si consiglia l'export schedulato e l'import schedulato in BUS, in entrambi i software con una periodicità che può andare da 5 minuti alla giornata (in base alle esigenze aziendali).
<li>Per quanto riguarda l'export di tabelle (anagrafiche, distinte basi, esistenze) si consiglia un export schedulato in Bus, con una periodicità in ore che può andare da 6 a 12 ore. Al termine di ogni export Business lancia un comando sul MES per fargli acquisire i dati immediatamente. Nel caso in cui serva un aggiornamento UNA TANTUM perché sono stati modificati dei dati in bus che servono subito in MES si potrà procedere con un export manuale
<li>Per quanto riguarda la creazione/modifica/cancellazione di ordini in bus, il passaggio dati al MES avviene immediatamente tramite messaggistica socket, per cui subito dopo aver creato (o modificato, evaso, ...) un ordine in bus sarà disponibile aggiornato lo stesso documento anche sul mes.
<li>Per quanto riguarda l' importazione ordini di produzione in BUS (dopo l'elaborazione dell'MRP ed export ordini in stato PRO dal MES) in automatico una socket provvederà a cancellare i documenti in stato PRO sul MES.</li>
</ul>
<p>In MES è fondamentale che le operazioni di import/export vengano eseguite con un determinato ordine, diversamente gli archivi possono compromettersi. Ad esempio se creo una proposta d'ordine di produzione sul MES tramite elaborazione MRP, lo importo in Business (quindi sul MES l'ordine viene rimosso), successivamente rieseguo l'elaborazione MRP sul MES senza aver passato da Bus gli ordini di produzione (generati dalle proposte d'ordine) è chiaro che il MES rigenererà nuovamente le proposte d'ordine e si avranno dei duplicati in Business!</p>
<p>Il MES ha delle impostazioni per fare in modo che il dato esportato su tabelle FX non venga più esportato, oppure che venga esportato tutte le volte. Con Business è necessario che una volta che un dato è stato esportato non venga fatto.</p>
<p>In una fase di startup del MESoltre alle operazioni di passaggio anagrafiche e saldi di magazzino sarà necessario passare gli ordini non ancora evasi riaprendo gli stessi da Business e risalvandoli.</p>
<p>In MES non esistono gli impegni di trasferimento tra magazzini, per cui in Business non sarà possibile creare delle proposte di trasferimento. Eventualmente l'utente potrà utilizzare, al bisogno, il programma BNDBCRIT.</p>
<p>Volendo le distinte basi possono essere gestite anche solo in MES. Ovviamente non sarà possibile, in Business, realizzare ordini di produzione a mano con esplosione delle distinte basi.</p>
<p>Gli articoli possono essere gestiti a lotti e/o commessa, no matricole o ubicazioni dinamiche (questi ultimi vengono comunque passati al MES), Per quanto riguarda lotti e commesse, in fase di acquisizione carichi da produzione interni dal MES in Business verrà assegnato il valore fisso '1' sia in carico che in scarico se i richiesti codici non sono presenti/valorizzati nell'ordine di produzione/impegno di produzione/nota di prelievo). Lotto 1 e commessa 1 devono ESSERE PRESENTI NELL'ANAGRAFICA LOTTI e COMMESSE di Business prima di eseguire l'importazione!</p>
<p>Nelle anagrafiche del MES sono presenti dati non disponibili in Business (e viceversa). Il flusso delle anagrafiche sarà sempre da Bus verso MES, quindi bisognerà entrare in MES per integrare le tabelle con i dati non presenti in Bus (specialmente anagrafiche articoli e distinte basi).</p>
<p>
<b>ATTENZIONE (importante, da leggere): 
<br>Il programma "BX118 - Collegamento a Net@Pro Classic", deve</b>
<b>essere sempre preventivamente richiesto a NTS Project che ne cura lo sviluppo e l'assistenza. 
<br>Eventuali versioni del modulo rilasciate in precedenza da NTS Informatica non son più supportate. 
<br>Trattandosi di un'area ad elevata specializzazione e personalizzazione, per la vendita del modulo sono richieste le tre seguenti condizioni: 
<br>1) che il Partner NTS possa operare sui sorgenti dell'area produzione di Business (verificare contratto di distribuzione) 
<br>2) che il Partner NTS acquisti la versione sorgente del modulo BX118 (si veda l'apposita pagina del Listino Partner NTS) 
<br>3) che l'utente finale abbia attivi i moduli "BX09 Distinta Base" e "BX18 Produzione" 
<br>I programmi in versione sorgente sono necessari per i successivi settaggi e modifiche sui programmi, sempre a carico del Partner NTS. 
<br>NTS Project non può infatti garantire interventi fuori standard, possibili solo in scenari ben definiti ed effettuati solo previa analisi di fattibilità e relativo preventivo.</b>
</p>
<p>
<b>Installazione del MES</b>
</p>
<p>Il passaggio dati tra Bus e MES avviene tramite tabelle di transito presenti nel database di MES.</p>
<p>L'installazione di MES deve essere obbligatoriamente eseguita su database SQL Server.</p>
<p>Il database di MES deve trovarsi sullo stesso server del database di Business. Per questo motivo al database di MES deve essere possibile accedere in lettura/scrittura con l'utente di SQL Server utilizzato da business (almeno alle tabelle di transito). Il nome del Database di MES sarà memorizzato nell'opzione di registro Business/Opzioni/MESDB_<i>nomeditta</i> (es Business/opzioni/MESDB_prova = nome_databse_di_mes)</p>
<p>Quando Business deve salvare un ordine/lista di produzione, per poterlo passare anche al MES in una unica transazione sarà necessario eseguire una query con anteposto al nome della tabella anche il nome del database.DBO.</p>
<p>
<b>Configurazione bus per richiamare in automatico import di MES</b>
</p>
<p>Business per poter comunicare al MES di eseguire degli import e/o acquisire le modifiche agli ordini fatte in BUS ha bisogno dell'indirizzo IP e della porta con cui la socket di BUS deve comunicare con la socket del MES. Queste due informazioni devono venir settate con l' opzione di registro</p>
<p>Business/opzioni/ MESSOCKET _nomeditta= indirizzo_IP_del_pc_dove_gira_npserver.exe + ':' + numero_della_porta</p>
<p>(es: Business/opzioni/MESSOCKET_prova = 192.168.1.1:1234)</p>
<p>Per default la port di connessione con il MES è la 2157 (comunque modificabile/impostabile in fdcs.ini alla proprietà 'CLIENTPORT=')</p>
<p>Inoltre necessita di sapere quale utente + pwd devono essere usati per loggarsi al MES, le opzioni di registro da settare sono:</p>
<p>Business/opzioni/ MESUSER _nomeditta = utente_di_login_mes, default 'BUSINESS'</p>
<p>Business/opzioni/ MESPWD _nomeditta = password_di_login_mes, default 'NTS'</p>
<p>Qualora siano state indicate nelle opzioni di registro delle informazioni non corrette per l'avvio del mes tramite NPAccess (oppure NPSERVER.EXE non è in esecuzione), Business non segnalerà nessun errore ma nonavvisereà il MES di eseguire l'import dei dati!!!!</p>
<p>Per recuperare una eventuale situazione di errore basterà entrare nel MES ed eseguire manualmente 'import tabelle' ed 'import ordini'</p>
<p>Ricordarsi di copiare nella dir delle dll di Business quella di Net@Pro NPAccess.dll, diversamente il collegamento con il MES fallisce! Questa dll non viene distribuita con Business, ma deve essere prelevata dall'installazione di Net@Pro</p>
<p>
<b>Scenario consigliato</b>
</p>
<p>Lo scenario consigliato è quello di far eseguire al MES l'elaborazione MRP. In alternativa si può optare per utilizzare l'MRP di Business. Se l'MRP viene eseguito dal MES, Bus importerà dal MES le proposte d'ordine. Indipendentemente da chi ha generato le proposte d'ordine, Business genererà gli ordini di produzione e ordini a fornitore (no impegni di trasferimento), poi passerà al MES gli ordini effettivamente creati.</p>
<p>Il MES si occuperà esclusivamente degli ordini di produzione interni, per cui i restati documenti/ordini vengono passati da Bus esclusivamente per fare in modo che il MES abbia gli elementi necessari per eseguire una corretta elaborazione MRP.</p>
<p>
<b>Collegamento ordini tra BUS e MES</b>
</p>
<p>Il passaggio di ordini da bus a mes avviene sempre al salvataggio/cancellazione dell'ordine (o sua evasione da documenti tipo veboll), mentre il passaggio di proposte d'odine dal MES a bus può avvenire in modo schedulato o manuale. L'aggiornamento dal MES a bus per i carichi da prod. Interni dovrebbe essere impostato per essere eseguito in modo schedulato.</p>
<p>NON VENGONO PASSATI I SEGUENTI TIPI DOCUMENTO: Preventivo, impegno di trasferimento, impegno di commessa, ordine aperto, impegno cli aperto</p>
<p>La comunicazione avviene sempre tramite la tabella FXORDERS (e sue collegate). Normalmente FXORDERS è vuota. Solo durante le operazioni di scambio dati contiene delle informazioni. Chi dovrà leggere, dopo averlo fatto cancellerà i record trattati</p>
<p>Gli ordini di tipo PRO in MES (che diventeranno proposte d'ordine in bus) arriveranno in bus solo dopo aver lanciato l'export in MES e l'import in bus. Durante questa operazione TUTTE le proposte d'ordine di bus verranno cancellate (quindi NO RDA/RDO). Una volta generate le proposte d'ordine in Bus verranno cancellate sul MES. Se sulle proposte d'ordine di MES non è indicato il magazzino verrà assunto come magazzino il numero '1' (fisso)</p>
<p>Sul MES NON DEVONO ESSERE CONVERTITI IN AUTOMATICO ORDINI IN STATO PRO a stati successivi. Questa operazione deve avvenire passando sempre per BUSINESS! E' possibile configurare il MES per bloccare il comando di 'rilascio' degli ordini in stato PRO.</p>
<p>ORDINI GIA' IN BUS : da 'Gantt ordini' c'è la possibilità non solo di generare nuove proposte d'ordine, ma anche di spostare le date di ordini già in stato REL (ovvero ordini passati da BUS a MES). Per riacquisire in bus le date modificate (OCCHIO: solo le date di consegna, non altri dati tipo qta/ anticipi/annullamenti!!!) la funzionalità è integrata in 'importa prop. D'ordine' e viene generato solo un file di LOG (per il momento). Le tabelle interessate per questa ultima problematica sono: fxprgorders, fxprgjobs e fxprgdemands</p>
<p>Visto che sul MES non c'è la possibilità di indicare un fornitore abituale nell'anagrafica articoli o sul magazzino, business in fase di creazione proposte d'ordine utilizzerà il fornitore di artico per gli ordini a fornitore e il fornitore associato al magazzino di produzione e di scarico a produzione per gli ordini di produzione.</p>
<p>Per quanto riguarda i codici lavorazione, sul MES sono delle descrizioni (non sono tabellate). In fase di creazione proposta d'ordine in Business il codice lavorazione viene ricercato in base alla descrizione (che deve coincidere tra MES e Business)</p>
<p>E' fondamentale che negli ordini di produzione del MES i materiali da impegnare provengano tutti dallo stesso magazzino (che può essere diverso dal magazzino di produzione).</p>
<p>Visto che il MES non gestisce, ad oggi, il multimagazzin, l'elaborazione MRP del MES fa produrre sempre i semilavorati/prodotti finiti sul magazzino indicato nell'anagrafica articolo del mes e consuma i materiali dal magazzino da cui dovrà uscire il prodotto finito! Business per linearizzare il tutto (in attesa di una corretta gestione del multimagazzino in MES) consumerà i materiali SEMRE dal magazzino in cui dovranno essere prodotti gli SL/PF</p>
<p>GLI ORDINI NON VANNO MAI MODIFICATI DIRETTAMENTE SUL MES, ma devono essere manipolati sempre da BUS!</p>
<p>Gli ordini di produzione interni dovranno essere avanzati principalmente dal MES.Se si cerca di modificare tale tipologia di ordini in Business viene dato più volte un messaggio non bloccante. una volta che bus li ha inviati al MES ed il mesha iniziato la produzione (status EMI e EXE) bus non potrà più manipolarli (almeno fino a quando rimangono in stato EMI e EXE).</p>
<p>Se si cancella erroneamente un ordine in MES, per ricrearlo basta semplicemente RISALVARE lo stesso ordine in Business.</p>
<p>Per eseguire un EXPORT dal MES degli avanzamenti di produzione, bisogna fare da servizi-&gt;richiesta servizi nell'ordine:</p>
<ul>
<li>CALCOLA SITUAZIONE
<li>ESPORTA TABELLE</li>
</ul>
<p>Quindi eseguire l'import dei carichi da prod interni da BNNPIENP</p>
<p>I nuovi documenti verranno creati nell'anno della data di elaborazione, con serie fissa = " "</p>
<p>Quando un ordine di prod interno risulta ultimato (totalmente evaso o meno), si dovrà agire sul mes per forzarne la chiusura utilizzando il comando 'FINE LAVORAZIONE' presente nel menu dove si fa anche l'AVANZAMENOT BOLLE. Con questo comando l'ordine passa in stato COM (e sull'ultima lavorazione in fxresults.fxcomplete viene messo 'O'). Non bisogna andare in BUS. Al momento dell'import in BUS dei documenti di produzione interni verranno chiusi anche gli ordini non totalmente evasi ma che non dovranno essere ultimati. NB: sul MES c'è anche la possibilità di riaprire un ordine chiuso. QUESTA FUNZIONALITA' NON DEVE ESSERE UTILIZZATA CON BUSINESS. Eventualmente andrà creato un nuovo ordine in BUS e passato al MES!!</p>
<p>BNVEBOLL, quando evade un ordine, segnala al MES (tramite fxorders) la quantità eseguita e se l'ordine è totalmente evaso. Se il documento di magazzino viene modificato/cancellato viene inviato a MES comunque lo status finale dell'ordine (REL o COM) e la quantità effettivamente evasa. Questo vale per tutti i documenti che evadono ordini forn, impegni cli e ordini da prod terzista. Per gli ordini da prod interni NON DEVONO ESSERE AVANZATI CON BNVEBOLL, MA POSSONO SOLO ESSERE CREATI DALL'IMPORT DATI DAL MES. Potranno però essere successivamente modificati in Bus(ma non riverseranno le modifiche sul MES!!!)</p>
<p>Al salvataggio del documento comunque non viene aggiornala l'esistenza sul MES. Per farlo dovrà essere lanciato BNNPIENP.</p>
<p>NB: Sul MES gli ordini evasi vengono cancellati dalla procedura di importazione dati!</p>
<p>
<b>Come bus gestisce, in fase di import carichi da prod, l'aggancio delle lavorazioni eseguire sul MES: </b>
</p>
<p>
<b>VISTO CHE IN BUSINESS NON C'E' UN TEMPO MACCHINA ED UN TEMPO OPERAIO, </b>
<b>BUSINESS IMPORTA DAL MES SOLO I TEMPI OPERAIO (SOMMANDOLI) ESATTAMENTE COME FA BNDBAVEX (SENZA PORTARSI DIETRO IL COD OPERAIO ED ASSUMENTO CHE OGNI OPERAIO HA UNA SUA MACCHINA.</b>
</p>
<p>
<b>In fase di import i carichi da prod realizzati in MES vengono raggruppati in import in BUS.</b>
</p>
<p>
<b>Su fxrequest vengono scritte tutte le righe di avanzamento. nel caso in cui per fare un prodotto servono 3 lavorazioni, anche se ho eseguito solo la prima il record viene scritto in fxresults mentre in fxmovements non c'è ancora scitto niente.</b>
</p>
<p>
<b>In fxmovements viene scritta la quantità prodotte ed i relativi consumi solo quando viene avanzata l'ultima fase delle 3 lavorazioni.</b>
</p>
<p>In una ipotesi dove alla fase 1 ne faccio 10 poi altri 10, alla fase 2 ne faccio 10 poi altri 10, alla fase 3 (l'ultima) ne faccio 15, poi ne rifaccio 10 alla fase 1, nelle tabelle di transito mi trovo tutte le quantità esattamente come sono state avanzate, senza indicazioni di quando sono state fatte in modo che possa sapere quali record inserire in un carico da prod e quali in un altro! 
<br>In questo caso mi vengono in aiuto le date: in fxresults è sono presenti le date di inizio e fine (FBEGIN e FEND), in fxmovements FTIMESTAMP è la data in cui è stata versata l'ultima fase (=FEND). 
<br>Nell'esempio sopra come faccio a fare la produzione di 15 pezzi e proporzionalizzare i tempi su tutte e 3 le fasi, visto che per le prime 2 sono stati passati 10 + 10 ed alla terza 15?</p>
<p>Potrei proporzionalizzare i tempi, ma nella produzione successiva (sempre che ci sia) non ho più modo di risalire alle quantità/tempi delle prime lavorazioni che non avevo conteggiati nel primo carico da produzione.</p>
<p>Il programma si comporta in questo modo: per le righe di lavorazione precedenti a quella finale, prendo le quantità fino al raggiungimento della quantità alla fase finale. se supero spezzo la riga in modo da avere delle righe con quantità prodotta = alla quantità prodotta alla fase finale, poi elaboro solo le righe che mi servono. Nelle elaborazioni successive ritratto tutte le righe che non avevo processato alla fase precedente.</p>
<p>PER OPERARE CORRETTAMENTE DAL MES LE RIGHE ESPORTATE NON DEVONO PIU' ESSERE RIESPORTATE BUS USA LA TABELLA FXRESULT COME CONTENITORE DI ATTIVITA' DA IMPORTARE.</p>
<p>PER LE RIGHE DI FXRESULTS GIA' IMPORTATE IN BUS, BUS LE CANCELLA PER ESSERE SICURO DI NON REIMPORTARLE</p>
<p>
<b>ATTENZIONE:</b> se dopo aver fatto un export tabelle per carichi da prod con qta non totalmente completata e successivamente faccio sul mes una 'chiusura lavorazioni' dovrei chiudere solo l'ordine di prod rimasto aperto, se nell'esempio sopra faccio la chisura lavorazioni con qta alla fase 1 = 30 e qta alla fase finale 20, il tempo dei 10 pezzi fatti alla fase 1 verrebbe perso/non consierato in bus. in questi casi devo fare un carico da prod con qta prodotta 0, materiali consumati 0 e tempo per lavorazioni = tempo residuo!!!!</p>
<p>il tutto solo se sono presenti lavorazioni non evase da altri carichi da prod quando viene data la 'chiusura lavorazioni'</p>
<p>
<b>ATTENZIONE:</b> SIA SU BUS CHE SU MES LE LAVORAZIONI DEVONO ESSERE LE STESSE! Se devo fare una lavorazione diversa sul mes, prima devo cambiare l'ordine di prod in bus e ripassarlo al MES (basta modificare l'ordine e risalvarlo prima di iniziare la lavorazione sul MES)</p>
<p>OVVIAMENTE i documenti esportati da mes ed importati in bus non potranno più essere reimportati in bus (perché mancano i record nelle tabelle di transito). I CP eventualmente dovranno essere cancellati e reinseriti direttamente in bus</p>
<p>
<b>
<i>
<u>Limiti noti:</u>
</i>
</b>
</p>
<ul>
<li>no articoli TCO
<li>no project management
<li>articoli: no unità di misura diverse da UMP e confezione
<li>no note di prelievo (o meglio: in bus possono essere utilizzate, ma sul MES non esiste il concetto di 'prenotato')
<li>in MES non esiste il concetto di articolo a fasi. Business passerà gli articoli a fasi come articoli normali, unendo il codice della fase al cod. articolo (ad esempio l'articolo PFF fase 1 verrà esportato su MES come 'PFF.1')
<li>in MES non sono presenti listini/sconti/codici IVA/contropartite/tipi bolle_fatture/causali di magazzino/agenti/forme di pagamento: al bisogno verranno utilizzati i codici richiesti come da procedure standard di Business o, eventualmente, da apposite opzioni di registro di Business
<li>lotti: il codice lotto non può superare i 20 caratteri
<li>codice articolo (più eventuale fase): la loro lunghezza non deve eccedere i 25 caratteri
<li>no configuratore di prodotto
<li>no c/to lavoro
<li>no RAD/RDO
<li>nelle distinte basi passate al MES vengono ignorati i filtri articolo, commessa, magazzini, cliente (in pratica la distinta base non viene 'chiusa', ma vengono passati tutti i figli e le lavorazioni collegati al padre di distinta)
<li>nelle distinte basi in Business per ogni PF/SL non è possibile indicare nella lista dei materiali che lo compongono lo stesso codice più volte
<li>valore carichi da produzione: Bus prende da MES solo quantità e tempi di produzione, no i costi, che verranno determinati in bus secondo le regole standard (mancano nelle tabelle di transito tutti i campi di costificazione). Business importa dal MES solo le lavorazioni degli operai (scarta i tempi macchina, visto che in bus non è diviso il tempo di lavorazione operaio da quello macchina).
<li>Carichi da produzione: non è gestito l'operaio di supporto: ogni operaio che inizia deve indicare alla fine la qta prodotta. (non può sospendere e 'passare' il proprio tempo ad un altro operaio)</li>
</ul>
<p>
<b>
<i>
<u>Programmi creaTI / modificaTI</u>
</i>
</b>
</p>
<p>Creato il programma di questo argomento per passare le anagrafiche, le giacenze di magazzino e ritornare le proposte d'ordine ed i carichi da prod. Interni.</p>
<p>Modificati:</p>
<ul>
<li>'genera ordini da proposte d'ordine' per ereditare il codice di fxorders.forder dalla prop. D'ordine all'ordine: in questa circostanza le proposte d'ordine con foder compilato verranno inserite in ordini DISTINTI (non raggruppati)
<li>'gestione ordini' per passare i dati al MES (insert/update/delete) al salvataggio e per bloccare modifica/cancellazione di ordini con status EXE sul MES
<li>'gestione documenti' (e programmi simili) per passare i dati a MES di evasione ordini
<li>'programma di liste di produzione' per far operare come la gestione ordini con MES</li>
</ul>
<p>
<b>
<i>
<u>Dettagli sulle operazioni di integrazione dati</u>
</i>
</b>
</p>
<p>La procedura di import/export verso MES non deve essere lanciata da più utenti in contemporanea sullo stesso database / ditta (Il programma per il passaggio della anagrafiche ed il ritorno dei carichi da prod. Interni è: BNNPIENP)</p>
<p>Se Business rileva degli errori in fase di passaggio dati ma non è evidenziato il messaggio di errore, va configurato opportunamente il file FDCS.INI di mes per alimentare i messaggi di errore</p>
<p>
<b>Articoli</b>
</p>
<p>Vengono passati al MES solo gli articoli con flag 'stampa inventario' (quindi no i descrittivi), senza gestione ubicazioni dinamiche, TCO, matricole. Eventuali articoli cancellati in Bus dovranno essere cancellati manualmente in MES. Delle unità di misura presenti in Business, al MES viene passata solo la principale e la secondaria (confezione). Nell'anagrafica degli articoli di BUS deve essere indicato il magazzino di stock: questo è fondamentale perché il MES, per effettuare l'elaborazione MRP/pianificazione se deve generare dei documenti di carico/scarico lo farà utilizzando come magazzino quello di artico.ar_magstock! (in futuro  si spera a breve nella tabella di transito della DB potrà venir passato anche il magazzino da cui prelevare il materiale). Se il magazzino di stock è 0 nell'export viene passato il cod. magazzino 1 (fisso)</p>
<p>
<b>Clienti/fornitori</b>
</p>
<p>Vengono passati sempre tutti i clienti e fornitori di Business.</p>
<p>Eventuali clienti/fornitori cancellati in Bus dovranno essere cancellati manualmente in MES</p>
<p>
<b>Distinte basi</b>
</p>
<p>Vengono passate tutte le distinte basi a tutte le date di validità. Visto che in Business è possibile associare ad un articolo una distinta base diversa, le DB vengono passate utilizzando i codici articoli effettivi, e non quelli della DB generica (articolo PF1 collegato alla DB PF, viene passato come codice DB PF1).Per quanto riguarda i materiali, non vengono passate informazioni relative a magazzino, ulteriore magazzino, provenienza, ma solo articolo, fase, quantità, sfrido. Per quanto riguarda la quantità dei materiali da consumare, visto che su MES non esiste il campo 'per pezzi', la qta viene passata divisa per il 'per pezzi' di business.</p>
<p>
<b>Giacenze di magazzino</b>
</p>
<p>Vengono passate tutte le giacenze attuali degli articoli di magazzino raggruppate per articolo, fase, magazzino, lotto</p>
<p>NB: nel caso di errori in fase di import dati dal MES, non sarà possibile rieseguire altri passaggi di dati fino a quando gli errori non sono stati corretti. Al momento per riabilitare l'export è possibile utilizzare l'apposita voce di menu (anche se prima andrebbero corretti gli errori!!!!).</p>
<p>
<b>Per importare manualmente le anagrafiche su MES</b>
</p>
<p>Configurare il server di MES tramite il file FDCS.INI</p>
<p>Nel client, andare in SERVIZI-&gt;richiesta servizi-&gt;importa tabelle e selezionare 'esecuzione', quindi uscire.</p>
<p>La procedura viene avviata come servizio, per cui la procedura di import non è visibile. Dopo un po' andare nelle anagrafiche per verificare se i dati sono stati importati correttamente.</p>
<p>
<b>Per esportare gli ordini da MES per poi essere caricati in BUS</b>
</p>
<p>Si opera come per importare in MES le anagrafiche di Business, ma si seleziona la voce EXPORT TABELLE (deve preventivamente essere configurato per esportare gli ordini da Net@Pro<A name=_GoBack>
</A>)</p>
<p>
<b>Per esportare dal MES i carichi da produzione interni</b>
</p>
<p>effettuare nell'ordine:</p>
<ul>
<li>SERVIZI-&gt;RICHIESTA SERVIZI-&gt;CALCOLA SITUAZIONE
<li>SERVIZI-&gt;RICHIESTA SERVIZI-&gt;ESPORTA TABELLE</li>
</ul>
<p>(verranno alimentate fxmovements per materiali caricati e consumati e fxresults per lavorazioni eseguite)</p>
<p>
<b>Per importare sul MES gli ordini/impegni di Business</b>
</p>
<p>Si opera come per importare in MES le anagrafiche di Business, ma si seleziona la voce IMPORT ORDINI</p>
<p>
<b>
<i>
<u>CARICHI DA PROD DA NET@PRO: CASI TESTATI</u>
</i>
</b>
</p>
<p>
<b>TEST DI MATERIALI</b>
</p>
<p>I casi sono molto semplici, per cui la qta caricata e scaricata girano correttamente in base a come vengono eseguite le operazioni sul MES. Gestito anche il caso di carichi con QTA negativa per eventuali rettifiche nel caso in cui l'operatore abbia inizialmente indicato una qta versata superiore al reale.</p>
<p>Scarti (ovvero consumo maggiore di scarichi): sul mes devono essere gestiti come prelievo superiore di materiale rispetto a quello che verrà prodotto.</p>
<p>
<b>TEST SU LAVORAZIONI</b>
</p>
<p>Qta ordinata 10 con una unica lavorazione, evasa con:</p>
<ul>
<li>uno start + stop per attrezzaggio su operaio 1
<li>uno start per inizio lavorazione
<li>una bolla di avanzamento di 5 pezzi
<li>una bolla di avanzamento di 5 pezzi
<li>chiusura lavorazione
<li>export ed import in bus: OK</li>
</ul>
<p>Qta ordinata 10 con una unica lavorazione, evasa con:</p>
<ul>
<li>uno start per inizio lavorazione su op1
<li>sospensione op 1
<li>ripresa op 1
<li>una bolla di avanzamento di 4 pezzi su op 1
<li>export ed import in bus: OK
<li>una bolla di avanzamento di 5 pezzi su op 1
<li>chiusura lavorazione su op 1
<li>export ed import in bus: OK</li>
</ul>
<p>Qta ordinata 10 con una unica lavorazione, evasa con:</p>
<ul>
<li>attrezzaggio: uno start su op 1 ed uno su op 2 ed uno stop su op 1 (che chiude anche op2)
<li>uno start per inizio lavorazione su op1
<li>uno start per inizio lavorazione su op2
<li>una bolla di avanzamento di 4 pezzi su op 1
<li>una bolla di avanzamento di 5 pezzi su op 2
<li>chiusura lavorazione su op 1
<li>export ed import in bus: OK</li>
</ul>
<p>Qta ordinata 10 con una unica lavorazione, evasa con:</p>
<ul>
<li>uno start per inizio lavorazione su op1
<li>uno start per inizio lavorazione su op2
<li>sospensione op 1
<li>sospensione op 2
<li>ripresa op 1
<li>ripresa op 2
<li>export ed import in bus: OK
<li>una bolla di avanzamento di 4 pezzi su op 1
<li>export ed import in bus: OK
<li>una bolla di avanzamento di 5 pezzi su op 2
<li>chiusura lavorazione su op 2
<li>export ed import in bus: OK</li>
</ul>
<p>Qta ordinata 50 con 2 lavorazioni, evasa con:</p>
<ul>
<li>uno start + stop per attrezzaggio su operaio 1 lav 1
<li>uno start per inizio lavorazione 1
<li>una bolla di avanzamento di 15 pezzi lav 1 
<br>una bolla di avanzamento di 15 pezzi lav 1
<li>export ed import in bus
<li>uno start + stop per attrezzaggio su operaio 2 lav 2
<li>uno start per inizio lavorazione 2
<li>una bolla di avanzamento di 20 pezzi lav 2
<li>export ed import in bus
<li>una bolla di avanzamento di 15 pezzi lav 1
<li>chiusura lavorazione
<li>export ed import in bus: OK
<li>una bolla di avanzamento di 20 pezzi lav 2
<li>chiusura lavorazione
<li>export ed import in bus: OK</li>
</ul>
</TD></TR></TABLE><TABLE border=0 cellSpacing=0 cellPadding=0><TR><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/software-retail-negozi/"><IMG border=0 src="../images/help_home_01_Gestisci.gif"></A></TD><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/controllo-di-gestione/"><IMG border=0 src="../images/help_home_02_Controlla.gif"></A></TD><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/crm/"><IMG border=0 src="../images/help_home_03_Fidelizza.gif"></A></TD><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/analisi-dati-datawarehouse/"><IMG border=0 src="../images/help_home_04_DWH.gif"></A></TD><TD vAlign=center width=169 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/project-management/"><IMG border=0 src="../images/help_home_05_Gestisci.gif"></A></TD><TD vAlign=center width=146 align=right><IMG border=0 src="../images/help_home_NTS_logo_up.gif"></TD></TR><TR><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/logistica/"><IMG border=0 src="../images/help_home_06_Organizza.gif"></A></TD><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/customer-service/"><IMG border=0 src="../images/help_home_07_Gestisci.gif"></A></TD><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/produzione/"><IMG border=0 src="../images/help_home_08_Pianifica.gif"></A></TD><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/archiviazione-documenti/"><IMG border=0 src="../images/help_home_09_Archivia.gif"></A></TD><TD vAlign=center width=169 align=right><IMG border=0 src="../images/help_home_NTS_logo_down1.gif"></TD><TD vAlign=center width=146 align=right><A href="http://www.ntsinformatica.it"><IMG border=0 alt="Clicca per accedere al sito di NTS Informatica" src="../images/help_home_NTS_logo_down2.gif"></A></TD></TR><TR><TD width=987 colSpan=6><IMG border=0 src="../images/help_home_Line.gif"></TD></TR></TABLE></body></html>