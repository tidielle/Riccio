<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3c.org/TR/1999/REC-html401-19991224/loose.dtd">
<html>
<head>
<title> AM: Creazione ed utilizzo di un nuovo profilo Import/Export</title>
<LINK rel=stylesheet type=text/css href="style_topic.css">
<SCRIPT LANGUAGE="JavaScript">
<!-- Begin
loadImage1 = new Image();
loadImage1.src = "../images/help_home_Button_01_Roll-over.gif";
staticImage1 = new Image();
staticImage1.src = "../images/help_home_Button_01_Roll-out.gif";

loadImage2 = new Image();
loadImage2.src = "../images/help_home_Button_02_Roll-over.gif";
staticImage2 = new Image();
staticImage2.src = "../images/help_home_Button_02_Roll-out.gif";

loadImage3 = new Image();
loadImage3.src = "../images/help_home_Button_03_Roll-over.gif";
staticImage3 = new Image();
staticImage3.src = "../images/help_home_Button_03_Roll-out.gif";

loadImage4 = new Image();
loadImage4.src = "../images/help_home_Button_04_Roll-over.gif";
staticImage4 = new Image();
staticImage4.src = "../images/help_home_Button_04_Roll-out.gif";

// End -->
</SCRIPT>

</head>
<body lang=it topMargin=3>
<TABLE border=0 width=987><TR><TD vAlign=top align=right><p><FONT size=2><CODE>Data ultimo aggiornamento: <A name=hINIeDATlAGGp></A>23/11/2012</FONT><A name=hFINeDATlAGGp></A></CODE></p></TD></TR></TABLE><TABLE border=0 cellSpacing=0><TR><TD colSpan=4><A href="http://www.ntsinformatica.it"><IMG border=0 alt="Clicca per accedere al sito di NTS Informatica" src="../images/help_home_banner.gif"></A></TD></TR></TABLE><TABLE border=0 cellSpacing=0 cellPadding=0><TR><TD align=left><A onmouseover="image1.src=loadImage1.src;" onmouseout="image1.src=staticImage1.src;" href="cose.htm"><IMG border=0 name=image1 alt="Clicca per accedere all'argomento" src="../images/help_home_Button_01_Roll-out.gif"></A></TD><TD align=middle><A onmouseover="image2.src=loadImage2.src;" onmouseout="image2.src=staticImage2.src;" href="pc.htm"><IMG border=0 name=image2 alt="Clicca per accedere all'argomento" src="../images/help_home_Button_02_Roll-out.gif"></A></TD><TD align=middle><A href="ambsargmod.htm"><IMG border=0 name=image3 alt="Clicca per accedere all'argomento" src="../images/help_home_Button_03_Roll-over.gif"></A></TD><TD align=right><A onmouseover="image4.src=loadImage4.src;" onmouseout="image4.src=staticImage4.src;" href="gaguidaan.htm"><IMG border=0 name=image4 alt="Clicca per accedere all'argomento" src="../images/help_home_Button_04_Roll-out.gif"></A></TD></TR><TR><TD colSpan=4><A href="http://www.ntsinformatica.it"><IMG border=0 alt="Clicca per accedere al sito di NTS Informatica" src="../images/help_home_Button_03_Roll-over-row.gif"></A></TD></TR><TR><TD bgColor=#009ee2 height=53 vAlign=center width=987 colSpan=4 align=left><p><FONT class=title color=white size=6><b>Creazione ed utilizzo di un nuovo profilo Import/Export</b></FONT></p></TD></TR><TR><TD vAlign=center colSpan=4 align=left></TD></TR></TABLE><TABLE border=0 width=987><TR><TD><p>Per poter utilizzare lo strumento di import/export, occorre precedentemente impostare alcune tabelle,al fine di poter dire alla procedura quali sono i dati da importare/esportare, come eseguire l'operazione, dove anadarli a salvare. Le fasi da seguire sono i seguenti:</p><p><b><A name=Creazionedelpro>Creazione del profilo di import/export:</A></b></p><p>Innanzitutto occorre creare un profilo, ovvero dare un nome alla procedura che andremo a costruire (ex: Importazione anagrafica clienti/fornitori, Esportazione documenti di magazzino, ecc.)</p><p>Il programma da utilizzare è DEFINIZIONE PROFILI DI IMPORT/EXPORT, dove occorre inserire un nuovo record indicando un numero di profilo (superiore a 1000), una descrizione ed indicare se si riferisce ad una operazione di importazione o di esportazione.</p><p><b><A name=Definizionedell>Definizione dello schema delle tabelle esterne:</A></b></p><p>Una volta creato il profilo, occorre impostare lo schema di come i dati sono organizzati nel file di importazione, oppure di come devono essere salvati in fase di esportazione. Il programma da utilizzare è DEFINIZIONE SCHEMA TABELLE ESTERNE, ed è suddiviso in 2 sezione:</p><ul><li>nell'ELENCO TABELLE troveremo tutte le tabelle già dichiarate/utilizzate da altri profili; in coda andremo ad aggiungere un nuovo record relativo al file che dovremo andare a gestire. In fase di esportazione, allo stato attuale, è possibile utilizzare come tipo tabelle solo ASCII TEXT FILE e Jet di tipo Microsoft Access. I valori da dover andare a riempire sono : <p><I>nome tabella</I> (nome che verrà utilizzato da Business per riferirsi al nostro file)<br><I>nome file</I> (nome del file esterno da creare).</p><p>In fase di importazione il formati accettati sono Microsoft Access e JET ISAM TEXT. Mentre per il primo non è necessario impostare altre informazioni oltre al nome tabella e nome file, per il secondo occorre definire:<br>l'impostazione del tipo di campi = può essere o <I>FixedLength </I>(i campi del file sono tutti a lunghezza fissa) o una delle altre opzioni (i campi della tabella sono delimitati da un apposito carattere)). In fase di importazione, oltre ai campi sopra indicati, occorre andare a specificare anche:</p><p><I>Proprietà CollNameHeader =False, </I><br><I>Proprietà MaxScanRows = 0, </I><br><I>Proprietà CharacterSet = OEM, </I><br><I>Proprietà NumberLeadingZeros = 1,</I><br><I>Formato data/ora = </I>il formato con cui è stata espressa la data nel file di importazione (ex: ddmmyyyy )</p><li>nell'ELENCO CAMPI troveremo tutte le informazioni relative ad ogni singolo campo del file,per cui <I>Ordinamento =</I> ordine con cui appaiono i campi del file, <I>Nome Campo = </I>nome che verrà utilizzato da Business per riferirsi a quel campo specifico, <I>Tipo campo = </I>tipo di dato contenuto in quel campo (in esportazione sempre CHAR), <I>Dimensione = </I>lunghezza del campo per i file a campi a lunghezza fissa, per i file con campi al unghezza variabile un qualsiasi valore diverso da 0. Come primo record è consigliabile inserire un campo così definito: ordinamento = 0, nome campo = (Nessuno), tipo campo = Char, dimensione = 0. Gli altri campi nella tabella sono utilizzati solo per file esterni di tipo Microsoft Access e permettono di impostare le caratteristiche di ogni singolo campo.</li></ul><p>N.B.: per i tracciati su file MSACCESS non occorre definire una tabella esterna per l'import ed una per l'export: un solo schema tabella esterna può essere utilizzato sia per import che per export.</p><p><b><A name=Standardutilizz>Standard utilizzati in esportazione dati su file ASCII</A></b></p><p>Nella codifica dei profili standard 'Business import' e 'Business export' sono stati utilizzati i seguenti standard:</p><ul><li>I campi <I>stringa</I> vengono esportati integralmente, per la totale lunghezza (tipo campo <I>Char</I>). <li>I campi <I>memo</I> vengono esportati come stringhe della lunghezza massima di 100 caratteri (i successivi verranno trovati in esportazione) con tipo campo <I>Char</I>. <li>I campi <I>data</I> vengono esportati come stringa di 8 (con format <I>ddmmyyyy</I>) oppure 14 (con format <I>ddmmyyyyhhnnss</I>) a seconda del fatto che sia significativo l'orario all'interno del campo data; in esportazione il tipo campo è <I>Char</I>, in importazione il tipo campo è <I>Datetime</I>. Nella colonna 'Formato Data/Ora' nella definizione della tabella esterna, in importazione deve essere riportata la stringa di formattazione corrispondente: pertando all'interno della stessa tabella si può definire un solo tipo di campo data ora (o da 8 o da 14). <li>I campi numerici <I>interi</I> vengono esportati come stringa di 4 caratteri, senza alcuna formattazione; in esportazione il tipo campo è <I>Char</I>, in importazione il tipo campo è <I>Short</I>. <li>I campi numerici <I>interi lunghi</I> vengono esportati come stringhe di 9 caratteri, senza alcuna formattazione; in esportazione il tipo campo è <I>Char</I>, in importazione il tipo campo è <I>Long</I>. <li>I campi numerici <I>valuta</I> vengono esportati come stringa di 17 caratteri: <ul><li>la cui stringa di formattazione è <I>000000000000.0000;-00000000000.0000</I> per i <U>campi prezzo</U> che possono contenere anche 4 decimali (i valori esportati pertanto saranno tra -99.999.999.999,9999 e 999.999.999.999,9999); <li>senza stringa di formattazione se si tratta di <U>campi valore monetario</U> dove implicitamente vengono salvati 2 decimali (i valori esportati pertanto saranno tra -9.999.999.999.999,99 e 99.999.999.999.999,99);</li></ul>in esportazione il tipo di campo è <I>Char</I>, in importazione il tipo di campo è <I>Double</I>. <li>I campi numerici a <I>precisione doppia</I> o <I>singola</I> vengono esportati come: <ul><li>stringa di 15 caratteri, se si tratta di <U>campo quantità</U>, la cui stringa di formattazione è <I>00000000000.000;-0000000000.000</I> in modo da conservare 3 decimali sulle quantità (i valori esportati pertanto saranno tra -9.999.999.999,999 e 99.999.999.999,999); <li>stringa di 6 caratteri, se si tratta di <U>campo percentuale</U>, la cui stringa di formattazione è <I>000.00;-00.00</I> in modo da conservare 2 decimali sulle percentuali (i valori esportati pertanto saranno tra -99,99% e 100,00%); <li>stringa di 15 caratteri, se si tratta di <U>campo cambio</U>, la cui stringa di formattazione è <I>00000.000000000;-0000.000000000</I> in modo da conservare 9 decimali sui valori cambio delle valute (i valori esportati pertanto saranno tra -9.999,999999999 e 99999,999999999 anche se comunque saranno sempre valori positivi); <li>stringa di 15 caratteri, se si tratta di <U>campo tempi</U>, la cui stringa di formattazione è <I>0000000000.0000;-000000000.0000</I> in modo da conservare 4 decimali sui tempi (i valori esportati pertanto saranno tra -999.999.999,9999 e 9.999.999.999,9999);</li></ul>in esportazione il tipo campo è <I>Char</I>, in importazione il tipo campo è <I>Double</I>.</li></ul><p><b><A name=Impostazionedel>Impostazione dello strumento di import/export:</A></b></p><p>A questo punto occorre andare a definire un legame tra i campi di Business e quelli del file esterno. Il programma da utilizzare è IMPOSTAZIONE IMPORT/EXPORT; le fasi da seguire sono:</p><ul><li>Profilo: selezionare il profilo a cui agganciare le tabelle da trattare (quello creato in precedenza come primo steps) <li>nella CORRISPONDENZA TABELLE occorre specificare a quale tabella di Business deve essere legata la tabella esterna (<I>tabella Business - tabella esterna)</I> , l'ordinamento da seguire per riempire le tabelle, se la tabella di Business è contenuta nell archivio Procedura o nell'archivio Azienda,e tutta una serie di informazioni legate al trattamento delle tabelle in quanto tali (ex: se segnalare l'assenza di record da trattare, se i dati da importate/esportare sono da accodarsi a quelli esistenti o da sostituirli, se in fase di esportazione deve venir proposta una schermata dove porter inserire dei filtri al fine di selezionare i dati da esportate, se eseguire delle procedure dopo aver letto/scritto i dati ecc.). <li>nella CORRISPONDEZA CAMPI si indicheranno, per ogni tabella di Business selezionata, i rispettivi valori dei files esterni. (N.B.: per i profili di esportazione, l'ordinamento con cui verrannno salvati i dati è quello indicato in questa tabella, non quello indicato in Schema tabelle esterne!!!). Le altre colonne possono venir utilizzate qualora il dato da importare/esportare deve essere trattato prima di venir memorizzato (ex: il valore può essere moltiplicato, diviso, convertito in un altro oppure essere la risultante di una procedura). <li>qualora alcune delle tabelle indicate in corrispondenza tabelle siano legate da vincoli di integrità referenziale (oppure abbiano campi comuni che permettano il loro aggiornamento in contemporanea), la cartella RELAZIONI TABELLE permette di collegare due o più tabelle tra di loro in modo che ad ogni lettura di un record, la procedura provveda ad aggiornare non solo la tabella direttamente, ma esegua l'aggiornamento anche delle tabelle legate dalle relazioni tabelle. I campi da compilarsi sono <I>Tabella di Business, tabella esterna, ordine di relazione e tempo di valutazione </I>(scegliere se l'analisideve essere fatta prima o dopo la scrittura del record). <li>se sono state indicate delle relazioni tra tabelle nella cartella precedente, occorre compilare anche RELAZIONE CAMPI, dove andremo ad indicare, per ogni tabella in relazione con quella di Business, i campi (sia di Business che della tabella esterna) che legano le due tabelle in analisi.</li></ul><p><b><A name=Transcodificade>Transcodifica dei campi:</A></b></p><p>Da utilizzarsi qualora i campi trattati dall'import/export debbano essere tradotti in valori diversi (e comunque conosciuti a priori). è possibile con DEFINIZIONE TRANSCODIFICA CAMPI andare ad inserire tante tipologie di transcodifica, ed assegnare ad ognuna di esse dei valori in ingresso ed il relativo valore in uscita (ex: convertire i valori in input 0/1 in S/N). Per poter poi richiamare tali procedure occorre andare in impostazione import/export - corrispondeza campi e: spuntare il flag 'TRANSCODIFICA' ed indicare il codice della transcodifica da utilizzare.</p><p><b><A name=Definizionedipr>Definizione di procedure:</A></b></p><p>Qualora occorra far eseguire delle procedura prima, durante o dopo l'operazione di import/export, oppure manipolare i dati trattati in maniera diversa da quella che può essere una transcodifica (ex: convertire una data da aammgg in ggmmaa) è possibile scrivere delle procedure e dichiarare in impostazione import/export in corrispondenza tabelle piuttosto che in corrispondeza campi il codice della funzione da eseguire (in precedenza occorre aver spuntato in corrispondenza tabelle il flag 'USA SCRIPT ENGINE'. Il programma per poter andare a scrivere queste procedure è DEFINIZIONE PROCEDURE DI IMPORT/EXPORT.</p><p>Una volta creato un nuovo profilo, è possibile utilizzarlo mediante lo STRUMENTO DI IMPORT/EXPORT oppure schedulare l'importazione /esportazione in modo che avvenga in automatico ad intervalli preimpostati (vedi in merito la guida analitica sullo 'Strumentodi import/export').</p><p>N.B.: I campi descritti sono quelli normalmente utilizzati per profili standard. Per ulteriori informazioni ed approfondimenti in merito ai programmi ed ai campi, rimandiamo ai capitoli specifici nella sezione GUIDA ANALITICA.</p></TD></TR></TABLE><TABLE border=0 cellSpacing=0 cellPadding=0><TR><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/software-retail-negozi/"><IMG border=0 src="../images/help_home_01_Gestisci.gif"></A></TD><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/controllo-di-gestione/"><IMG border=0 src="../images/help_home_02_Controlla.gif"></A></TD><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/crm/"><IMG border=0 src="../images/help_home_03_Fidelizza.gif"></A></TD><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/analisi-dati-datawarehouse/"><IMG border=0 src="../images/help_home_04_DWH.gif"></A></TD><TD vAlign=center width=169 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/project-management/"><IMG border=0 src="../images/help_home_05_Gestisci.gif"></A></TD><TD vAlign=center width=146 align=right><IMG border=0 src="../images/help_home_NTS_logo_up.gif"></TD></TR><TR><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/logistica/"><IMG border=0 src="../images/help_home_06_Organizza.gif"></A></TD><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/customer-service/"><IMG border=0 src="../images/help_home_07_Gestisci.gif"></A></TD><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/produzione/"><IMG border=0 src="../images/help_home_08_Pianifica.gif"></A></TD><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/archiviazione-documenti/"><IMG border=0 src="../images/help_home_09_Archivia.gif"></A></TD><TD vAlign=center width=169 align=right><IMG border=0 src="../images/help_home_NTS_logo_down1.gif"></TD><TD vAlign=center width=146 align=right><A href="http://www.ntsinformatica.it"><IMG border=0 alt="Clicca per accedere al sito di NTS Informatica" src="../images/help_home_NTS_logo_down2.gif"></A></TD></TR><TR><TD width=987 colSpan=6><IMG border=0 src="../images/help_home_Line.gif"></TD></TR></TABLE></body></html>