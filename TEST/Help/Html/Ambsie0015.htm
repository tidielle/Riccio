<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3c.org/TR/1999/REC-html401-19991224/loose.dtd">
<html>
<head>
<title> AM: Profilo 15 - Sarema (RTS Eng.)</title>
<LINK rel=stylesheet type=text/css href="style_topic.css">
<SCRIPT LANGUAGE="JavaScript">
<!-- Begin
loadImage1 = new Image();
loadImage1.src = "../images/help_home_Button_01_Roll-over.gif";
staticImage1 = new Image();
staticImage1.src = "../images/help_home_Button_01_Roll-out.gif";

loadImage2 = new Image();
loadImage2.src = "../images/help_home_Button_02_Roll-over.gif";
staticImage2 = new Image();
staticImage2.src = "../images/help_home_Button_02_Roll-out.gif";

loadImage3 = new Image();
loadImage3.src = "../images/help_home_Button_03_Roll-over.gif";
staticImage3 = new Image();
staticImage3.src = "../images/help_home_Button_03_Roll-out.gif";

loadImage4 = new Image();
loadImage4.src = "../images/help_home_Button_04_Roll-over.gif";
staticImage4 = new Image();
staticImage4.src = "../images/help_home_Button_04_Roll-out.gif";

// End -->
</SCRIPT>

</head>
<body lang=it topMargin=3>
<TABLE border=0 width=987><TR><TD vAlign=top align=right><p><FONT size=2><CODE>Data ultimo aggiornamento: <A name=hINIeDATlAGGp></A>23/11/2012</FONT><A name=hFINeDATlAGGp></A></CODE></p></TD></TR></TABLE><TABLE border=0 cellSpacing=0><TR><TD colSpan=4><A href="http://www.ntsinformatica.it"><IMG border=0 alt="Clicca per accedere al sito di NTS Informatica" src="../images/help_home_banner.gif"></A></TD></TR></TABLE><TABLE border=0 cellSpacing=0 cellPadding=0><TR><TD align=left><A onmouseover="image1.src=loadImage1.src;" onmouseout="image1.src=staticImage1.src;" href="cose.htm"><IMG border=0 name=image1 alt="Clicca per accedere all'argomento" src="../images/help_home_Button_01_Roll-out.gif"></A></TD><TD align=middle><A onmouseover="image2.src=loadImage2.src;" onmouseout="image2.src=staticImage2.src;" href="pc.htm"><IMG border=0 name=image2 alt="Clicca per accedere all'argomento" src="../images/help_home_Button_02_Roll-out.gif"></A></TD><TD align=middle><A href="ambsargmod.htm"><IMG border=0 name=image3 alt="Clicca per accedere all'argomento" src="../images/help_home_Button_03_Roll-over.gif"></A></TD><TD align=right><A onmouseover="image4.src=loadImage4.src;" onmouseout="image4.src=staticImage4.src;" href="gaguidaan.htm"><IMG border=0 name=image4 alt="Clicca per accedere all'argomento" src="../images/help_home_Button_04_Roll-out.gif"></A></TD></TR><TR><TD colSpan=4><A href="http://www.ntsinformatica.it"><IMG border=0 alt="Clicca per accedere al sito di NTS Informatica" src="../images/help_home_Button_03_Roll-over-row.gif"></A></TD></TR><TR><TD bgColor=#009ee2 height=53 vAlign=center width=987 colSpan=4 align=left><p><FONT class=title color=white size=6><b>Profilo 15 - Sarema (RTS Eng.)</b></FONT></p></TD></TR><TR><TD vAlign=center colSpan=4 align=left></TD></TR></TABLE><TABLE border=0 width=987><TR><TD><p>Questo profilo permette la generazione di un file di testo da inviare al registraztore di cassa. Il profilo non deve essere chiamato direttamente dal programma <A href="bsieimpo.htm">Strumento di Import/Export</A>, ma è utilizzato dai programmi <A href="bsveboll.htm">Gestione documenti di Magazzino</A> e Gestione Unificata Documenti al momento della stampa su registratore di cassa.</p><p>A seguire sono indicate le specifiche di esportazione del file con i dati dello scontrino in SAREMA Language: <ol><li>E' possibile generare il file SOLO per i corrispettivi con prezzi ivati (scorporo). <li>Sono scartate le righe con quantità o prezzo pari a zero. <li>Sono scartate le righe SUBTOTALE indicate nel corpo del RETAIL. <li>Sono scartate (e segnalate con un messaggio) le righe con 1 o più percentuali di sconto minori di zero (maggiorazioni) inclusi gli sconti di testata/piede. <li>Sono scartate (e segnalate con un messaggio) le righe con prezzi minori di zero. <li>Sono scartate (e segnalate con un messaggio) le righe con quantità maffiori di 9999 non supportate dai reg. di cassa. <li>Non sono gestiti i moltiplicatori prezzi/qtà. <li>Gli abbuoni finanziari di piede NON sono supportati nel programma <A href="bsregdoc.htm">Gestione unificata documenti</A> (Retail), sono invece disponibili in <A href="bsveboll.htm">Gestione documenti di Magazzino</A>, trattati dai registratori come sconti a valore sul totale, non sono comunque gestiti abbuoni negativi. <li>Tutte le righe con quantità minore di zero sono considerare come RESI. <li>Non è ammessa (e segnalata con un messaggio) la generazione del file dello scontrino relativa a corrispettivi con totali negativi (ad esempio righe di solo RESO). <li>Come reparto sullo scontrino viene indicato il codice inserito sul campo "Reparto ECR" indicato in anagrafica articoli, oppure il codice fisso 1 qualora sia presente zero sull'articolo. <li>Qualora nella riga siano indicati più di uno sconto (tenendo conto anche degli sconti di testata/piede che comunque vengono sempre applicati sul valore della riga), lo sconto viene esposto sullo scontrino come SCONTO A VALORE di riga (direttiva COPU,V del Sarema Language) questo per far si che l'ammontare della vendita sullo scontrino corrisponda a quello di Business, visto che sui registratori di cassa è ammessa solo una % di sconto e anche il passaggio sullo scontrino dello sconto applicato (come avveniva nelle precedenti versioni del profilo) porta a inevitabili differenze dovute ad arrotondamenti. <li>Solo se sulla riga è presente UNO dei 9 sconti possibili (6 di riga e 3 di testata/piede) questo è esposto sul reg. di cassa come SCONTO IN PERCENTUALE di riga (direttiva DISC,%). <li>Le righe di Abbuono e Sconto indicate nel Retail (righe descrittive con q.tà -1 e Prezzo pari all'importo in valore dell'abbuono/sconto) sono esposte sullo scontrino come SCONTI A VALORE di riga (direttica COUP,V). <li>Alcuni registratori di cassa non ammetto che siano indicati più righe di SCONTI A VALORE consecutive, in tali casi non si possono indicare consecutivamente sconti combinati (più di 1 % in cascata), Abbuoni e Sconti del Retail. <li>L'ordine con cui le righe di articoli sono esposte nello scontrino è basato sul numeratore di riga. <li>Alcuni registratori non ammettono che le righe di reso siano indicate come righe iniziali dello scontrino. In tal caso devono essere inserite in fondo (tenendo conto di quanto indicato al punto 10).</li></ol><p><b><U><I>Modalità di collegamento ai registratori di cassa SAREMA</I></U></b></p><p>Per i modelli di registratori di cassa SAREMA è disponibile un programma di collegamento "WPOS1", da acquistare a parte, realizzato dalla RTS Engineering di Bologna (<A href="http://www.rtseng.it">www.rtseng.it</A>), che provvede all'invio dei dati prodotti dal gestionale (il file ASCII in formato Sarema Language) al registratore fisicamente collegato al PC tramite la porta seriale. L'RTS ha reso disponibile programmi di collegamento con altre marche/modelli di registratori di cassa, che fanno uso sempre in input del file ASCII in formato Sarema Language generato da Business. Contattare la RTS per ulteriori informazioni. Esistono comunque tanti programmi WPOS1 quanti sono i modelli di registratori supportati.</p><p><b><A name=Specifichedifun>Specifiche di funzionamento</A></b></p><p>Sono disponibili 2 modalità per la creazione del file, con i dati dello scontrino, in Sarema Language per il registratore di cassa: a) il profilo import/export standard di codice 15; b) una modalità diretta, interna ai programmi <A href="bsveboll.htm">Gestione documenti di Magazzino</A> e <A href="bsregdoc.htm">Gestione Unificata Documenti</A>, a partire dalla 12.0 Sr1. Le 2 modalità producono un file delle medesime caratteristiche.</p><ol><li>Per configurare il collegamento col registratore di cassa mediante l'uso del profilo di import/export, procedere nel seguente modo: <ol><li>Installare il programma WPOS1 della RTS nella cartella di default proposta che è <I>C:\programmi\RTS Wpos1</I>. <li>Creare con il Blocco note (Notepad) un file di nome <I>SR_STARX.001</I> contenente la password fornita da RTS e salvarlo nella cartella di installazione come sopra indicato (ad esempio <I>C:\Programma\RTS Wpos1</I>). Tale file viene poi copiato e rinominato dal profilo di esportazione in <I>SR_START.001</I>, una sorta di file "semaforo" per far partire il processo di stampa dello scontrino i cui dati Business li inserisce nel file <I>SR_DATI.001</I> (consultare comunque la documentazione fornita con il programma WPOS1 per informazioni più dettagliate).<br><b>Attenzione!</b> Se si crea il file con il Notepad e le cartelle di Windows nascondono le estensioni dei file, controllare che il file non venga salvato con nome SR_STARX.001.TXT, file che ovviamente non verrà riconosciuto. <li>Qualora il programma WPOS1 venga installato in una cartella diversa da <I>C:\Programmi\RTS Wpos1</I> entrare attraverso il programma <A href="bsieproc.htm">8-6 Definizione procedure import/export</A> nel corpo della procedura 35 "SaremaRTS1" e modificare il percorso nei 3 punti dove è menzionato. <li>Qualora il registratore di cassa sia collegato su una porta seriale diversa dalla COM1 modificare, dal programma <A href="bsiesctb.htm">8-4 Definizione schema tabelle esterne</A>, il nome file della tabella BLSarema1Sr da <I>SR_DATI.001</I> a <I>SR_DATI.002</I> (se si opera, ad esempio, sulla COM2); dal programma <A href="bsieproc.htm">8-6 Definizione procedure import/export</A> nel corpo della procedura 35 "SaremaRTS1" modificare le estensioni dei file da <I>.001</I> a <I>.002</I>. <li>Impostare nel registro di Business, nella cartella <I>\Bsveboll\Opzioni</I> le seguenti proprietà: <p><IMG src="../images/help_bsiepr15_1.gif"></p><p>Su alcuni sistemi operativi sono emersi problemi di tipo prestazionale, ossia degradazione delle performances di stampa dello scontrino dopo i primi 100 scontrini/corrispettivi realizzati circa. Ciò sembra essere dovuto a consumi di memoria eccessivi (memory leak) dei componenti di scripting di Microsoft di cui i profili import/export fanno uso. In tali situazione si può fare uso della modalità b) sotto descritta.</p></li></ol><li>Per configurare il collegamento col registratore di cassa nella modalità diretta, procedere nel seguente modo: <ol><li>Installare il programma WPOS1 della RTS nella cartella di default proposta che è <I>C:\programmi\RTS Wpos1</I>. <li>Creare con il Blocco note (Notepad) un file di nome <I>SR_STARX.001</I> contenente la password fornita da RTS e salvarlo nella cartella di installazione come sopra indicato (ad esempio <I>C:\Programma\RTS Wpos1</I>). Tale file viene poi copiato e rinominato, dal profilo di esportazione in <I>SR_START.001</I>, una sorta di file "semaforo" per far partire il processo di stampa dello scontrino i cui dati Business li inserisce nel file <I>SR_DATI.001</I> (consultare comunque la documentazione fornita con il programma WPOS1 per informazioni più dettagliate).<br><b>Attenzione!</b> Se si crea il file con il Notepad e le cartelle di Windows nascondono le estensioni dei file, controllare che il file non venga salvato con nome SR_STARX.001.TXT, file che ovviamente non verrà riconosciuto. <li>Qualora il registratore di cassa sia collegato su una porta seriale diversa dalla COM1 modificare l'opzione di registro <I>IENomeFileSarema</I> sotto indicata, indicando ad esempio un nome di file uguale a <I>SR_DATI.002</I> (qualora il reg. di cassa sia collegato sulla COM2). <li>Impostare nel registro di Business, nella cartella <I>\Bsveboll\Opzioni</I>, le seguenti proprietà: <p><IMG src="../images/help_bsiepr15_2.gif"></p><p>L'abilitazione della opzione di registro <I>IEGeneraFileSarema</I> a -1 rende inoperative le 3 opzioni di registro IEProfilo, IETabellaIN e IETabellaOU.</p></li></ol></li></ol><p>A questo punto da <A href="bsveboll.htm">Gestione documenti di Magazzino</A> o <A href="bsregdoc.htm">Gestione Unificata Documenti</A> (modulo Retail), quando si procede alla stampa dello scontrino/stampa ECR: <ol><li>viene eseguito il profilo o generato direttamente il file dello scontrino <I>SR_DATI.001</I> nella cartella <I>C:\Programmi\RTS Wpos1</I> (ossia la cartella indicata nella opzione di registro <A href="ampers07.htm#BSVEBOLL_OPZIONI_IEDirFile">IEDirFile</A>); <li>viene copiato e rinominato il file <I>SR_STARTX.001</I> nel file "semaforo" <I>SR_START.001</I>; <li>il programma WPOS1, sempre in esecuzione, in ascolto del file <I>SR_START.001</I> nella propria cartella, appena lo "sente presente" procede ad elaborare il file di dati <I>SR_DATI.001</I> e ad inviare i comandi al registratore di cassa. Quindi elimina il file <I>SR_START.001</I>.</li></ol><p><b><A name=Comeesporreilti>Come esporre il tipo pagamento nello scontrino</A></b></p><p>L'esposizione del tipo di pagamento nello scontrino (o meglio nel file ASCII SR_DATI.00x che Business NET produce in linguaggio Sarema Language, per il programma WPOS1 della RTS Eng.) si differenzia a seconda che si utilizzi il programma "Gestione unficata documenti" (Retail) oppure il programma "Gestione documenti": nel primo caso viene esposto il tipo pagamento così come appare nella finestra "Totali" (qualora sia presenti più righe di pagamento verrà esposta SOLO la prima); nel secondo caso viene esposto il tipo pagamento indicato nel campo "Tipo incasso" del codice pagamento indicato nel piede del corrispettivo.</p><p>Sulla base di quanto inserito il programma opererà in questo modo:</p><ul><li>se il tipo pagamento/incasso utilizzato è Assegno viene esposto nel file dello scontrino "CHEQ" <li>se il tipo pagamento/incasso utilizzato è Carta di credito viene esposto nel file dello scontrino "CARD" <li>in tutti gli altri casi (Contanti, Bancomat, Finanziamento, Altro) verrà esposta "ASH"</li></ul><p>Senza nessuna particolare impostazione il programma espone sempre "CASH" così come nelle versioni precedenti.</p><p>Caso 1 - Stampa scontrino in modalità diretta (ossia con opzione di registro \Bsveboll\Opzioni\ IEGeneraFileSarema con valore -1):</p><ol><li><p>impostare opzione di registro nella cartella Bsveboll\Opzioni\IEEsponiTipoPag valore -1.</p></li></ol><p>Caso 2 - Stampa scontrino tramite profilo di Import/Export da Gestione documenti (profilo standard 15 "Sarema (RTS Eng.)"):</p><ol><li><p>nel menu 8.2 "Impostazione import/export" selezionare il profilo standard 15 "Sarema (RTS Eng.)";</p><li><p>se non visibile abilitare con il Ctrl+Alt+F2 (personalizzazione griglie) la colonna "Lista campi (SELECT)";</p><li><p>all'interno di tale colonna aggiungere nella lista il seguente campo: <CODE>, tm_codpaga</CODE> e salvare la riga;</p><li><p>nel menu 8.6 "Definizione procedure import/export" entrare nel corpo della procedura "SaremaEnd" (codice 34), entrare in modifica ed effettuare gli interventi in azzurro: <CODE>Sub SaremaEnd<br>dim strSQL, snaRec, strTipoPag<br>objImex.WriteFileExport Ie1NumeroFile, "CLER,C001;"<br>if iein1tm_abbuono &gt; 0 then<br>objImex.WriteFileExport Ie1NumeroFile, "COST,V" &amp; cstr(iein1tm_abbuono * 100) &amp; ";"<br>end if<br>'Legge il tipo incasso dal pagamento<br>strTipoPag = "C" 'default = contanti<br>strSQL = "SELECT tb_tipincecr FROM tabpaga WHERE tb_codpaga = " &amp; IeIn1tm_codpaga<br>if gstrsubdatatype = "(Nessuno)" then<br>set snaRec = gdb.OpenRecordset(strsql, 4)<br>else<br>set snaRec = gcn.OpenRecordset(strsql, 4)<br>end if<br>if not snaRec.EOF then<br>strTipoPag = snaRec("tb_tipincecr")<br>end if<br>snaRec.close<br>set snaRec = Nothing<br>if strTipoPag = "A" then<br>objImex.WriteFileExport Ie1NumeroFile, "CHEQ;"<br>ElseIf strTipoPag = "V" then<br>objImex.WriteFileExport Ie1NumeroFile, "CARD;"<br>Else<br>objImex.WriteFileExport Ie1NumeroFile, "CASH;"<br>end if<br>End Sub</CODE> quindi si Controlla la routine e si salva la procedura.</p><p>Visto che tale intervento non è standard per evitare che con gli aggiornamenti di versione tali interventi vengano persi si consiglia di duplicare il profilo standard 15 in un codice &gt; a 1000 (con il programma 8.3 "Definizione profili" ed agire con le modifiche sopra indicate su tale profilo duplicato al posto di quello standard.</p><p>Per far si che il programma "Gestione documenti" vada a leggere tale nuovo profilo al prosto di quello standard 15 modificare le seguenti opzioni di registro:<br>\Bsveboll\Opzioni\IEProfilo: indicare il num. di profilo duplicato<br>\Bsveboll\Opzioni\IETabellaIN: indicare "movmag"<br>\Bsveboll\Opzioni\IETabellaOU: indicare il nome attribuito alla tabella esterna scelto.</p></li></ol><p>Caso 3 - Stampa scontrino tramite profilo di Import/Export da Retail (profilo standard 15 "Sarema (RTS Eng.)"):</p><ol><li><p>nel menu 8.6 "Definizione procedure import/export" entrare nel corpo della procedura "SaremaEnd" (codice 34), entrare in modifica ed effettuare gli interventi in azzurro: <CODE>Sub SaremaEnd<br>dim strSQL, snaRec, strTipoPag<br>objImex.WriteFileExport Ie1NumeroFile, "CLER,C001;"<br>if iein1tm_abbuono &gt; 0 then<br>objImex.WriteFileExport Ie1NumeroFile, "COST,V" &amp; cstr(iein1tm_abbuono * 100) &amp; ";"<br>end if<br>'Legge il tipo incasso dalla lista dei pagamenti (finestra Totali), rilevandolo dal primo<br>strSQL = "SELECT mmp_tipoentusc FROM reincpag WHERE codditt = " &amp; ConvStrNullSql(gstrExt) &amp; " AND mmp_tipork = '" &amp; IeIn1tm_tipork &amp; "' AND mmp_anno = " &amp; IeIn1tm_anno &amp; " AND mmp_serie = '" &amp; IeIn1tm_serie &amp; "' AND mmp_numdoc = " &amp; IeIn1tm_numdoc &amp; " AND mmp_tipoentusc &lt;&gt; 'R' ORDER BY mmp_riga"<br>if gstrsubdatatype = "(Nessuno)" then<br>set snaRec = gdb.OpenRecordset(strsql, 4)<br>else<br>set snaRec = gcn.OpenRecordset(strsql, 4)<br>end if<br>if not snaRec.EOF then<br>strTipoPag = snaRec("mmp_tipoentusc")<br>end if<br>snaRec.close<br>set snaRec = Nothing<br>if strTipoPag = "A" then<br>objImex.WriteFileExport Ie1NumeroFile, "CHEQ;"<br>ElseIf strTipoPag = "V" then<br>objImex.WriteFileExport Ie1NumeroFile, "CARD;"<br>Else<br>objImex.WriteFileExport Ie1NumeroFile, "CASH;"<br>end if<br>End Sub</CODE> quindi si Controlla la routine e si salva la procedura</p><p>Visto che tale intervento non è standard per evitare che con gli aggiornamenti di versione tali interventi vengano persi si consiglia di duplicare il profilo standard 15 in un codice &gt; a 1000 (con il programma 8.3 "Definizione profili" ed agire con le modifiche sopra indicate su tale profilo duplicato al posto di quello standard.</p><p>Per far si che il programma "Gestione unificata documenti" vada a leggere tale nuovo profilo al prosto di quello standard 15 modificare le seguenti opzioni di registro:<br>\Bsveboll\Opzioni\IEProfilo: indicare il num. di profilo duplicato<br>\Bsveboll\Opzioni\IETabellaIN: indicare "movmag"<br>\Bsveboll\Opzioni\IETabellaOU: indicare il nome attribuito alla tabella esterna scelto</p></li></ol></TD></TR></TABLE><TABLE border=0 cellSpacing=0 cellPadding=0><TR><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/software-retail-negozi/"><IMG border=0 src="../images/help_home_01_Gestisci.gif"></A></TD><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/controllo-di-gestione/"><IMG border=0 src="../images/help_home_02_Controlla.gif"></A></TD><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/crm/"><IMG border=0 src="../images/help_home_03_Fidelizza.gif"></A></TD><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/analisi-dati-datawarehouse/"><IMG border=0 src="../images/help_home_04_DWH.gif"></A></TD><TD vAlign=center width=169 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/project-management/"><IMG border=0 src="../images/help_home_05_Gestisci.gif"></A></TD><TD vAlign=center width=146 align=right><IMG border=0 src="../images/help_home_NTS_logo_up.gif"></TD></TR><TR><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/logistica/"><IMG border=0 src="../images/help_home_06_Organizza.gif"></A></TD><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/customer-service/"><IMG border=0 src="../images/help_home_07_Gestisci.gif"></A></TD><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/produzione/"><IMG border=0 src="../images/help_home_08_Pianifica.gif"></A></TD><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/archiviazione-documenti/"><IMG border=0 src="../images/help_home_09_Archivia.gif"></A></TD><TD vAlign=center width=169 align=right><IMG border=0 src="../images/help_home_NTS_logo_down1.gif"></TD><TD vAlign=center width=146 align=right><A href="http://www.ntsinformatica.it"><IMG border=0 alt="Clicca per accedere al sito di NTS Informatica" src="../images/help_home_NTS_logo_down2.gif"></A></TD></TR><TR><TD width=987 colSpan=6><IMG border=0 src="../images/help_home_Line.gif"></TD></TR></TABLE></body></html>