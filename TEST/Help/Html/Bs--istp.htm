<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3c.org/TR/1999/REC-html401-19991224/loose.dtd">
<html>
<head>
<title> GA: Impostazione stampe/visualizzazioni parametriche</title>
<LINK rel=stylesheet type=text/css href="style_topic.css">
<SCRIPT LANGUAGE="JavaScript">
<!-- Begin
loadImage1 = new Image();
loadImage1.src = "../images/help_home_Button_01_Roll-over.gif";
staticImage1 = new Image();
staticImage1.src = "../images/help_home_Button_01_Roll-out.gif";

loadImage2 = new Image();
loadImage2.src = "../images/help_home_Button_02_Roll-over.gif";
staticImage2 = new Image();
staticImage2.src = "../images/help_home_Button_02_Roll-out.gif";

loadImage3 = new Image();
loadImage3.src = "../images/help_home_Button_03_Roll-over.gif";
staticImage3 = new Image();
staticImage3.src = "../images/help_home_Button_03_Roll-out.gif";

loadImage4 = new Image();
loadImage4.src = "../images/help_home_Button_04_Roll-over.gif";
staticImage4 = new Image();
staticImage4.src = "../images/help_home_Button_04_Roll-out.gif";

// End -->
</SCRIPT>

</head>
<body lang=it topMargin=3>
<TABLE width=987 border=0><TR><TD vAlign=top align=right><p><code>Data ultimo aggiornamento: <A name=hINIeDATlAGGp></A>29/05/2015</FONT><A name=hFINeDATlAGGp></A></code></p></TD></TR></TABLE><TABLE cellSpacing=0 border=0><TR><TD colSpan=4><A href="http://www.ntsinformatica.it"><IMG border=0 alt="Clicca per accedere al sito di NTS Informatica" src="../images/help_home_banner.gif"></A></TD></TR></TABLE><TABLE width=987 border=0>
<TR>
<TD>
<p>
<b>Nome programma: BS--ISTP.DLL</b>
<br>
<b>Moduli richiesti: Qualsiasi</b>
</p>
<p>Questo programma è utilizzato per la creazione, la modifica e la cancellazione di formati di stampa, permette di basare una Stampa/Visualizzazione su un file report ".RPT" oppure su una stringa SQL (per un discorso introduttivo vedere <A href="ambsstamp01.htm">Le stampe e le visualizzazioni parametriche</A>). <u>
<b>Attenzione:</b> è consigliabile non usare i codici compresi fra 1 e 599 (riservati a NTS). In fase di aggiornamento se si sceglie di aggiornare i dati delle stampe parametriche, tali codici riservati se usati verranno persi.</u>
</p>
<p>Nel caso si voglia creare un nuovo formato di stampa basato su un report, eventualmente commissionato all'installatore, è sufficiente porre il file report ".RPT" nella cartella <code>Pers</code> contenuta nella sottocartella <code>Rpt</code>, quindi creare un nuovo record inserendo il codice del <u>Formato di Stampa</u>, il <u>Nome File RPT</u> appena inserito, e il <u>Titolo</u> del formato di stampa. Business sarà già in grado di visualizzare, esportare e/o stampare i dati del report.</p>
<p>Se invece si desidera basare un formato di stampa su una query SQL, è sufficiente digitare l'istruzione nell'apposita casella di testo <u>Stringa SQL Server</u> (è possibile anche incollare una istruzione SQL dopo averla copiata da un altro strumento di generazione) lasciando vuota la casella nome file rpt, completando l'inserimento con il codice del formato di stampa e il relativo titolo.</p>
<p>
<IMG src="../images/help_bs--istp_01.jpg">
</p>
<p>Sempre in fase di inserimento, oppure successivamente in fase di modifica, si possono impostare dei <u>Filtri Utente</u>, attraverso i quali è possibile imporre una o più condizioni (per esempio "Provincia = 'RN'" nel caso di una condizione; "Provincia = 'RN' AND Prefisso = '0541'" nel caso di due condizioni). Da notare il fatto che i <u>Valori Campo</u> e gli <u>Operatori</u> possono successivamente essere modificati anche dal programma <A href="bs--spar.htm">Stampe/Visualizzazioni Parametriche</A> prima di richiedere la stampa.</p>
<p>L'inserimento di un filtro utente ha inizio specificando il campo a cui si riferisce utilizzando la funzione di zoom e selezionando ivi la tabella, a cui il campo appartiene, e poi il campo stesso.</p>
<p>
<IMG src="../images/help_bs--istp_02.jpg">
</p>
<p>Effettuata la selezione, nella casella <u>Descrizione Campo</u> apparirà il nome esteso del campo selezionato, nella Casella <u>Nome Campo </u>apparirà, invece, il nome che il campo possiede all'interno degli archivi di Business, e nella casella <u>Tipo Campo</u> apparirà il tipo del campo che è stato selezionato (Stringa, Byte, Data/Ora, Numerico, etc...).</p>
<p>Nella casella <u>Operatore</u>, invece occorre inserire l'operatore di confronto sulla base del quale vengono filtrati i dati estratti dal report o dalla query:</p>
<ol>
<li>
<b>Like</b> (Uguale), operatore applicato alle stringhe; è possibile utilizzare i caratteri jolly '*' e '?', ad esempio, nel seguente modo: "Cognome like 'M*', che indica la selezione di tutti i record dove il Cognome inizia con la lettera M e prosegue con un numero qualsiasi di lettere qualsiasi.
<li>
<b>&gt;</b> (Maggiore), op. generalmente applicato a campi numerici e/o di tipo Data/Ora, comunque valido anche per le stringhe. Es.: "Prezzo Articolo &gt; 10000" indica la selezione di tutti i record nei quali il campo denominato 'Prezzo Articolo' è maggiore di 10000.
<li>
<b>&gt;=</b> (Maggiore o Uguale), come sopra ma indica la selezione di tutti i record nei quali il campo denominato 'Prezzo Articolo' è maggiore o uguale a 10000.
<li>
<b>&lt;</b> (Minore) Es. "Età &lt; 18", indica la selezione di tutti i record in cui il Campo 'Età' è minore di 18, quindi saranno scartati tutti quelli da 18 anni, compresi, in su.
<li>
<b>&lt;=</b> (Minore o Uguale) Es. "Età &lt;= 18", indica la selezione di quelli che hanno 18 anni oppure meno, in altre parole saranno scartati i record in cui il Campo 'Età' è strettamente superiore ai 18 anni.
<li>
<b>=</b> (Uguale) Es. "Tipo Conto = 'F'" indica la selezione di tutti i record dove il Campo 'Tipo Conto' è uguale a 'F'.
<li>
<b>&lt;&gt;</b> (Diverso) Es. "Tipo Conto &lt;&gt; 'F'" indica la selezione di tutti i record in cui il Campo 'Tipo Conto' è diverso da 'F', quindi tutti quelli che non sono 'F'.</li>
</ol>
<p>Infine, nella composizione di un filtro, occorre specificare il valore con il quale il campo deve essere confrontato e ciò deve essere fatto nella casella valore campo, digitando direttamente un valore oppure premendo il tasto di zoom per ottenere un elenco dei valori esistenti e validi per completare il filtro.</p>
<p>
<IMG src="../images/help_bs--istp_03.jpg">
</p>
<p>Più filtri possono essere messi in relazione por formare condizioni composte. La casella <u>Composizione relazionale filtri</u> è preposta a contenere la condizione composta attraverso gli operatori relazionali, di seguito elencati:</p>
<ol>
<li>
<b>AND</b> Sintassi: &lt;Condiz.1&gt; AND &lt;Condiz.2&gt;. Affinchè questa condizione composta sia vera occorre che entrambe le condizioni semplici &lt;Condiz.1&gt; e &lt;Condiz.2&gt; siano vere contemporaneamente. Es.: "DataNascita &lt; 01/01/97 AND Cognome Like 'C*'", indica la selezione di tutti i nati prima del 1997 e il cui cognome inizia con la lettera C.
<li>
<b>OR</b> Sintassi: &lt;Condiz.1&gt; OR &lt;Condiz.2&gt;. Affinchè questa condizione composta sia vera e quindi dia luogo alla selezione dei record interessati, è sufficiente che almeno una delle due condizioni semplici sia vera. Es.: "DataNascita&lt;01/01/80 OR DataNascita&gt;31/12/1989, indica la selezione di tutti i record in cui il campo DataNascita è anteriore agli anni '80 oppure posteriore. In altre parole è sufficiente "non essere nati negli anni '80 per essere selezionati".
<li>
<b>NOT</b> Sintassi: NOT &lt;Condiz.1&gt;. Affinchè questa condizione composta sia vera occorre che la condizione semplice &lt;Condiz.1&gt; sia falsa. Se &lt;Condiz.1&gt; fosse vera, NOT &lt;Condiz.1&gt; sarebbe falsa. Es.: "NOT (DataNascita&lt;01/01/80 OR DataNascita&gt;31/12/89)" in questo caso è stata negata (logicamente) la condizione composta dell'esempio precedente: prima era vera se NON si era nati negli anni 80, ora, che è preceduta dall'operatore logico NOT, è vera solo se si è nati negli anni '80.</li>
</ol>
<p>Vediamo cosa digitare nella casella composizione relazionale filtri utilizzando l'esempio dell'operatore NOT sopra descritto. Supponiamo inseriti i filtri 1 (DataNascita&lt;01/01/80) e 2 (DataNascita&gt;31/12/89), attraverso i bottoni in basso a destra, oppure digitando direttamente, possiamo inserire la composizione logica dei due filtri come segue: NOT ( 1 OR 2 ). Notare che in luogo dei due Filtri semplici abbiamo digitato il numero a loro corrispondente. Si raccomanda particolare attenzione all'uso delle parentesi che come in aritmetica modificano l'ordine di valutazione dell'espressione. Ricordiamo, inoltre, che il NOT precede AND e OR nell'ordine di valutazione dell'espressione e che nello stesso livello di parentesi, la valutazione procede, come in aritmetica, da sinistra a destra.</p>
<p>Il campo <u>Tabella principale per codice ditta</u> deve essere impostato solo per i report che operano su dati organizzati per ditta (per esempio nella query sottostante c'è la tabella delle registrazioni contabili, PRINOT, oppure dei movimenti di magazzino, MOVMAG; o di qualsiasi altra tabella col campo 'cod.ditta' all'interno). Va indicato in tal campo il nome della tabella principale della query, su cui deve essere passato come filtro il valore del codice ditta corrente. Per 'tabella principale' si intende quella (o una di quelle) che nella query si trova a destra di tutte le RIGHT JOIN e a sinisra di tutte le LEFT JOIN. Nel caso di INNER JOIN centrali, la tabella principale è una qualsiasi delle tabella collegate nella INNER JOIN stessa.</p>
<p>
<b>NB:</b> durante l'impostazione delle stampe paramentriche query creando delle query di tipo UPDATE/DELETE/INSERT non è possibile inserire dei filtri, al contrario delle SELECT oppure dei file RPT ove invece i 15 filtri sono operativi. Questo è un comportamento voluto per motivi di sicurezza e anche impostando dei filtri questi non veranno valutati al momento dell'esecuzione della query.</p>
<p>
<b>
<u>
<i>Subquery</i>
</u>
</b>
</p>
<p>Dalla release 2015 è possibile utilizzare, solo all'interno della clausola WHERE della query principale, una subquery con anche una serie di relativi filtri messi a disposizione nel tab 4, come ad esempio:</p>
<p>
<i>SELECT * FROM anagra WHERE an_tipo = 'S' AND an_conto IN (SELECT tm_conto FROM testmag WHERE *SUBQ*) </i>
</p>
<p>in questo caso il marcatore <b>*SUBQ*</b> dovrà essere inserito a mano nel punto in cui l'operatore vuole che questi nuovi 5 filtri vengano inseriti nella query, mentre poi i filtri tradizionali verranno aggiunti alla fine della query. Attenzione è possibile specificare subquery solo all'interno della clausola WHERE della query principale, non è supportato ad esempio l'inserimento delle subquery nella clausola SELECT della query principale.</p>
<p>
<b>
<i>
<u>
<A name=funz>Funzionalità</A>
</u>
</i>
</b>
</p>
<p>
<b>
<A name=Spostarsi>Spostarsi</A>
<br>
</b>Per spostarsi tra i vari formati utilizzare i tasti di scorrimento presenti nella toolbar, invece per posizionarsi su uno specifico formato esistente, posizionarsi sul campo descrizione, premere il tasto di zoom e selezionare il formato sul quale posizionarsi.</p>
<p>
<IMG src="../images/help_bs--istp_04.jpg">
</p>
<p>
<IMG src="../images/help_bs--istp_05.jpg">
</p>
<p>
<b>
<A name=Duplica>Duplicare un formato esistente</A>
<br>
</b>Per duplicare un formato di stampa esistente posizionarsi su tale formato e premere il tasto <u>Duplica</u>, nella finestra che appare digitare il codice da attribuire al nuovo formato duplicato.</p>
<p>
<IMG src="../images/help_bs--istp_06.jpg">
</p>
<p>
<b>Accesso per Operatori 
<br>
</b>Con questa funzionalità è possibile impostare degli accessi alla stampa, per Operatori\Gruppo operatori</p>
<p>
<b>
<IMG src="../images/help_bs--istp_07.jpg">
</b>
</p>
<p>Inoltre nel caso di stampe con indicato una <b>QUERY</b> che inizia per <b>SELECT</b>, è possibile indicare un nome di file di excel ed una cartella di lavoro (il file e la cartella devono già esistere). 
<br>Durante la stampa della parametrica su griglia, se è stato indicato, un file di excel, oltre ad eseguire la stampa su griglia viene anche eseguito l'export dei dati nel foglio indicato (preventivamente svuotato), in questo modo è possibile, ad esempio, realizzare un grafico su excel nel foglio 2 che attinge ai dati del foglio1 e da business, tramite la stampa parametrica (poter alimentare il foglio1 con una query specifica).</p>
<p>
<b>
<IMG src="../images/help_bs--istp_08.jpg">
</b>
</p>
</TD></TR></TABLE><TABLE border=0 cellSpacing=0 cellPadding=0><TR><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/software-retail-negozi/"><IMG border=0 src="../images/help_home_01_Gestisci.gif"></A></TD><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/controllo-di-gestione/"><IMG border=0 src="../images/help_home_02_Controlla.gif"></A></TD><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/crm/"><IMG border=0 src="../images/help_home_03_Fidelizza.gif"></A></TD><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/analisi-dati-datawarehouse/"><IMG border=0 src="../images/help_home_04_DWH.gif"></A></TD><TD vAlign=center width=169 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/project-management/"><IMG border=0 src="../images/help_home_05_Gestisci.gif"></A></TD><TD vAlign=center width=146 align=right><IMG border=0 src="../images/help_home_NTS_logo_up.gif"></TD></TR><TR><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/logistica/"><IMG border=0 src="../images/help_home_06_Organizza.gif"></A></TD><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/customer-service/"><IMG border=0 src="../images/help_home_07_Gestisci.gif"></A></TD><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/produzione/"><IMG border=0 src="../images/help_home_08_Pianifica.gif"></A></TD><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/archiviazione-documenti/"><IMG border=0 src="../images/help_home_09_Archivia.gif"></A></TD><TD vAlign=center width=169 align=right><IMG border=0 src="../images/help_home_NTS_logo_down1.gif"></TD><TD vAlign=center width=146 align=right><A href="http://www.ntsinformatica.it"><IMG border=0 alt="Clicca per accedere al sito di NTS Informatica" src="../images/help_home_NTS_logo_down2.gif"></A></TD></TR><TR><TD width=987 colSpan=6><IMG border=0 src="../images/help_home_Line.gif"></TD></TR></TABLE></body></html>