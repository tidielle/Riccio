<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3c.org/TR/1999/REC-html401-19991224/loose.dtd">
<html>
<head>
<title> AM: Aggiornamenti su Business</title>
<LINK rel=stylesheet type=text/css href="style_topic.css">
<SCRIPT LANGUAGE="JavaScript">
<!-- Begin
loadImage1 = new Image();
loadImage1.src = "../images/help_home_Button_01_Roll-over.gif";
staticImage1 = new Image();
staticImage1.src = "../images/help_home_Button_01_Roll-out.gif";

loadImage2 = new Image();
loadImage2.src = "../images/help_home_Button_02_Roll-over.gif";
staticImage2 = new Image();
staticImage2.src = "../images/help_home_Button_02_Roll-out.gif";

loadImage3 = new Image();
loadImage3.src = "../images/help_home_Button_03_Roll-over.gif";
staticImage3 = new Image();
staticImage3.src = "../images/help_home_Button_03_Roll-out.gif";

loadImage4 = new Image();
loadImage4.src = "../images/help_home_Button_04_Roll-over.gif";
staticImage4 = new Image();
staticImage4.src = "../images/help_home_Button_04_Roll-out.gif";

// End -->
</SCRIPT>

</head>
<body lang=it topMargin=3>
<TABLE width=987 border=0><TR><TD vAlign=top align=right><p><code>Data ultimo aggiornamento: <A name=hINIeDATlAGGp></A>04/03/2014</FONT><A name=hFINeDATlAGGp></A></code></p></TD></TR></TABLE><TABLE cellSpacing=0 border=0><TR><TD colSpan=4><A href="http://www.ntsinformatica.it"><IMG border=0 alt="Clicca per accedere al sito di NTS Informatica" src="../images/help_home_banner.gif"></A></TD></TR></TABLE><TABLE cellSpacing=0 cellPadding=0 border=0><TR><TD align=left><A onmouseover="image1.src=loadImage1.src;" onmouseout="image1.src=staticImage1.src;" href="cose.htm"><IMG border=0 name=image1 alt="Clicca per accedere all'argomento" src="../images/help_home_Button_01_Roll-out.gif"></A></TD><TD align=center><A onmouseover="image2.src=loadImage2.src;" onmouseout="image2.src=staticImage2.src;" href="pc.htm"><IMG border=0 name=image2 alt="Clicca per accedere all'argomento" src="../images/help_home_Button_02_Roll-out.gif"></A></TD><TD align=center><A href="ambsargmod.htm"><IMG border=0 name=image3 alt="Clicca per accedere all'argomento" src="../images/help_home_Button_03_Roll-over.gif"></A></TD><TD align=right><A onmouseover="image4.src=loadImage4.src;" onmouseout="image4.src=staticImage4.src;" href="gaguidaan.htm"><IMG border=0 name=image4 alt="Clicca per accedere all'argomento" src="../images/help_home_Button_04_Roll-out.gif"></A></TD></TR><TR><TD colSpan=4><A href="http://www.ntsinformatica.it"><IMG border=0 alt="Clicca per accedere al sito di NTS Informatica" src="../images/help_home_Button_03_Roll-over-row.gif"></A></TD></TR><TR><TD bgColor=#009ee2 height=53 vAlign=middle width=987 colSpan=4 align=left><p><FONT class=title color=white size=6><b>Aggiornamenti su Business</b></FONT></p></TD></TR><TR><TD vAlign=middle colSpan=4 align=left></TD></TR></TABLE><TABLE width=987 border=0><TR><TD>
<p>In Business NET nel programma d'installazione degli aggiornamenti (BUSAGG) sono stati apportati miglioramenti per semplificarne l'utilizzo e per gestire in modo migliore il Controllo Account Utente (UAC). Fino alle versioni precedenti infatti non era possibile attivare l'installazione automatica degli aggiornamenti quando l'account di Windows,con cui si accede a Business NET, non aveva i privilegi di amministratore ed era attivo l'UAC.</p>
<p>Sono stati apportati significativi miglioramenti per quanto riguarda la sicurezza: ora l'installazione degli aggiornamenti lanciata nella modalità "server" (vedere più avanti) richiede che vengano fornite delle credenziali amministrative di Business NET (ossia l'indicazione di un utente appartenente al gruppo/ruolo "Amministratori").</p>
<p>Ora il programma d'installazione degli aggiornamenti, rappresentato dal file Busagg.exe, non viene più installato localmente ma risiede unicamente nella <b>cartella di distribuzione degli aggiornamenti</b>, rappresentata, ad esempio, della cartella <u>C:\Bus\Agg</u> sul server, vista dai cliente come <u>\\Busserver\BusinessDir\Agg</u>. Per ogni installazione quindi esiste un unico programma d'installazione degli aggiornamenti il quale viene automaticamente aggiornato, in base alle necessità di NTS Informatica, da qualsiasi pacchetto di aggiornamento (Hot Update, Cumulative Update e Service Release); tale programma è stato realizzato con InnoSetup. Questo programma, al contrario di quello distribuito con le versioni precedenti, va ad aggiornare le direttive di disinstallazione (nel Pannello di Controllo, Programmi e funzionalità) di Windows per evitare, ad esempio, che nuovi componenti rilasciati in una service release non vengano rimossi da una eventuale disinstallazione di Business NET.</p>
<p>Il programma d'installazione degli aggiornamenti può essere avviato in 3 modalità distinte:</p>
<ol>
<li>
<b>automatica</b>, nella modalità client, all'avvio di Business NET, quando impostata l'installazione automatica degli aggiornamenti all'avvio, e se ci sono aggiornamenti nella cartella degli aggiornamenti sul server da installare;
<li>
<b>manuale</b>, nella modalità server o client, eseguendo manualmente il file Busagg.exe oppure all'interno di Business NET, nel menu Programmi, accedendo alla voce <i>Verifica/installa aggiornamenti</i>.
<li>
<b>integrata nei pacchetti d'installazione</b>, nella modalità server, quando si eseguono i pacchetti d'installazione delle Hot Update, Cumulative Update e Service Release (ad esempio i file BusNet2014Sr1.exe, BusNet2014_hu_&lt;aaammgg&gt;_&lt;oommss&gt;.exe, BusNet2014_cu1.exe, ...); rispetto alle versioni precedenti non è poi necessario copiare il pacchetto nella cartella temporanea, ad esempio C:\BusTmp, o scompattarne il contenuto nella cartella di distribuzione aggiornamenti sul server, ad esempio C:\Bus\Agg, basta eseguire (doppio click) sul pacchetto da qualsiasi posizione sul disco.
<li>
<b>integrata nei pacchetti d'installazione per la distribuzione dei dati</b>, nella modalità server, allo scopo di distribuiti i dati nell'archivio procedura come ad esempio i codici ABI/CAB e i codici Intrastat (nomenclature combinate dei beni TARIC e servizi CPA). Questi pacchetti sostituiscono i vecchi Bustaric.exe e Busabi.exe</li>
</ol>
<p>Il programma d'installazione degli aggiornamenti può accettare i seguenti parametri di avvio:</p>
<p>
<b>/FILEPROFILO="c:\program files\bus\business.cfg": </b>rappresenta il file di configurazione del profilo, completo di percorso, su cui installare gli aggiornamenti; questo rappresenta il profilo corrente che verrà mostrato nella finestra;</p>
<p>
<b>/BUSNET:</b> ad uso interno di NTS Informatica, serve per chiamare il programma di installazione nella modalità automatica all'avvio di Business NET quando ci sono aggiornamenti da installare "pendenti" nella cartella di distribuzione sul server; in questo caso viene fornito obbligatoriamente il parametro /FILEPROFILO.</p>
<p>
<b>/CLIENT e /SERVER:</b> serve per impostare la modalità di installazione aggiornamenti da avviare sia lanciando il programma Busagg.exe che i pacchetti di hotfix, postfix o service release. Obbligatorio nelle installazioni /SILENT e /VERYSILENT.</p>
<b>
<p>/SILENT:</b> opzionale, avvia l'installazione dell'aggiornamento senza intervento dell'operatore. Vanno specificati obbligatoriamente altri parametri come più avanti viene riportato.</p>
<b>
<p>/VERYSILENT:</b> opzionale, avvia l'installazione come indicato nel parametro /SILENT in aggiunta viene anche rimossa la finestra con l'avanzamento del processo d'installazione.</p>
<b>
<p>/SUPPRESSMSGBOXES:</b>opzionale, se indicato tutti i messaggi informativi non vengono mostrati a video ma salvati nel file di log. Ha effetto solo se viene utilizzato in combinazione con il parametro /SILENT o /VERYSILENT.</p>
<b>
<p>/UTENTEAMMINISTRATORE:</b> opzionale, rappresenta il nome operatore di Business NET, con i privilegi di amministratore, per avviare l'installazione degli aggiornamenti nella modalità server. Obbligatorio nelle installazioni /SILENT e /VERYSILENT specificando il parametro /SERVER.</p>
<b>
<p>/PASSWORDAMMINISTRATORE:</b> opzionale, serve per preimpostare la password dell'operatore indicato in /UTENTEAMMINISTRATORE.</p>
<b>
<p>/ATTENDIADMINTOOLS:</b> opzionale, se indicato, qualora vi sia la necessità da parte del programma d'installazione degli aggiornamenti di avviare la conversione degli archivi, l'avvio del Busadmintools.exe avviene con la conferma da parte dell'operatore. Questo consente, eventualmente, di escludere uno o più database dalla conversione. Ha priorità rispetto alla direttiva ADMNTOOL_WAIT=S eventualmente presente nel RILASCIO.TXT.</p>
<p>Il programma d'installazione aggiornamenti di Business NET (Busagg.exe) crea un file di log durante tutto il processo di installazione; tale file è presente nella root del disco di avvio di Windows (ad es. C:\) qualora l'installazione non venga portata a termine correttamente oppure nella <i>Cartella dei file/archivi</i> di Business NET (ad es. C:\Bus) qualora il setup termini correttamente. Il file possiede il seguente nome: "BusAggSetup Log &lt;anno&gt;-&lt;mese&gt;-&lt;giorno&gt; #&lt;contatore&gt;.txt (ad es. "BusAggSetup Log 2013-01-10 #001.txt).</p>
<p>Il programma d'installazione degli aggiornamenti richiede i requisiti di amministratore dell'account di Windows che lo manda in esecuzione: qualora sia abilitato il Controllo Account Utente (UAC) viene richiesta l'elevazione ad amministratore.</p>
<p>Quando il programma d'installazione viene lanciato nella modalità automatica parte immediatamente il processo d'installazione, negli altri casi appare la finestra sottostante.</p>
<p>
<IMG src="../images/help_Ambusagg_01.jpg">
</p>
<p>
<b>Profilo installato</b>
</p>
<p>Questo campo elenca i profili installati di Business NET che il programma ha rilevato sulla macchina corrente. Per ogni profilo rilevato riporta la <i>
<u>Cartella installazione (locale)</u>
</i>rappresentata dalla cartella dove è stato individuato il file di configurazione del profilo (nell'esempio "C:\Program Files\Bus\Test\Test.cfg"), la versione di Business NET individuata (determinata dalla versione del file Busnet.exe), la <i>
<u>Cartella aggiornamenti</u>
</i>ossia la cartella sulla rete che provvede alla distribuzione degli aggiornamenti (rilevata dall'archivio procedura, tabella REGEDIT, proprietà Busagg\BusAggDir), il <i>
<u>N° aggiornamento server</u>
</i>rappresenta il numeratore contenuto nel file AGGNUMBER.TXT nella cartella aggiornamenti sul server, il <i>
<u>N° aggiornamento locale</u>
</i>rappresenta il numeratore nell'installazione corrente di Business NET (rilevatodall'archivio procedura, tabella REGEDIT, proprietà Busagg\AggNumber). Quando il <i>N° aggiornamento locale</i> è inferiore al <i>N° aggiornamento server</i> significa che nella cartella aggiornamenti sono presentidei file aggiornati non ancora installati sul profilo di Business NET locale.</p>
<p>Quando un profilo di Business NET presente sulla macchina non viene rilevato (vedere più avanti la tecnica utilizzata per rilevare i profili) è possibile scegliere da questo campo la voce <i>(seleziona file di configurazione)</i> allo scopo di selezionare in modo manuale il file &lt;profilo&gt;.cfg dal disco. Una volta che il file scelto viene validato il profilo viene elencato nel combo e reso corrente.</p>
<p>
<b>Modalità aggiornamento, client</b>
</p>
<p>Avviato con questa opzione, qualora ci siano aggiornamenti da installare presenti nella cartella aggiornamenti (ossia il <i>N° aggiornamento locale</i> è inferiore al <i>N° aggiornamento server</i> ) il programma provvede ad installarli nel profilo locale di Business NET e ad allineare il N° aggiornamento (AggNumber) locale con quello del server. L'installazione client non è ammessa quando il programma viene lanciato nella modalità integrata coi pacchetti d'installazione hotfix, postfix e service release.</p>
<p>
<b>Modalità aggiornamento, server</b>
</p>
<p>Avviato con questa opzione vengono dapprima verificati i requisiti d'installazione, quindi, se avviato nella modalità integrata, estratti i file aggiornati dal pacchetto nella cartella aggiornamenti sul server , quindi vengono installati sia i componenti server (file di report, file di Office) che i componenti client nella installazione locale di Business NET. Al termine qualora nelle direttive di installazione è indicato di procedere alla conversione degli archivi, provvede a lanciare il programma <i>Strumento di amministrazione</i> (Busadmintools.exe)in modalità automatica per convertire l'archivio procedura e/o tutti i database azienda.</p>
<p>
<b>Utente Business NET, Password</b>
</p>
<p>Prima di avviare un aggiornamento in modalità server è necessario fornire le credenziali di Business NET di tipo amministrativo, ossia un operatore appartenente al gruppo/ruolo "Amministratori".</p>
<p>
<b>Operazioni eseguite nella modalità aggiornamento Client</b>
</p>
<ul>
<li>Controlli preliminari: <ul>
<li>controlla la presenza di Business NET sulla macchina corrente;
<li>rileva il N° aggiornamento server (contenuto nel file AGGNUMBER.TXT nella cartella di distribuzione aggiornamenti sul server, Busagg\BusAggDir) e il N° aggiornamento locale dal registro di Business NET del profilo locale (archivio procedura, tabella REGEDIT);
<li>l'elaborazione è ammessa solo se il N° aggiornamento locale è inferiore al N° aggiornamento server;
<li>controlla che <u>non</u> siano presenti i modelli di database personalizzati (*.MODXP, *.MODXV e *.MODXV1) nella cartella di distribuzione degli aggiornamenti (possono essere presenti solo nella sottocartella \Pers);
<li>verifica che la versione dell'archivio procedura ARCPROC equivalga alla versione di Business NET (versione del file Busnet.exe);
<li>controlla che il programma d'installazione (Busagg.exe) sia della medesima versione di Business NET che si sta aggiornando;
<li>rileva la presenza del file BUSAGGSERVER.TXT nella cartella di distribuzione aggiornamenti sul server;</li>
</ul>
<li>vengono copiati dalla cartella di distribuzione aggiornamenti del server (ad esempio \\Busserver\BusinessDir\Agg) alla cartella locale d'installazione di Business NET (ad esempio C:\Program Files\Bus) i seguenti componenti, se presenti: <ul>
<li>file .EXE (Busnet.exe, Busadmintools.exe, Busserv.exe e Buschat.exe, inclusi i relativi file .MANIFEST e .CONFIG);
<li>file .DLL e relativi file .PDB;
<li>modelli di database standard (file .MODX);
<li>risorse grafiche di Business NET (file .GIF, .JPG, .PNG, .ICO e .WAV) sono copiare nella sottocartella \Bnimages;</li>
</ul>
<li>vengono copiati dalla sottocartella \Pers della cartella di distribuzione aggiornamenti del server, contente le personalizzazioni (ad esempio \\Busserver\BusinessDir\Agg\Pers) alla cartella locale d'installazione di Business NET (ad esempio C:\Program Files\Bus) i seguenti componenti, se presenti: <ul>
<li>file .DLL personalizzare e relativi file .PDB;
<li>modelli di database personalizzati/verticalizzati (file PROVA.MODXP, PROVA.MODXV, PROVA.MODXV1, ARCPROC.MODXP, ARCPROC.MODXV e ARCPROC.MODXV1);
<li>risorse grafiche dei programmi personalizzati (file .GIF, .JPG, .PNG, .ICO e .WAV) sono copiare nella sottocartella \Bnimages;
<li>file della guida in linea dei programmi personalizzati (file .HTM, HELP_*.GIF, HELP_*.JPG e HELP_*.PNG). Qualora nella cartella di destinazione i file siano già esistenti saranno sovrascritti;</li>
</ul>
<li>qualora nella cartella di destinazione i file siano già esistenti, se <u>non</u> sono dotati di versione (.HTM, .JPG, ...) vengono sovrascritti, gli altri (EXE e DLL) vengono sovrascritti solo se di versione inferiore;
<li>quando la differenza tra il <i>N° aggiornamento locale</i> e <i>N° aggiornamento server</i> differisce di più di una unità, anche i file dotati di versione (.EXE e .DLL) verranno copiati sui client sovrascrivendo i componenti già esistente senza alcun controllo di versione (questo sistema può essere utile anche per forzare un downgrade di componenti/DLL personalizzate);
<li>vengono copiati gli eventuali file della guida in linea standard (file .HTM, .HCC, .CSS, .GIF, .JPG e .PNG) dalla sottocartella \Help della cartella di distribuzione aggiornamenti del server (ad esempio \\Busserver\BusinessDir\Agg\Help) alla cartella locale d'installazione di Business NET (ad esempio C:\Program Files\Bus\Help). Qualora nella cartella di destinazione i file siano già esistenti saranno sovrascritti;
<li>prima di uscire allinea il N° aggiornamento locale (dell'archivio procedura, tabella REGEDIT, proprietà Busagg\AggNumber) al N° aggiornamento server (del file AGGNUMBER.TXT sul server).</li>
</ul>
<p>
<b>Operazioni eseguite nella modalità aggiornamento Server</b>
</p>
<ul>
<li>Controlli preliminari: <ul>
<li>controlla la presenza di Business NET sulla macchina corrente;
<li>rileva il N° aggiornamento server (contenuto nel file AGGNUMBER.TXT nella cartella di distribuzione aggiornamenti sul server, Busagg\BusAggDir) e il N° aggiornamento locale dal registro di Business NET del profilo locale (archivio procedura, tabella REGEDIT);
<li>l'elaborazione è ammessa solo se il N° aggiornamento locale è inferiore al N° aggiornamento server;
<li>controlla che <u>non</u> siano presenti i modelli di database personalizzati (*.MODXP, *.MODXV e *.MODXV1) nella cartella di distribuzione degli aggiornamenti (possono essere presenti solo nella sottocartella \Pers);
<li>verifica che la versione dell'archivio procedura ARCPROC equivalga alla versione di Business NET (versione del file Busnet.exe);
<li>controlla che il programma d'installazione (Busagg.exe) o il pacchetto hotfix, postfix o service release sia della medesima versione di Business NET che si sta aggiornando;
<li>valida l'utente e la password indicata e controlla che appartenga al ruolo "Amministratori";
<li>individua il file con le direttive di installazione server (RILASCIO.TXT) che deve essere presente nella cartella aggiornamenti nelle installazioni manuali, incorporato nel pacchetto nelle installazioni dei pacchetti hotfix, postfix e service release;
<li>legge dal file BUSAGGSERVER.TXT, sempre presente nella cartella degli aggiornamenti sul server, l'ID di versione correntemente installata dalla proprietà FRAM (ad esempio 19001 rappresenta "Business NET 2013", 19003 rappresenta "Business NET 2013 SR1", ...)
<li>dal file RILASCIO.TXT rileva la l'ID di versione minima, dalla proprietà REQUIRED_FRAM, necessaria per procede con l'aggiornamento nella modalità server;
<li>dal file RILASCIO.TXT rileva le proprietà PRC_AGGSTRUCT (forza aggiornamento della struttura dell'archivio procedura), PRC_AGG_STPRO (forza aggiornamento delle stored procedures dell'archivio procedura), PRC_AGG__ZOOM (forza aggiornamento dell'elenco proprietà del registro Business NET), PRC_AGG__MENU (forza aggiornamento delle voci di menu standard) che se valorizzate a "S" fanno partire, al termine del processo d'installazione degli aggiornamenti , la conversione dell'archivio procedura mediante il Busadmintolols.exe. Tipicamente nei pacchetti di installazione hotfix, postfix e service release sono tutte impostate a "S" quando viene distribuito anche il file ARCPROC.MODX;
<li>da file RILASCIO.TXT rileva le proprietà AZI_AGGSTRUCT (forza aggiornamento della struttura dei database azienda) e AZI_AGG_STPRO (forza aggiornamento delle stored procedures dei database azienda)che se valorizzate a "S" fanno partire, al termine del processo d'installazione degli aggiornamenti , la conversione di tutti i database azienda mediante il Busadmintolols.exe. Tipicamente nei pacchetti di installazione hotfix, postfix e service release sono tutte impostate a "S" quando viene distribuito anche il file PROVA.MODX;
<li>dal file RILASCIO.TXT rileva la proprietà AGG_AGGNUMBER (che può assumere i valori S=Sì, N=No o C=Chiedi) che determina come incrementare il <i>N° aggiornamento server</i> (AggNumber) nel file AGGNUMBER.TXT contenuto nella cartella aggiornamenti sul server;
<li>se l'aggiornamento prevede la conversione dei database azienda controlla che tutti siano di versione (tabella RELEASE) uguale alla versione di Business NET (versione del file Busnet.exe);
<li>se l'aggiornamento prevede la conversione dei database azienda e nella cartella d'installazione sono presenti delle personalizzazioni/customizzazioni alla struttura dei database (presenza dei file PROVA.MODXP e/o PROVA.MODXV e PROVA.MODXV1) chiede conferma all'operatore prima di procedere;</li>
</ul>
<li>se il programma d'installazione aggiornamenti è avviato da un pacchetto di Hot Update, Cumulative Update o Service Release (modalità di avvio 3. sopra indicato), estrae i file dal pacchetto e li copia nella cartella di distribuzione degli aggiornamenti sul server (ad esempio C:\Bus\Agg se questa operazione viene compiuta dal server oppure \\Busserver\BusinessDir\Agg se questa operazione viene compiuta da un client). Qualora nella cartella di destinazione i file siano già esistenti, se <u>non</u> sono dotati di versione (.HTM, .RPT, ...) vengono sovrascritti, gli altri (EXE e DLL) vengono sovrascritti solo se di versione inferiore o uguale;
<li>vengono copiati dalla cartella di distribuzione aggiornamenti del server (ad esempio C:\Bus\Agg se questa operazione viene compiuta dal server oppure \\Busserver\BusinessDir\Agg se questa operazione viene compiuta da un client) alla cartella locale d'installazione di Business NET (ad esempio C:\Program Files\Bus) i seguenti componenti, se presenti: <ul>
<li>file .EXE (Busnet.exe, Busadmintools.exe, Busserv.exe e Buschat.exe, inclusi i relativi file .MANIFEST e .CONFIG);
<li>file .DLL e relativi file .PDB;
<li>modelli di database standard (file .MODX);
<li>risorse grafiche di Business NET (file .GIF, .JPG, .PNG, .ICO e .WAV) sono copiare nella sottocartella \Bnimages;</li>
</ul>
<li>vengono copiati dalla sottocartella \Pers della cartella di distribuzione aggiornamenti del server, contente le personalizzazioni (ad esempio C:\Bus\Agg\Pers se questa operazione viene compiuta dal server oppure \\Busserver\BusinessDir\Agg\Pers) alla cartella locale d'installazione di Business NET (ad esempio C:\Program Files\Bus) i seguenti componenti, se presenti: <ul>
<li>file .DLL personalizzare e relativi file .PDB;
<li>modelli di database personalizzati/verticalizzati (file PROVA.MODXP, PROVA.MODXV, PROVA.MODXV1, ARCPROC.MODXP, ARCPROC.MODXV e ARCPROC.MODXV1);
<li>risorse grafiche dei programmi personalizzati (file .GIF, .JPG, .PNG, .ICO e .WAV) sono copiare nella sottocartella \Bnimages;
<li>file della guida in linea dei programmi personalizzati (file .HTM, HELP_*.GIF, HELP_*.JPG e HELP_*.PNG). Qualora nella cartella di destinazione i file siano già esistenti saranno sovrascritti;
<li>vengono copiati i file dei report personalizzati ( .RPT, .PDF) e i file di Office (.DOT, .DOTX, .OTT, .OXT) nelle rispettive cartelle sul server, sovrascrivendo i file esistenti;
<li>vengono copiati gli script delle personalizzazioni (.NTS) e il file DLLMAP.INI nella cartella \Script a pari livello della \Rpt sempre sul server;</li>
</ul>
<li>qualora nella cartella di destinazione i file siano già esistenti, se <u>non</u> sono dotati di versione (.HTM, .JPG, ...) vengono sovrascritti, gli altri (EXE e DLL) vengono sovrascritti solo se di versione inferiore;
<li>quando la differenza tra il <i>N° aggiornamento locale</i> e <i>N° aggiornamento server</i> differisce di più di una unità, anche i file dotati di versione (.EXE e .DLL) verranno copiati sui client sovrascrivendo i componenti già esistenti senza alcun controllo di versione (questo sistema può essere utile anche per forzare un downgrade di componenti/DLL personalizzate);
<li>vengono copiati gli eventuali file della guida in linea (file .HTM, .HCC, .CSS, .GIF, .JPG e .PNG) dalla sottocartella \Help della cartella di distribuzione aggiornamenti del server (ad esempio \\Busserver\BusinessDir\Agg\Help) alla cartella locale d'installazione di Business NET (ad esempio C:\Program Files\Bus\Help). Qualora nella cartella di destinazione i file siano già esistenti saranno sovrascritti;
<li>vengono copiati i file dei report ( .RPT, .PDF) e i file di Office (.DOT, .DOTX, .XLS, .XLSX, .OTT, .OXT) nelle rispettive cartelle sul server, sovrascrivendo i file esistenti;
<li>se nelle direttive di installazione server, indicate nel RILASCIO.TXT, sono presenti le direttive PRC_AGGSTRUCT, PRC_AGG_STPRO, PRC_AGG__ZOOM e PRC_AGG__MENU valorizzate a "S" viene fatto partire il Busadmintools.exe per convertire automaticamente l'archivio procedura. A partire da questa versione di Business NET sono ammesse variazioni alla struttura dei database (tabelle, campi) anche con la distribuzione di service release. Questa procedura di conversione archivi non prevede la possibilità di aggiornare: le stampe parametriche predefinite, i profili import/export standard, i codici abi/cab e i cod. di nomenclatura combinata Taric;
<li>se nelle direttive di installazione server, indicate nel RILASCIO.TXT, sono presenti le direttive AZI_AGGSTRUCT e AZI_AGG_STPRO valorizzate a "S" viene fatto partire il Busadmintools.exe per convertire automaticamente <u>tutti</u> i database azienda (rilevati nella tabella AZIENDE dell'archivio procedura). A partire da questa versione di Business NET sono ammesse variazioni alla struttura dei database (tabelle, campi) anche con la distribuzione di service release;
<li>sulla base di come è valorizzata la direttiva AGG_AGGNUMBER del RILASCIO.TXT il programma provvede a: <ul>
<li>N: non incrementare il <i>N° aggiornamento server</i> nel file AGGNUMBER.TXT, questo fa si che non venga fatta partire l'installazione automatica sul client al riavvio di Business NET;
<li>S: incrementare il <i>N° aggiornamento server</i> nel file AGGNUMBER.TXT;
<li>C: chiedere all'operatore se incrementare o meno il <i>N° aggiornamento server</i> nel file AGGNUMBER.TXT;</li>
</ul>
<li>al termine dell'elaborazione viene rimosso il file RILASCIO.TXT per evitare che successive elaborazioni server "riciclino" le direttive d'installazione nel file;
<li>prima di uscire allinea il N° aggiornamento locale (dell'archivio procedura, tabella REGEDIT, proprietà Busagg\AggNumber) al N° aggiornamento server (del file AGGNUMBER.TXT sul server).</li>
</ul>
<p>Nella modalità di avvio 4. sopra definita (integrata nei pacchetti d'installazione per la distribuzione dei dati) i soli file che vengono installati sono i seguenti file: ARCPROC.MODX, Busadmintools.*, Bn__sqlb.* e i report Par*.rpt.</p>
<p>
<b>Come si installano</b>
<b>i pacchetti di Hot Update, Cumulative Update e Service Release</b>
</p>
<p>Questi pacchetti vengono distribuiti con file EXE al cui interno è presente il programma d'installazione. Per l'installazione procedere nel modo sotto indicato:</p>
<ol>
<li>posizionarsi su una qualsiasi macchina in cui è installato Business NET, su un account Windows di tipo amministratore;
<li>chiudere il programma Business NET;
<li>copiare il file BusNet*.exe in una qualsiasi cartella sul disco o sul desktop;
<li>eseguire il file facendo doppio click;
<li>nella finestra <i>Configurazione dell'aggiornamento a Business NET</i> scegliere il profilo da aggiornare e, se non elencato, utilizzare la voce <i>(seleziona file di configurazione)</i> per selezionare il file di configurazione (&lt;profilo&gt;.cfg);
<li>inserire l'<i>Utente di Business NET</i>, di tipo amministratore, e la relativa <i>Password</i>;
<li>premere <i>Installa</i> e attendere la fine del processo;
<li>qualora nel pacchetto siano inclusi i modelli di database (Prova.modx e/o Arcproc.modx) il programma procede alla conversione automatica di tutti i database;
<li>su tutte le altre macchine: <ul>
<li>se durante l'installazione è stata impostata l'opzione <i>Installa automaticamente gli aggiornamenti all'avvio di Business NET</i>, basta rientrare in Business NET per far partire l'installazione degli aggiornamenti;
<li>se non è impostato l'aggiornamento automatico, all'interno di Business NET, nel menu <i>Programmi</i> accedere alla voce <i>Verifica/installa aggiornamenti</i>. Business NET verrà chiuso e partirà il programma <i>Installazione aggiornamenti di Business NET</i>, controllare che la <i>Modalità aggiornamento</i> sia impostata su <i>Client</i>, quindi premere <i>Installa</i> attendere la fine del processo.</li>
</ul>
</li>
</ol>
<p>
<b>Come il programma d'installazione degli aggiornamenti rileva i profili installati sulla macchina corrente</b>
</p>
<p>Il programma d'installazione degli aggiornamenti (Busagg.exe) rileva la lista dei profili installati dall'elenco dei programmi installati in Windows dal Pannello di controllo, Programmi e funzionalità. Tecnicamente opera in questo modo:</p>
<ol>
<li>apre il ramo del registro di windows HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\
<li>individua le chiavi relative alle installazioni di Business NET (nomi "NTSInformaticaBusNet<i>n</i>_is1") create dal programma d'installazione; <ul>
<li>per ognuna legge la proprietà InstallLocation contenente la cartella d'installazione (ad esempio C:\Program Files\Bus);
<li>individua tutti i file *.CFG contenuti;
<li>il nome di tale file rappresentano il profilo.
<li>sempre in questa cartella individua la versione (major) del file Busnet.exe per individuarne la versione di Business NET installata;</li>
</ul>
</li>
</ol>
<p>A questo punto il programma mostra come profilo selezionato (nel combo <i>Profili installati</i>) quello denominato Business (Business.cfg) nella cartella predefinita (C:\Program Files\Bus), se esiste e di versione uguale alla versione del Busagg.exe, altrimenti il primo profilo rilevato.</p>
<p>
<b>Come installare manualmente le personalizzazioni o aggiornamenti alle personalizzazioni</b>
</p>
<p>Quando si realizza una personalizzazione ai programmi (creazione di DLL) o alla base dati (creazione del PROVA.MODXP) queste devono essere installate presso l'installazione dell'utilizzatore. A partire da questa versione di Business NET, i file delle personalizzazioni vengono tenuti isolati dai componenti standard presenti nella cartella di distribuzione degli aggiornamenti, risiedono nella sottocartella \Pers (ad esempio C:\Bus\Agg\Pers) e non vengono di conseguenza rimossi nell'installazioni di major release con programma di installazione. Per installare le personalizzazioni si può procedere così come nelle versioni precedenti in modo manuale. Si consiglia di procedere in uno dei due modo indicati:</p>
<p>
<b>Metodo 1</b>
</p>
<ol>
<li>da una qualsiasi macchina sulle rete, in cui è installato Business NET, copiare nella sottocartella \PERS della cartella di distribuzione degli aggiornamenti sul server (ad esempio C:\Bus\Agg\Pers o \\Server\BusinessDir\Agg\Pers) le DLL personalizzate ed eventualmente le personalizzazione alla base dati inserite nel PROVA.MODXP;
<li>creare manualmente, ad esempio con il Blocco Note/Notepad o altri editor di testo, il file RILASCIO.TXT nella medesima cartella, come nell'esempio sotto indicato: 
<br>
<br>
<code>[Rilascio] 
<br>REQUIRED_FRAM=20000 
<br>INSTALL_DATE=40331 
<br>PRC_AGGSTRUCT=N 
<br>PRC_AGG_STPRO=N 
<br>PRC_AGG__ZOOM=N 
<br>PRC_AGG__MENU=N 
<br>AZI_AGGSTRUCT=S 
<br>AZI_AGG_STPRO=S 
<br>AGG_AGGNUMBER=S</code>
<br>

<br>indicando in REQUIRED_FRAM l'ID di versione correntemente installata (vedere la proprietà FRAM contenuta nel file BUSAGGSERVER.TXT), qualora sia necessario forzare la conversione dei database azienda, per la presenza del PROVA.MODXP, porre a "S" le proprietà AZI_AGGSTRUCT e AZI_AGG_STPRO. Nella proprietà AGG_AGGNUMBER indicare "S" per far in modo che l'installazione di tale aggiornamento vada ad incrementare automaticamente il <i>N° aggiornamento server</i> (AGGNUMBER.TXT) per far in modo che tutti gli altri client si aggiornino automaticamente all'avvio di Business NET.
<li>lanciare il programma Installazione aggiornamenti di Business NET (Busagg.exe) dalla cartella di distribuzione degli aggiornamenti e avviarlo modalità Server.
<li>durante questa fase, se indicato, verrà lanciata la conversione degli archivi (Busadmintools.exe) per andare ad inserire i campi/tabelle indicati nel PROVA.MODXP, se non presenti, nei database azienda. Questa operazione interesserà <u>tutti</u> i database azienda e può avvenire solo se i database sono di versione corrente (non è ammesso, ad esempio, l'installazione di aggiornamento relativo alla 2013 -vers. 19- quando il database è in versione 2012 -vers. 18-).</li>
</ol>
<p>Occorre comunque tenere presente che, come indicato sopra, durante l'installazione dei componenti nella installazione locale (della modalità server o client) sono coinvolti tutti i componenti presenti nella cartella aggiornamenti sul server (BusAggDir).</p>
<p>
<b>Metodo 2</b>
</p>
<ol>
<li>da una qualsiasi macchina sulle rete, in cui è installato Business NET, copiare nella sottocartella \PERS della cartella di distribuzione degli aggiornamenti sul server (ad esempio C:\Bus\Agg\Pers o \\Server\BusinessDir\Agg\Pers) le DLL personalizzate ed eventualmente le personalizzazione alla base dati inserite nel PROVA.MODXP;
<li>copiare le DLL personalizzate, ed eventualmente il PROVA.MODXP, anche nella cartella locale dell'installazione di Business NET (ad esempio C:\Program Files\Bus)
<li>In presenza di personalizzazioni alla base dati lanciare il programma <i>Strumento di amministrazione</i> (Busadmintools.exe) per convertire i database azienda.
<li>nella cartella aggiornamenti sul server incrementare il <i>N° aggiornamento server</i>, presente nel file AGGNUMBER.TXT, per far in modo che tutti gli altri client si aggiornino automaticamente all'avvio di Business NET, e le personalizzazioni vengano distribuite su tutte le macchine.</li>
</ol>
<p>Se l'installazione di una personalizzazione deve avvenire contemporaneamente all'installazione di un pacchetto di aggiornamenti rilasciato da NTS Informatica, ad esempio una service release, è possibile procedere nel seguente modo:</p>
<ol>
<li>copiare nella sottocartella \PERS della cartella di distribuzione degli aggiornamenti sul server (ad esempio C:\Bus\Agg\Pers o \\Server\BusinessDir\Agg\Pers) le DLL personalizzate ed eventualmente le personalizzazione alla base dati inserite nel PROVA.MODXP;
<li>lanciare l'installazione del pacchetto, come sopra indicato. Se il pacchetto distribuito da NTS Informatica includeva il PROVA.MODX verrà lanciata la conversione archivi che terrà conto anche della presenza del PROVA.MODXP con le customizzazioni alla base dati; se non presente e si ha la necessita di convertire il database si lancia, successivamente il Busadmintools.exe.</li>
</ol>
<p>Se si sta facendo un porting di una personalizzazione realizzata su una versione precedente di Business NET (2012 o precedenti) si consiglia di:</p>
<ul>
<li>eseguire il porting della personalizzazione alla versione corrente (dalla tecnologia VB6 a quella NET, ad esempio) e testare le la personalizzazione operi con la nuova versione che si sta installando;
<li>in presenza di database personalizzati, su versioni precedenti alla 2013, creare il PROVA.MODXP (vedi <i>Note per installatori e programmatori</i> nel capitolo <i>Note di versione</i> -Leggimi.htm- della guida in linea);
<li>Installare la nuova versione di Business NET (la versione completa mediante Bussetup) sul server;
<li>copiare nella sottocartella \PERS della cartella di distribuzione degli aggiornamenti (ad esempio C:\Bus\Agg\Pers) le DLL personalizzate ed eventualmente il file PROVA.MODXP;
<li>nella stessa cartella incrementare il <i>N° aggiornamento server</i>, presente nel file AGGNUMBER.TXT;
<li>Lanciare lo <i>Strumento di amministrazione</i> (Busadmintools.exe) per convertire i database dalla versione precedente a quella corrente personalizzata;
<li>Installare la nuova versione di Business NET sui client, impostando il flag relativo alla installazione automatica degli aggiornamenti;
<li>Al primo avvio di Business NET, su tali client, verranno installate localmente le personalizzazioni.</li>
</ul>
<p>
<u>NB: quando si installa una personalizzazione è necessario copiare tutti i componenti personalizzati dentro la cartella personalizzata degli aggiornamenti di Business (la cartella \Agg\Pers) <b>compreso il PROVA.MODXP</b>. E' molto importante che venga copiato il PROVA.MODXP in quanto con gli aggiornamenti infrarelease è possibile che sia un client ad avviare la conversione del database, e senza il PROVA.MODXP nella \Agg\Pers potrebbe capitare che la conversione venga eseguita senza per personalizzazioni del cliente!<?xml:namespace prefix = "o" ns = "urn:schemas-microsoft-com:office:office" />
</u>
</p>
<p>
<b>Esempio file di direttive installazione aggiornamenti (RILASCIO.TXT)</b>
</p>
<p>Il file con le direttive d'installazione degli aggiornamenti RILASCIO.TXT, utilizzato nelle installazione server, ha le seguenti caratteristiche:</p>
<p>
<code>[Rilascio] 
<br>REQUIRED_FRAM=20000 
<br>INSTALL__FRAM=20004 
<br>INSTALL__DESC=Business NET 2014 SR1 
<br>INSTALL_DATE=20140331 
<br>PRC_AGGSTRUCT=S 
<br>PRC_AGG_STPRO=S 
<br>PRC_AGG__ZOOM=S 
<br>PRC_AGG__MENU=S 
<br>AZI_AGGSTRUCT=S 
<br>AZI_AGG_STPRO=S 
<br>AGG_AGGNUMBER=S</code>
</p>
<p>REQUIRED_FRAM rappresenta l'ID di versione minima richiesta (controllata nel BUSAGGSERVER.TXT) per poter installare gli aggiornamenti nella modalità server</p>
<p>INSTALL__FRAM rappresenta il nuovo ID di versione da installare con questo pacchetto, ad esclusivo uso di NTS Informatica, per la distribuzione di service release</p>
<p>INSTALL__DESC rappresenta il nome della versione da installare con questo pacchetto, ad esclusivo uso di NTS Informatica,<A name=_GoBack>
</A>per la distribuzione di service release</p>
<p>INSTALL_DATE rappresenta la data, nel formato aaaammgg, in cui è stato creato il pacchetto; questo valore è utilizzabile per alimentare la proprietà DATE conservata nel file BUSAGGSERVER.TXT nella cartella di distribuzione aggiornamenti sul server</p>
<p>PRC_AGGSTRUCT, valori ammessi S o N, se a S procede alla conversione dell'archivio procedura; PRC_AGG_STPRO, valori ammessi S o N, se a S procede alla conversione dell'archivio procedura per aggiornare unicamente le stored procedure;</p>
<p>PRC_AGG__ZOOM, valori ammessi S o N, se a S procede alla conversione dell'archivio procedura solo per aggiornare la lista delle opzioni di registro ammesse;</p>
<p>PRC_AGG__MENU, valori ammessi S o N, se a S procede alla conversione dell'archivio procedura solo per aggiornare le voci del menu;</p>
<p>AZI_AGGSTRUCT, valori ammessi S o N, se a S procede alla conversione di tutti gli archivi azienda;</p>
<p>AZI_AGG_STPRO, valori ammessi S o N, se a S procede alla conversione di tutti gli archivi azienda per aggiornare unicamente le stored procedure;</p>
<p>PRC_AGG__DATI, opzionale, valori ammessi S o N (se mancante vale N, se valorizzato a S PRC_AGGSTRUCT deve essere valorizzato a N): se a S nel pacchetto è presente ARCPROC.MODX per la distribuzione di dati, nessun aggiornamento della struttura avviene. Utilizzata per creare i pacchetti di distribuzione di soli dati nell'archivio procedura;</p>
<p>PRC_AGG__COSA, opzionale (obbligatorio se PRC_AGG__DATI vale S): indica che tipo di dati aggiornare ABI=cod. abi/cab, TAR=codici taric, IMP=import/export, PAR=stampe parametriche query;</p>
<p>PRC_AGG_DESCR, opzionale (da valorizzare solo se PRC_AGG__DATI valeS): rappresenta la descrizione dell'aggiornamento, esempio "PRC_AGG_DESCR=Aggiornamento codici Abi/Cab (febbraio 2013)";</p>
<p>ADMNTOOL_WAIT, opzionale, valori ammessi S o N (se mancante vale N): indica che, qualora vi sia la necessità da parte del programma d'installazione degli aggiornamenti di avviare la conversione degli archivi, l'avvio del Busadmintools.exe avviene con la conferma da parte dell'operatore. Questo consente, eventualmente, di escludere uno o più database dalla conversione;</p>
<p>PRC_AGG__ABIC, PRC_AGG__TARI, PRC_AGG__IMEX, PRC<A name=_GoBack>
</A>_AGG__SPAR, opzionali, valori ammessi S o N (se mancante vale N): indica la necessità, in sede di conversione archivi con Busadmintools, di aggiornare i dati dell'archivio procedura relativi, rispettivamente, ai codici abi/cab, nomenclature combinate, profili import/export standard, stampe parametriche. Possono essere utilizzate anche quando PRC_AGGSTRUCT vale S. Incompatibile con la direttiva PRC_AGG__DATI.</p>
<p>
<b>Come estrarre il contenuto di un pacchetto di aggiornamento hotfix, postfix o service release</b>
</p>
<p>Questi pacchetti, rappresentati da file eseguibili, sono realizzati con programma <A href="http://www.jrsoftware.org/isdl.php">InnoSetup</A> e possono essere decompressi con il programma <A href="http://www.havysoft.cl/innoextractor.html">InnoExtractor</A> presente nella cartella \Tools\Unpacker del DVD-ROM di Business NET.</p>
</TD></TR></TABLE><TABLE border=0 cellSpacing=0 cellPadding=0><TR><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/software-retail-negozi/"><IMG border=0 src="../images/help_home_01_Gestisci.gif"></A></TD><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/controllo-di-gestione/"><IMG border=0 src="../images/help_home_02_Controlla.gif"></A></TD><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/crm/"><IMG border=0 src="../images/help_home_03_Fidelizza.gif"></A></TD><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/analisi-dati-datawarehouse/"><IMG border=0 src="../images/help_home_04_DWH.gif"></A></TD><TD vAlign=center width=169 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/project-management/"><IMG border=0 src="../images/help_home_05_Gestisci.gif"></A></TD><TD vAlign=center width=146 align=right><IMG border=0 src="../images/help_home_NTS_logo_up.gif"></TD></TR><TR><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/logistica/"><IMG border=0 src="../images/help_home_06_Organizza.gif"></A></TD><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/customer-service/"><IMG border=0 src="../images/help_home_07_Gestisci.gif"></A></TD><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/produzione/"><IMG border=0 src="../images/help_home_08_Pianifica.gif"></A></TD><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/archiviazione-documenti/"><IMG border=0 src="../images/help_home_09_Archivia.gif"></A></TD><TD vAlign=center width=169 align=right><IMG border=0 src="../images/help_home_NTS_logo_down1.gif"></TD><TD vAlign=center width=146 align=right><A href="http://www.ntsinformatica.it"><IMG border=0 alt="Clicca per accedere al sito di NTS Informatica" src="../images/help_home_NTS_logo_down2.gif"></A></TD></TR><TR><TD width=987 colSpan=6><IMG border=0 src="../images/help_home_Line.gif"></TD></TR></TABLE></body></html>