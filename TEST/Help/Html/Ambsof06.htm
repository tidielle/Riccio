<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3c.org/TR/1999/REC-html401-19991224/loose.dtd">
<html>
<head>
<title> AM: Modalità di corrispondenza in Business</title>
<LINK rel=stylesheet type=text/css href="style_topic.css">
<SCRIPT LANGUAGE="JavaScript">
<!-- Begin
loadImage1 = new Image();
loadImage1.src = "../images/help_home_Button_01_Roll-over.gif";
staticImage1 = new Image();
staticImage1.src = "../images/help_home_Button_01_Roll-out.gif";

loadImage2 = new Image();
loadImage2.src = "../images/help_home_Button_02_Roll-over.gif";
staticImage2 = new Image();
staticImage2.src = "../images/help_home_Button_02_Roll-out.gif";

loadImage3 = new Image();
loadImage3.src = "../images/help_home_Button_03_Roll-over.gif";
staticImage3 = new Image();
staticImage3.src = "../images/help_home_Button_03_Roll-out.gif";

loadImage4 = new Image();
loadImage4.src = "../images/help_home_Button_04_Roll-over.gif";
staticImage4 = new Image();
staticImage4.src = "../images/help_home_Button_04_Roll-out.gif";

// End -->
</SCRIPT>

</head>
<body lang=it topMargin=3>
<TABLE border=0 width=987><TR><TD vAlign=top align=right><p><FONT size=2><CODE>Data ultimo aggiornamento: <A name=hINIeDATlAGGp></A>09/01/2013</FONT><A name=hFINeDATlAGGp></A></CODE></p></TD></TR></TABLE><TABLE border=0 cellSpacing=0><TR><TD colSpan=4><A href="http://www.ntsinformatica.it"><IMG border=0 alt="Clicca per accedere al sito di NTS Informatica" src="../images/help_home_banner.gif"></A></TD></TR></TABLE><TABLE border=0 cellSpacing=0 cellPadding=0><TR><TD align=left><A onmouseover="image1.src=loadImage1.src;" onmouseout="image1.src=staticImage1.src;" href="cose.htm"><IMG border=0 name=image1 alt="Clicca per accedere all'argomento" src="../images/help_home_Button_01_Roll-out.gif"></A></TD><TD align=center><A onmouseover="image2.src=loadImage2.src;" onmouseout="image2.src=staticImage2.src;" href="pc.htm"><IMG border=0 name=image2 alt="Clicca per accedere all'argomento" src="../images/help_home_Button_02_Roll-out.gif"></A></TD><TD align=center><A href="ambsargmod.htm"><IMG border=0 name=image3 alt="Clicca per accedere all'argomento" src="../images/help_home_Button_03_Roll-over.gif"></A></TD><TD align=right><A onmouseover="image4.src=loadImage4.src;" onmouseout="image4.src=staticImage4.src;" href="gaguidaan.htm"><IMG border=0 name=image4 alt="Clicca per accedere all'argomento" src="../images/help_home_Button_04_Roll-out.gif"></A></TD></TR><TR><TD colSpan=4><A href="http://www.ntsinformatica.it"><IMG border=0 alt="Clicca per accedere al sito di NTS Informatica" src="../images/help_home_Button_03_Roll-over-row.gif"></A></TD></TR><TR><TD bgColor=#009ee2 height=53 vAlign=middle width=987 colSpan=4 align=left><p><FONT class=title color=white size=6><b>Modalità di corrispondenza in Business</b></FONT></p></TD></TR><TR><TD vAlign=middle colSpan=4 align=left></TD></TR></TABLE><TABLE border=0 width=987><TR><TD><p>Business da vari programmi (Stampa scadenziario, Gestione ordini, Liste selezionate clienti, Generazione file PDF, ...) offre la possibilità di generare dei documenti di Microsoft Word (o documenti PDF) che possono essere inviati automaticamente ai destinatati (clienti, leads, fornitori, contatti appartenenti a ruoli di una organizzazione, a seconda dei contesti). L'invio avviene attraverso le seguenti modalità di corrispondenza indicate nell'anagrafica del soggetto, o scelte nel momento dell'invio.</p><p><b><A name=EmailInternet>E-mail Internet</A></b></p><p>Attraverso il client di posta (Microsoft Outlook), che deve essere disponibile sul PC che invia le comunicazioni, provvede ad inviare un messaggio e-mail mediante i servizi MAPI 1.0. L'invio avviene attraverso il provider di invio delle e-mail in internet (Microsoft Exchange, o altro). Il messaggio conterrà in allegato il documenti Word o PDF oggetto della comunicazione. Per l'invio il programma rileva l'indirizzo e-mail dall'anagrafica del soggetto destinatario. Per l'identificazione del destinatario della comunicazione in servizio MAPI 1.0 richiede 2 informazioni: l'indirizzo visualizzato (RecipDisplayName) e l'indirizzo vero e proprio (RecipAddress). Siccome ogni provider MAPI può richiede specifiche differenti, il formato di queste due proprietà è parametrizzabile attraverso opzioni di registro di Business, nel modo seguente modo:</p><TABLE class=sample frame=box><TR><TD>Proprietà destinatario</TD><TD>Nome proprietà MAPI di Windows</TD><TD>Opzione di registro di Business</TD><TD>Valore predefinito</TD></TR><TR><TD>Indirizzo visualizzato</TD><TD>RecipDisplayName</TD><TD><A href="ampers07.htm#OPZIONI_._EmailMapiIndirizzoVisualizzato">OPZIONI\EmailMapiIndirizzoVisualizzato</A></TD><TD>"" (stringa vuota)</TD></TR><TR><TD>Indirizzo interno</TD><TD>RecipAddres</TD><TD><A href="ampers07.htm#OPZIONI_._EmailMapiIndirizzo">OPZIONI\EmailMapiIndirizzo</A></TD><TD>&lt;indirizzoemail&gt; oppure [SMTP:&lt;indirizzoemail&gt;] quando è abilitata opzione di registro <A href="ampers07.htm#OPZIONI_._EmailNoSMTP">OPZIONI\EmailNoSMTP</A> a -1</TD></TR></TABLE><p>Nel valore delle opzioni di registro possono essere presenti marcatori, racchiusi tra parentesi angolari e da specificare obbligatoriamente in minuscolo, che sono a run-time sostituiti nel seguente modo: <ul><li>&lt;nomedestinatario&gt;: viene sostituito con la ragione sociale del destinatario o il nome/cognome del contatto; <li>&lt;indirizzoemail&gt;: viene sostituito con l'indirizzo e-mail presente nelle anagrafiche; <li>&lt;numerofax&gt;: viene sostituito con il numero di fax presente nelle anagrafiche.</li></ul><p><b><A name=MicrosoftFax>Microsoft Fax</A></b></p><p>Attraverso il client di posta (Microsoft Outlook), che deve essere disponibile sul PC che invia le comunicazioni, provvede ad inviare un fax mediante i servizi MAPI 1.0. Deve essere disponibile ed installato un provider di invio fax nel client di posta Outlook. Il documento Word inviato come allegato rappresenterà il testo del fax. Attenzione! Con questa modalità sono inviabili solo allegati DOC di Word; i PDF non sono inviabili in quanto l'applicazione Windows associata a tali file (Adobe Reader di solito) non permette, al contrario di Microsoft Word, la stampa multipla dei file sulle stampanti virtuali fax. Per l'invio il programma rileva il n° di fax dall'anagrafica del soggetto destinatario. Per l'identificazione del destinatario della comunicazione in servizio MAPI 1.0 richiede 2 informazioni: l'indirizzo visualizzato (RecipDisplayName) e l'indirizzo vero e proprio (RecipAddress). Il formato di queste due informazioni sono parametrizzabili nel modo seguente modo:</p><TABLE class=sample frame=box><TR><TD>Proprietà destinatario</TD><TD>Nome proprietà MAPI di Windows</TD><TD>Opzione di registro di Business</TD><TD>Valore predefinito</TD></TR><TR><TD>Indirizzo visualizzato</TD><TD>RecipDisplayName</TD><TD><A href="ampers07.htm#OPZIONI_._FaxMapiIndirizzoVisualizzato">OPZIONI\FaxMapiIndirizzoVisualizzato</A></TD><TD>&lt;nomedestinatario&gt; </TD></TR><TR><TD>Indirizzo interno</TD><TD>RecipAddres</TD><TD><A href="ampers07.htm#OPZIONI_._FaxMapiIndirizzo">OPZIONI\FaxMapiIndirizzo</A></TD><TD>[FAX:&lt;numerofax&gt;]</TD></TR></TABLE><p>Nel valore delle opzioni di registro possono essere presenti marcatori, racchiusi tra parentesi angolari e da specificare obbligatoriamente in minuscolo, che sono a run-time sostituiti nel seguente modo: <ul><li>&lt;nomedestinatario&gt;: viene sostituito con la ragione sociale del destinatario o il nome/cognome del contatto; <li>&lt;indirizzoemail&gt;: viene sostituito con l'indirizzo e-mail presente nelle anagrafiche; <li>&lt;numerofax&gt;: viene sostituito con il numero di fax presente nelle anagrafiche.</li></ul><p><b><A name=ZetafaxMAPI>Zetafax MAPI</A></b></p><p>E' una modalità di invio che consente di inoltrare un FAX, attraverso il cliente di posta Microsoft Outlook, nel quale è installato un provider MAPI fax di Zetafax (collegato a sua volta ad un Exchange Server). Per l'invio il programma rileva il n° di fax dall'anagrafica del soggetto destinatario. Per l'identificazione del destinatario della comunicazione in servizio MAPI 1.0 richiede 2 informazioni: l'indirizzo visualizzato (RecipDisplayName) dove viene fornita la ragione sociale 1 del destinatario (o il nome/cognome se trattasi di contatto di una organizzazione) e l'indirizzo vero e proprio (RecipAddress) dove è fornita la seguente stringa: FAX:<I>nomedestinatario</I>@<I>numerofax</I>. <b>Il formato non è personalizzabile.</b></p><p><b><A name=Hylafax>Hylafax</A></b></p><p>Con la versione 2011 di Business Net è stata implementata la possibilità di inviare FAX tramite Hylafax di NetService con sistema alternativo all'OCX del clienti di hylafax per Windows, visto che sui nuovi sistemi operativi non era più supportato. Per impostare l'ambiente:</p><ul><li>indicare nell'anagrafica dei clienti 'Hylafax' come sistema di posta abituale <li>installare il client di posta di Hylafax (vedi FAQ 2038) <li>installare la runtime di JAVA (vers. 1.6 o sup.) <li>copiare nella directory di Business NET il file 'yajhfc_mod.jar' <li>impostare le seguenti opzioni dle reg. di Business: <ol><li><CODE>BUSINESS\OPZIONI\HylafaxJar</CODE> = -1 <li><CODE>BUSINESS\OPZIONI\Hylafax_YajhfcName</CODE> = nome del file jar (se diverso da 'yajhfc_mod.jar' magari perché si ha una eventuale versione più aggiornata)</li></ol></li></ul><p>NTS ha effettuato test con esito positivo su Windows XP e Windows 7.</p><p><b>NB:</b> il file .JAR può essere avviato anche manualmente, permetterà di avere una consolle grafica per vedere lo status dei file inviati, in attesa di invio, errori, etc...</p><p><b><A name=FaxserviceWinXP2003>Fax service Win XP/2003</A></b></p><p>Rappresenta il servizio fax locale di Windows Xp (oppure fax condiviso di Winodws 2003). Con tale metodologia è possibile l'invio di fax dalla macchina Windows Xp locale oppure su un fax condiviso in rete sul server Windows 2003. Questa funzione è da utilizzare solo con PC con sistemi operativi Windows XP o Windows 2003 con i servizi fax installati; l'utilizzo su altri sistemi determina una segnalazione d'errore. Non è possibile utilizzare il Fax server condiviso di Windows 2000 server/SBS2000. Questa modalità consente l'invio automatico solo di file DOC, non di file PDF (Adobe Acrobat); di conseguenza le funzioni di invio di file pdf sono inibite.</p><p>Sulla base di quanto sopra indicato, nella anagrafiche dei clienti/fornitori la "Modalità di corrispondenza" predefinita deve essere impostata opportunamente sulla base del sistema operativo che provvede all'invio automatico di documenti da Business. Se sulla rete sono presenti sistemi operativi differenti si consiglia di scegliere la modalità di invio fax direttamente al momento della stampa su Word senza scegliere "Come indicato in anagrafica" in modo da garantire la maggiore portabilità.</p><p><IMG src="../images/help_ambsof06_04.jpg"></p><p><b><A name=PDFFaxserviceWinXP2003>Come inviare PDF mediante i servizi fax di Windows XP/2003</A></b></p><p>A partire da Business NET 2010 è possibile inviare file PDF con i servizi Fax service di Windows XP/2003. Fino alla 13 SR2 questo era inibito, poi a scopo di test è stata implementata una opzione di registro globale di Business\Opzioni\FaxServiceForzaPDF non documentata che se abilitata a -1 (il valore predefinito era zero) ammetteva l'invio di PDF come documento allegato di un invio di fax da Business. A partire da Business NET 2010, sia sui componenti NET che VB6, il valore predefinito di tale opzione è -1 ossia attiva.</p><p>Dal punto di vista tecnico Business NET provvede all'invio di fax mediante la libreria ActiveX FaxComEx di Microsoft. Il documento allegato (ce ne può essere solo uno) che rappresenta il corpo del fax inviato, viene impostato nella proprietà Body dell'oggetto FaxDocument. Internamente il fax services invoca il verbo "printto" della shell di windows, per procedere alla generazione del file TIFF, associato alla estensione del documento allegato (vedi http://support.microsoft.com/kb/841714/en-us ).</p><p>Se il documento allegato è un DOC non ci sono problemi, se invece è un file PDF possono apparire errori di tipo "Operation failed" che inibiscono l'invio del fax. Di solito queste situazioni appaiono quando o sulla macchina non sono correttamente configurati i servizi fax (per i quali si rimanda alla documentazione Microsoft) oppure esistono problemi di configurazione/installazione dell'Acrobat Reader sul sistema.</p><p>Principalmente problemi di questo tipo sono causati da una non corretta associazione dei "verbi" della shell di Windows: l'installazione di altri tool che gestiscono i file pdf o anche alcune precedenti versioni dell'Acrobat Reader, corrompono tali chiavi di registro. La situazione migliore è quella di distintallare l'Acrobat Reader (e altri eventuali programmi viewer di PDF alternativi), ed eliminare le eventuali cartelle del registro di Windows:</p><PRE><CODE>HKEY_CLASSES_ROOT\.pdf
Tutte quelle che iniziano con HKEY_CLASSES_ROOT\AcroExch.*</CODE></PRE><p>Quindi si reinstalla Acrobat Reader ver. 8.1 o sup. oppure Acrobat Reader vers. 9.2 o sup. Al termine della installazione se si preme il tasto destro del mouse sui file PDF deve apparire questo menu contestuale (vedi voci evidenziate):</p><p><IMG src="../images/help_ambsof06_01.gif"> oppure <IMG src="../images/help_ambsof06_02.gif"></p><p>In presenza di Acrobat Reader 8.1 le chiavi del registro di Windows (Regedit) che devono essere presenti, insieme ad altre, sono:</p><PRE><CODE>[HKEY_CLASSES_ROOT\.PDF]
"Content Type"="application/pdf"
@="AcroExch.Document"</CODE></PRE><PRE><CODE>[HKEY_CLASSES_ROOT\AcroExch.Document\CurVer]
@="AcroExch.Document.7"</CODE></PRE><PRE><CODE>[HKEY_CLASSES_ROOT\AcroExch.Document\Shell]</CODE></PRE><PRE><CODE>[HKEY_CLASSES_ROOT\AcroExch.Document\Shell\Open]</CODE></PRE><PRE><CODE>[HKEY_CLASSES_ROOT\AcroExch.Document\Shell\Open\Command]
@="\"C:\\Program Files\\Adobe\\Reader 8.0\\Reader\\AcroRd32.exe\" \"%1\""</CODE></PRE><PRE><CODE>[HKEY_CLASSES_ROOT\AcroExch.Document.7\shell]
@="Read"</CODE></PRE><PRE><CODE>[HKEY_CLASSES_ROOT\AcroExch.Document.7\shell\Open]</CODE></PRE><PRE><CODE>[HKEY_CLASSES_ROOT\AcroExch.Document.7\shell\Open\command]
@="\"C:\\Program Files\\Adobe\\Reader 8.0\\Reader\\AcroRd32.exe\" \"%1\""</CODE></PRE><PRE><CODE>[HKEY_CLASSES_ROOT\AcroExch.Document.7\shell\Print]</CODE></PRE><PRE><CODE>[HKEY_CLASSES_ROOT\AcroExch.Document.7\shell\Print\command]
@="\"C:\\Program Files\\Adobe\\Reader 8.0\\Reader\\AcroRd32.exe\" /p /h \"%1\""</CODE></PRE><PRE><CODE>[HKEY_CLASSES_ROOT\AcroExch.Document.7\shell\Printto]</CODE></PRE><PRE><CODE>[HKEY_CLASSES_ROOT\AcroExch.Document.7\shell\Printto\command]
@="\"C:\\Program Files\\Adobe\\Reader 8.0\\Reader\\AcroRd32.exe\" /t \"%1\" \"%2\" \"%3\" \"%4\""</CODE></PRE><PRE><CODE>[HKEY_CLASSES_ROOT\AcroExch.Document.7\shell\Read]
@="Apri con Adobe Reader 8"</CODE></PRE><PRE><CODE>[HKEY_CLASSES_ROOT\AcroExch.Document.7\shell\Read\command]
@="\"C:\\Program Files\\Adobe\\Reader 8.0\\Reader\\AcroRd32.exe\" \"%1\""</CODE></PRE><p>In presenza di Acrobat Reader 9.2 le chiavi del registro di Windows (Regedit) che devono essere presenti, insieme ad altre, sono:</p><PRE><CODE>[HKEY_CLASSES_ROOT\.PDF]
"Content Type"="application/pdf"
@="AcroExch.Document"</CODE></PRE><PRE><CODE>[HKEY_CLASSES_ROOT\AcroExch.Document\CurVer]
@="AcroExch.Document.7"</CODE></PRE><PRE><CODE>[HKEY_CLASSES_ROOT\AcroExch.Document\Shell]</CODE></PRE><PRE><CODE>[HKEY_CLASSES_ROOT\AcroExch.Document\Shell\Open]</CODE></PRE><PRE><CODE>[HKEY_CLASSES_ROOT\AcroExch.Document\Shell\Open\Command]
@="\"C:\\Program Files\\Adobe\\Reader 9.0\\Reader\\AcroRd32.exe\" \"%1\""</CODE></PRE><PRE><CODE>[HKEY_CLASSES_ROOT\AcroExch.Document.7\shell]
@="Read"</CODE></PRE><PRE><CODE>[HKEY_CLASSES_ROOT\AcroExch.Document.7\shell\Open]</CODE></PRE><PRE><CODE>[HKEY_CLASSES_ROOT\AcroExch.Document.7\shell\Open\command]
@="\"C:\\Program Files\\Adobe\\Reader 9.0\\Reader\\AcroRd32.exe\" \"%1\""</CODE></PRE><PRE><CODE>[HKEY_CLASSES_ROOT\AcroExch.Document.7\shell\Print]</CODE></PRE><PRE><CODE>[HKEY_CLASSES_ROOT\AcroExch.Document.7\shell\Print\command]
@="\"C:\\Program Files\\Adobe\\Reader 9.0\\Reader\\AcroRd32.exe\" /p /h \"%1\""</CODE></PRE><PRE><CODE>[HKEY_CLASSES_ROOT\AcroExch.Document.7\shell\Printto]</CODE></PRE><PRE><CODE>[HKEY_CLASSES_ROOT\AcroExch.Document.7\shell\Printto\command]
@="\"C:\\Program Files\\Adobe\\Reader 9.0\\Reader\\AcroRd32.exe\" /t \"%1\" \"%2\" \"%3\" \"%4\""</CODE></PRE><PRE><CODE>[HKEY_CLASSES_ROOT\AcroExch.Document.7\shell\Read]
@="Apri con Adobe Reader 9"</CODE></PRE><PRE><CODE>[HKEY_CLASSES_ROOT\AcroExch.Document.7\shell\Read\command]
@="\"C:\\Program Files\\Adobe\\Reader 9.0\\Reader\\AcroRd32.exe\" \"%1\""</CODE></PRE><p>A questo punto procedendo da Business NET all'invio di PDF (ad esempio dal programma Fatturazione differita, stampa su pdf, invia automaticamente mediante "Fax service Win XP/2003") i fax vengono inviati alla consolle "Fax e scanner di Windows" che provvederà al recapito ai destinatari:</p><p><IMG src="../images/help_ambsof06_03.gif"></p><p>Problemi noti:</p><ul><li>Utilizzando la versione 8.1 dell'Acrobat Reader esistono 2 problemi che sono: <ol><li>L'invio del fax alla consolle è molto lento, servono circa 10-12 secondi per fax; sembra che il problema sia dovuto al rendering del file PDF in TIFF compiuto dall'Acrobat Reader/stampante virtuale fax di Microsoft. Il medesimo tempo è necessario anche se si invia un fax direttamente all'interno della consolle "Fax e scanner di Windows" allegando un PDF. <li>Il primo file PDF inviato (sia nei singoli invii oppure nell'invio di blocchi di file come dal programma Fatturazione differita) rimane aperto nell'Acrobat Reader.</li></ol><li>Utilizzando invece la versione 9.2 dell'Acrobat Reader ad ogni invio di file PDF rimane in esecuzione il programma Acrobat Reader al termine dell'invio, senza alcun documento PDF aperto.</li></ul></TD></TR></TABLE><TABLE border=0 cellSpacing=0 cellPadding=0><TR><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/software-retail-negozi/"><IMG border=0 src="../images/help_home_01_Gestisci.gif"></A></TD><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/controllo-di-gestione/"><IMG border=0 src="../images/help_home_02_Controlla.gif"></A></TD><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/crm/"><IMG border=0 src="../images/help_home_03_Fidelizza.gif"></A></TD><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/analisi-dati-datawarehouse/"><IMG border=0 src="../images/help_home_04_DWH.gif"></A></TD><TD vAlign=center width=169 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/project-management/"><IMG border=0 src="../images/help_home_05_Gestisci.gif"></A></TD><TD vAlign=center width=146 align=right><IMG border=0 src="../images/help_home_NTS_logo_up.gif"></TD></TR><TR><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/logistica/"><IMG border=0 src="../images/help_home_06_Organizza.gif"></A></TD><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/customer-service/"><IMG border=0 src="../images/help_home_07_Gestisci.gif"></A></TD><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/produzione/"><IMG border=0 src="../images/help_home_08_Pianifica.gif"></A></TD><TD vAlign=center width=168 align=middle><A href="http://www.ntsinformatica.it/software-erp-medie-imprese/software-erp/archiviazione-documenti/"><IMG border=0 src="../images/help_home_09_Archivia.gif"></A></TD><TD vAlign=center width=169 align=right><IMG border=0 src="../images/help_home_NTS_logo_down1.gif"></TD><TD vAlign=center width=146 align=right><A href="http://www.ntsinformatica.it"><IMG border=0 alt="Clicca per accedere al sito di NTS Informatica" src="../images/help_home_NTS_logo_down2.gif"></A></TD></TR><TR><TD width=987 colSpan=6><IMG border=0 src="../images/help_home_Line.gif"></TD></TR></TABLE></body></html>